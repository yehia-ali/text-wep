<div class="filters flex aic jcsb gap-x-4">
  <div class="flex-wrap aic gap-x-1 gap-y-1">
    <search (valueChanged)="service.search.next($event); filter()" [key]="service.search.value"/>
    <task-status (valueChanged)="service.taskStatus.next($event); filter()" [selectedValue]="service.taskStatus.value"/>
    <task-type (valueChanged)="service.taskType.next($event); filter()" *ngIf="visibleFilters.task_type" [selectedValue]="service.taskType.value"/>
    <priority-filter (valueChanged)="service.priority.next($event); filter()" *ngIf="visibleFilters.priority" [selectedValue]="service.priority.value"/>
    <repeat (valueChanged)="service.repeatPeriod.next($event); filter()" *ngIf="visibleFilters.repeatPeriod" [selectedValue]="service.repeatPeriod.value"/>
    <departments (valueChanged)="service.department.next($event); filter()" *ngIf="visibleFilters.departments" [selectedDepartment]="service.department.value"/>
    <assignee-state (valueChanged)="service.assigneeState.next($event); filter()" *ngIf="visibleFilters.assignee_state" [selectedValue]="service.assigneeState.value"/>
    <is-rated (valueChanged)="service.rated.next($event); filter()" *ngIf="visibleFilters.rate" [selectedValue]="service.rated.value"/>
    <rate-value (valueChanged)="service.rateValue.next($event); filter()" *ngIf="visibleFilters.rate_value" [selectedValue]="service.rateValue.value"/>
    <is-overdue (valueChanged)="service.isOverdue.next($event); filter()" *ngIf="visibleFilters.overdue" [selectedValue]="service.isOverdue.value"/>
    <date-filter (valueChanged)="service.dateFrom.next($event); service.dateTo.next(''); filter()" *ngIf="visibleFilters.date" [selectedValue]="service.dateFrom.value" key="start_date"/>
    <date-filter (valueChanged)="service.dateTo.next($event); filter()" *ngIf="visibleFilters.date" [minDate]="service.dateFrom.value" [selectedValue]="service.dateTo.value" key="end_date"/>
    <select-user class="no-label" *ngIf="visibleFilters.creators" (getSelectedUsers)="service.creators.next($event); filter()" text="creators" [selectedUsers]="service.creators.value"/>
    <select-user class="no-label" *ngIf="visibleFilters.assignees" (getSelectedUsers)="service.assignees.next($event); filter()" text="assignees" [selectedUsers]="service.assignees.value"/>
  </div>
  <div class="end flex aic gap-x-2 pt-75">
    <button mat-raised-button [ngClass]="{'bg-primary white': service.selectedTasksToHandoverValue.length > 0}" (click)="changeCreator()" [disabled]="service.selectedTasksToHandoverValue.length == 0">
      {{ 'change_creator' | translate }} ({{ service.selectedTasksToHandoverValue.length }})
    </button>

    <button mat-raised-button [ngClass]="{'bg-primary white': service.selectedTasksToHandoverValue.length > 0}" (click)="handover()" [disabled]="service.selectedTasksToHandoverValue.length == 0">
      {{ 'handover' | translate }} ({{ service.selectedTasksToHandoverValue.length }})
    </button>

    <button mat-raised-button class="bg-success export" *ngIf="customSpaceId != '98989'" (click)="export.emit()">{{ 'export' | translate }}</button>
    <button mat-raised-button class="bg-success export" *ngIf="customSpaceId == '98989'" (click)="downloadExcel()">{{ 'export' | translate }}</button>

    <task-vote-sort (sortChanged)="service.orderKey.next($event); filter()" [selectedValue]="service.orderKey.value"></task-vote-sort>
    <div (click)="$event.stopImmediatePropagation(); showFilters = true" class="img relative pointer">
      <img alt="" class="convert-image-color" src="assets/images/icons/filters.svg">
      <div (click)="$event.stopImmediatePropagation()" *ngIf="showFilters" class="filters-menu bg-white p-1 rounded"
           magicScroll="">
        <div *ngFor="let filter of filtersArray" class="menu-item">
          <mat-checkbox
            (change)="unCheck(filter)"
            [checked]="visibleFilters[filter]"
            [indeterminate]="false"
            [labelPosition]="'after'"
            color="primary">
            {{ filter | translate }}
          </mat-checkbox>
        </div>
      </div>
    </div>
  </div>
</div>
