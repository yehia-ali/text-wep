<layout>
  <div class="flex flex-column jcsb table-filter-content">
    <div class="pt-1 ">
      <div class="">
        <div class="filters flex mb-2 aic jcsb px-2">
          <div class="flex aic gap-x-1">
            <search [width]="'w-15r'" [hideLabel]="true" [classes]="'py-50 pr-1 fs-10'" [placeholder]="'name'" (valueChanged)="search($event)"/>
            <search [width]="'w-15r'" [hideLabel]="true" [classes]="'py-50 pr-1 fs-10'" [placeholder]="'employee_code'" (valueChanged)="employeeCode($event)"/>
            <app-users-filter (valueChanged)="manager($event)" [multi]="true" [manager]="true" [labelTitle]="'manager'"/>
            <app-departments-filter (valueChanged)="department($event)" [tree]="true"/>
          </div>

          <button *ngIf="kpiMode && selectedUsers.length > 0 " (click)="assignKpis()" class="btn rounded bg-primary white py-50 px-2 fs-12">
            {{'assign_kpis' | translate}}
          </button>
          <div class="flex aic gap-x-1" *ngIf="!kpiMode">
            <a [href]="url + 'api/WorkInfo/ExportUsers?spaceId=' + spaceId" target="_blank" class="btn rounded bg-primary white py-50 px-3 fs-12">
              {{'export' | translate}}
            </a>
            <a (click)="uploadFile()" class="btn rounded bg-primary white py-50 px-3 fs-12">
              {{'upload' | translate}}
            </a>
          </div>
        </div>
        <div class="table-container">
          <table class="w-100 rounded" *ngIf="!loading && allusers.length > 0">
            <thead>
              <tr class="border-bottom fs-12 simibold">
                <th class="text-left py-1" style="width: 100px;" *ngIf="!kpiMode">{{'member_code' | translate}}</th>
                <th class="text-left py-1">
                  <div class="flex aic">
                    <mat-checkbox *ngIf="kpiMode" class="mr-1 example-margin" color="primary" (change)="selectAllUsers($event)" [checked]="allChecked"></mat-checkbox>
                    <span>{{'name' | translate}}</span>
                  </div>
                </th>
                <th class="text-left py-1">{{'job_title' | translate}}</th>
                <th class="text-left py-1">{{'department' | translate}}</th>
                <th class="text-left py-1">{{'manager' | translate}}</th>
                <th *ngIf="!kpiMode"></th>
              </tr>
            </thead>
            <tbody class="table-body">
              <tr class="border-bottom fs-12" *ngFor="let item of allusers| paginate: {itemsPerPage: limit, currentPage: page, totalItems: totalItems}" >
                <td *ngIf="!kpiMode">{{item.employeeCode || '-'}}</td>
                <td>
                  <div class="flex aic">
                    <mat-checkbox *ngIf="kpiMode"  class="mr-1 example-margin" color="primary" [checked]="item.isSelected" (change)="selectUser($event, item)"></mat-checkbox>
                    <app-img-title [userId]="item.id" [title]="item.name" [imgSrc]="item.imageUrl"></app-img-title>
                  </div>
                </td>
                <td>{{item.jobTitle}}</td>
                <td>{{item.departmentName}}</td>
                <td>
                  <app-img-title [userId]="item.managerId" [title]="item.managerName" [imgSrc]="item.managerImage"></app-img-title>
                </td>
                <td *ngIf="!kpiMode">
                  <div class="img pointer" [routerLink]="'./employee/'+item.id">
                    <img src="assets/images/icons/edit1.svg" alt="edit icon">
                  </div>
                    </td>
              </tr>
            </tbody>
          </table>
          <div class="flex aic jcc py-5" *ngIf="loading || allusers.length == 0">
            <loading *ngIf="loading" [centerd]="true"/>
            <not-found *ngIf="!loading && allusers.length == 0" />
          </div>
        </div>
      </div>
    </div>
    <div class="pagination-content flex aic jcsb py-1 bg-white border-top border-bottom px-2" >
      <div class="flex aic">
        <p class="fs-12 simibold">{{ 'pagination_per_page' | translate }} </p>
        <input type="number" style="width:50px" class="input ml-75 limit text-center py-50 px-0" min="1" [(ngModel)]="limit" (ngModelChange)="changeLimit()">
        <p class="ml-50 primary fs-12" >{{ 'record' | translate }}</p>
      </div>
      <pagination-controls
        (pageChange)="pageChanged($event)"
        [maxSize]="7"
        [directionLinks]="true"
        [previousLabel]="'previous' | translate"
        [nextLabel]="'next' | translate"
                           >
      </pagination-controls>
      <p class="fs-12 simibold pr-3">{{ 'pagination_total_records' | translate }} <span
        class="primary">{{ totalItems | arabicNumbers }} {{ 'record' | translate }}</span>
      </p>
    </div>
  </div>
</layout>
