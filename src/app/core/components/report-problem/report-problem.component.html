<div class="raise-issue" dir="auto">
  <h3>{{'raise_issue' | translate}}</h3>

  <div mat-dialog-content>
    <form [formGroup]="form">
      <div class="module">
        <input-label key="module" [control]="f['category']"/>
        <ng-select formControlName="category" [items]="categories$ | async" [closeOnSelect]="true" [multiple]="false" appendTo="body" bindLabel="name" bindValue="id"></ng-select>
        <input-error [control]="f['category']"/>
      </div>

      <div class="subject mt-2">
        <form [formGroup]="form">
          <input-label [control]="f['subject']" key="subject" [maxLength]="250"/>
          <input type="text" formControlName="subject" class="input" maxlength="250">
          <input-error [control]="form.controls['subject']"></input-error>
        </form>
      </div>

      <div class="message mt-2">
        <input-label key="message" [control]="f['message']"/>
        <textarea class="input" rows="5" formControlName="message"></textarea>
        <input-error [control]="f['message']"/>
      </div>

      <div class="record mt-2">
        <input-label key="sound_description"/>
        <record (soundDescription)="sound = $event"/>
      </div>

      <div class="attachments mt-2">
        <input-label key="attachments"/>
        <div class="flex-grid gap-y-1" [ngClass]="{'mb-1': attachments.length > 0}">
          <div class="col-lg-6" *ngFor="let attachment of attachments; let i = index">
            <div class="attachment-card p-1 bg-gray rounded flex jcsb aic">
              <div class="start flex aic">
                <p *ngIf="attachment.name.length <= 20">{{attachment.name}}</p>
                <p *ngIf="attachment.name.length > 20">{{attachment.name | slice:0:20}}...</p>
              </div>
              <div class="end img pointer" (click)="removeFile(i)">
                <i class='bx bx-x danger fs-23'></i>
              </div>
            </div>
          </div>
        </div>
        <label class="mt-50 pointer">
          <ngx-file-drop
            (onFileDrop)="dropped($event)"
            [multiple]="true"
            accept="image/*, video/*, audio/*">
            <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">
              <ng-container (click)="openFileSelector()">
                <div class="img mb-50">
                  <img src="assets/images/icons/attachments.svg" width="25" alt="">
                </div>
                <span>{{'drop_files' | translate}}</span>
                <span>{{'up_to_5_mb' | translate}}</span>
              </ng-container>
            </ng-template>
          </ngx-file-drop>
        </label>
      </div>
    </form>
  </div>

  <div mat-dialog-actions align="end">
    <button mat-raised-button color="primary" class="border border-dark px-3 mr-1 shadow-0" [disabled]="loading" (click)="send()">{{'send' | translate}}</button>
    <button mat-raised-button mat-dialog-close="" class="border border-dark px-2 shadow-0">{{'cancel' |translate}}</button>
  </div>

</div>
