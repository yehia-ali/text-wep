"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[1045],{20198:(A,x,e)=>{e.d(x,{r:()=>y});var p=e(65879),c=e(20553),t=e(37398),m=e(17476),f=e(69862),h=e(98052),M=e(63934);let y=(()=>{class d{constructor(l,v,i){this.http=l,this.currentSpace=v,this.userSer=i,this.rolesService=(0,p.f3M)(m.f)}login(l){return this.http.post(`${c.N.coreBase}/api/Authentication/Login`,l).pipe((0,t.U)(v=>{v.success&&(localStorage.setItem("token",v.data.accessToken),this.rolesService.isTaskedinSuperAdmin().subscribe(i=>{i?(localStorage.setItem("base-url",c.N.coreBase+"/"),localStorage.setItem("is-super-admin","true"),window.location.href="/new-spaces"):this.currentSpace.getMySpaces().subscribe(r=>{this.activeSpace=r,r?(localStorage.setItem("space-id",r.spaceId),localStorage.setItem("base-url",r.baseUrl),localStorage.setItem("chat-id",r.chatId),this.userSer.getMyProfile(r.spaceId,r.baseUrl).subscribe(u=>{u.success&&(window.location.href="/")})):window.location.href="/welcome"})}))}))}verifyOtp(l){return this.http.get(`${c.N.coreBase}/api/Authentication/CheckOtp`,{params:{otp:l}})}verifyAccount(l){return this.http.get(`${c.N.coreBase}/api/Authentication/VerifyAccount`,{params:l})}static{this.\u0275fac=function(v){return new(v||d)(p.LFG(f.eN),p.LFG(h.Q),p.LFG(M.K))}}static{this.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()},21585:(A,x,e)=>{e.d(x,{a:()=>C});var p=e(69862),c=e(20553),t=e(65619),m=e(37398),f=e(26293),h=e(65879),M=e(64190);let y=(()=>{class l{constructor(i){this.http=i,this.paymentStatus=new t.X(null),this.details=new t.X(null)}orderKey(i,r){return this.http.post(`${c.N.coreBase}/api/PaymentOrder/OrderPayment`,{orderId:i,PaymentGateWay:r})}getSubscriptionDetails(){return this.http.get(`${c.N.apiUrl}api/PaymentOrder/GetMySubscriptionDetails`).pipe((0,m.U)(i=>(this.details.next(i.data),i.data)))}billingHistory(){let i=new URL(`${c.N.apiUrl}api/PaymentOrder/GetMySpaceBillingHistory`);return"number"==typeof this.paymentStatus.value&&i.searchParams.append("PaymentStatus",this.paymentStatus.value),this.http.get(`${i}`).pipe((0,m.U)(r=>r.data.items))}getUnpaidOrders(){return this.http.post(`${c.N.apiUrl}api/PaymentOrder/GetMySubscriptionUnpaidOrders`,{}).pipe((0,m.U)(i=>i.data))}getOrderDetails(i){return this.http.get(`${c.N.apiUrl}api/PaymentOrder/GetMyBillingOrder?id=${i}`).pipe((0,m.U)(r=>r.data))}static{this.\u0275fac=function(r){return new(r||l)(h.LFG(p.eN))}}static{this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var d=e(99758);let C=(()=>{class l{constructor(i,r,u,I){this.http=i,this.router=r,this.subscriptionSer=u,this.alert=I,this.phone=new t.X(""),this.code=new t.X(""),this.token=new t.X(""),this.purchaseSuccess=new t.X(!1),this.firstLogin=new t.X(!1),this.firstLoginData=new t.X({})}appConfig(){return this.http.post(`${c.N.coreBase}/api/ApplicationConfigration/getByDeviceType`,{},{headers:(new p.WM).set("DeviceType","3")})}mainRegister(i,r){return this.http.post(`${c.N.coreBase}/api/Authentication/AnonymousSpaceRegister`,i,{headers:(new p.WM).set("Token",r)}).pipe((0,m.U)(u=>u?.success?(this.alert.showAlert("account_created"),1==u.data.paymentSubscriptionStatus?(this.firstLogin.next(!0),this.firstLoginData.next(i),localStorage.setItem("p-token","first login"),(0,f.K)(),this.router.navigate(["/auth/redirect"]),u):void this.subscriptionSer.orderKey(u.data.paymentOrderId,this.inEgypt()?1:2).subscribe(I=>{if(this.inEgypt()){let b=I.data.token,T=`https://accept.paymob.com/api/acceptance/iframes/${c.N.iframeId}?payment_token=${b}`;localStorage.setItem("p-token",b),sessionStorage.setItem("paymentUrl",T),setTimeout(()=>{window.open(`${T}`,"_self")},20)}else{let b=`${I.data}`;sessionStorage.setItem("paymentUrl",b),setTimeout(()=>{window.open(`${b}`,"_self")},20)}return I})):u))}mainJoinSpace(i){return this.http.post(`${c.N.coreBase}/api/Authentication/AnonymousMainJoinSpace`,i).pipe((0,m.U)(r=>{if(!r.success)return r;(0,f.K)(),this.router.navigate(["/auth/login"]),this.alert.showAlert("joined_space")}))}inEgypt(){return Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase().includes("africa/cairo")}static{this.\u0275fac=function(r){return new(r||l)(h.LFG(p.eN),h.LFG(M.F0),h.LFG(y),h.LFG(d.c))}}static{this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()},41045:(A,x,e)=>{e.r(x),e.d(x,{AuthModule:()=>B});var p=e(96814),c=e(64190),t=e(65879);let m=(()=>{class s{static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275cmp=t.Xpm({type:s,selectors:[["auth"]],decls:1,vars:0,template:function(n,o){1&n&&t._UZ(0,"router-outlet")},dependencies:[c.lC]})}}return s})();var f=e(21585),h=e(99758);let M=(()=>{class s{constructor(a,n,o,g){this.route=a,this.router=n,this.authSer=o,this.alert=g}ngOnInit(){this.sub=this.authSer.firstLogin.subscribe(a=>{a?this.router.navigate(["/auth/registration-completed"]):this.route.queryParamMap.subscribe(n=>{n.get("success")&&("true"==n.get("success").toLowerCase()?(this.authSer.purchaseSuccess.next(!0),sessionStorage.removeItem("paymentUrl"),window.webkit?.messageHandlers.MessageHandler.postMessage("success"),this.router.navigate(["/auth/purchase-successful"]).then(()=>{this.alert.showAlert("payment_success")})):(this.authSer.purchaseSuccess.next(!1),window.webkit?.messageHandlers.MessageHandler.postMessage("error"),this.router.navigate(["/auth/purchase-failed"])))})})}ngOnDestroy(){this.sub.unsubscribe()}static{this.\u0275fac=function(n){return new(n||s)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(f.a),t.Y36(h.c))}}static{this.\u0275cmp=t.Xpm({type:s,selectors:[["redirect"]],standalone:!0,features:[t.jDz],decls:0,vars:0,template:function(n,o){},dependencies:[p.ez],encapsulation:2})}}return s})();var y=e(26293),d=e(89515),C=e(17700),l=e(32296),v=e(20198);function i(s,S){1&s&&(t.TgZ(0,"div",11),t._UZ(1,"i",12),t.qZA())}function r(s,S){1&s&&(t.TgZ(0,"div",13),t._UZ(1,"i",14),t.qZA())}const u=function(s,S){return{"bg-gray":s,"bg-primary white":S}};function I(s,S){if(1&s){const a=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.login())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&s){const a=t.oxw();t.Q6J("ngClass",t.WLB(4,u,"error"==a.data.type,"success"==a.data.type)),t.xp6(1),t.hij("",t.lcZ(2,2,"okay")," ")}}function b(s,S){if(1&s){const a=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.payment())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"try_again")))}function T(s,S){if(1&s){const a=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.loginWithData())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&s){const a=t.oxw();t.Q6J("ngClass",t.WLB(4,u,"error"==a.data.type,"success"==a.data.type)),t.xp6(1),t.hij("",t.lcZ(2,2,"new_login_btn")," ")}}const P=function(s,S){return{primary:s,danger:S}};let D=(()=>{class s{constructor(a,n,o,g){this.data=a,this.router=n,this.registerSer=o,this.loginSer=g}ngOnInit(){this.registerSer.firstLoginData.subscribe(a=>{this.userData=a}),"success"==this.data.type&&localStorage.removeItem("p-token")}payment(){let a=sessionStorage.getItem("paymentUrl");window.open(`${a}`,"_self")}login(){localStorage.removeItem("p-token"),(0,y.K)(),this.router.navigate(["/auth/login"])}loginWithData(){localStorage.removeItem("p-token"),(0,y.K)(),this.loginSer.login(this.userData).subscribe()}static{this.\u0275fac=function(n){return new(n||s)(t.Y36(C.WI),t.Y36(c.F0),t.Y36(f.a),t.Y36(v.r))}}static{this.\u0275cmp=t.Xpm({type:s,selectors:[["dialog-message"]],standalone:!0,features:[t.jDz],decls:15,vars:15,consts:[[1,"dialog-message","w-100","pt-2"],[1,"flex-center","w-100"],["class","bg-primary white rounded-50 message-type flex-center",4,"ngIf"],["class","bg-danger white rounded-50 message-type flex-center",4,"ngIf"],[1,"fs-35","mt-75","text-center",3,"ngClass"],[1,"fs-18","text-center","px-1"],["mat-dialog-actions",""],[1,"flex-center","mb-1","gap-x-1","w-100","mt-1"],["mat-raised-button","","class","flex-50","mat-dialog-close","",3,"ngClass","click",4,"ngIf"],["mat-raised-button","","class","flex-50 bg-danger",3,"click",4,"ngIf"],["mat-raised-button","","mat-dialog-close","",3,"ngClass","click",4,"ngIf"],[1,"bg-primary","white","rounded-50","message-type","flex-center"],[1,"bx","bx-check","fs-50"],[1,"bg-danger","white","rounded-50","message-type","flex-center"],[1,"bx","bx-x","fs-50"],["mat-raised-button","","mat-dialog-close","",1,"flex-50",3,"ngClass","click"],["mat-raised-button","",1,"flex-50","bg-danger",3,"click"],["mat-raised-button","","mat-dialog-close","",3,"ngClass","click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,i,2,0,"div",2),t.YNc(3,r,2,0,"div",3),t.qZA(),t.TgZ(4,"p",4),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"p",5),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",6)(11,"div",7),t.YNc(12,I,3,7,"button",8),t.YNc(13,b,3,3,"button",9),t.YNc(14,T,3,7,"button",10),t.qZA()()()),2&n&&(t.xp6(2),t.Q6J("ngIf","success"==o.data.type),t.xp6(1),t.Q6J("ngIf","error"==o.data.type),t.xp6(1),t.Q6J("ngClass",t.WLB(12,P,"success"==o.data.type,"error"==o.data.type)),t.xp6(1),t.hij(" ",t.lcZ(6,8,o.data.type)," "),t.xp6(3),t.Oqu(t.lcZ(9,10,o.data.message)),t.xp6(4),t.Q6J("ngIf",!(null!=o.data&&o.data.btn_message)),t.xp6(1),t.Q6J("ngIf","error"==o.data.type),t.xp6(1),t.Q6J("ngIf",null==o.data?null:o.data.btn_message))},dependencies:[p.ez,p.mk,p.O5,d.aw,d.X$,C.Is,C.ZT,C.H8,l.ot,l.lW],encapsulation:2})}}return s})();var L=e(6593),O=e(22939);const Z=[{path:"",component:m,children:[{path:"login",loadComponent:()=>Promise.all([e.e(3251),e.e(7809),e.e(8592),e.e(4509)]).then(e.bind(e,74509)).then(s=>s.LoginComponent)},{path:"register",loadComponent:()=>Promise.all([e.e(7466),e.e(3251),e.e(8592),e.e(8452)]).then(e.bind(e,78452)).then(s=>s.RegisterComponent)},{path:"forgot-password",loadComponent:()=>Promise.all([e.e(3251),e.e(8592),e.e(4033)]).then(e.bind(e,74033)).then(s=>s.ForgotPasswordComponent)},{path:"verify-phone",loadComponent:()=>Promise.all([e.e(7809),e.e(8592),e.e(2078)]).then(e.bind(e,32078)).then(s=>s.VerifyPhoneComponent)},{path:"reset-password",loadComponent:()=>Promise.all([e.e(8592),e.e(3108)]).then(e.bind(e,3108)).then(s=>s.ResetPasswordComponent)},{path:"redirect",component:M},{path:":id",component:(()=>{class s{constructor(a,n,o,g,U){this.service=a,this.title=n,this.dialog=o,this.snackbar=g,this.router=U}ngOnInit(){this.snackbar.dismiss(),this.service.firstLoginData.subscribe(a=>{a.password?(this.title.setTitle("Thank you .. Registration completed"),this.dialog.open(D,{panelClass:"dialog-message",data:{type:"success",message:"new_login_message",btn_message:"new_login_btn"}}).afterClosed().subscribe(()=>{localStorage.removeItem("p-token"),sessionStorage.removeItem("paymentUrl"),(0,y.K)(),this.dialog.closeAll(),this.router.navigate(["/"])})):this.service.purchaseSuccess.subscribe(n=>{let o,g;n?(this.title.setTitle("Thank you .. Purchase successful"),localStorage.removeItem("p-token"),sessionStorage.removeItem("paymentUrl"),o="success",g="payment_success"):(this.title.setTitle("Sorry .. Purchase failed"),o="error",g="payment_error"),this.dialog.open(D,{panelClass:"dialog-message",disableClose:!0,data:{type:o,message:g}}).backdropClick().subscribe(()=>{(0,y.K)(),localStorage.removeItem("p-token"),sessionStorage.removeItem("paymentUrl"),this.dialog.closeAll(),this.router.navigate(["/"])})})})}static{this.\u0275fac=function(n){return new(n||s)(t.Y36(f.a),t.Y36(L.Dx),t.Y36(C.uw),t.Y36(O.ux),t.Y36(c.F0))}}static{this.\u0275cmp=t.Xpm({type:s,selectors:[["thank-you"]],standalone:!0,features:[t.jDz],decls:0,vars:0,template:function(n,o){},dependencies:[p.ez],encapsulation:2})}}return s})()},{path:"",redirectTo:"login",pathMatch:"full"}]}];let E=(()=>{class s{static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275mod=t.oAB({type:s})}static{this.\u0275inj=t.cJS({imports:[c.Bz.forChild(Z),c.Bz]})}}return s})(),B=(()=>{class s{static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275mod=t.oAB({type:s})}static{this.\u0275inj=t.cJS({imports:[p.ez,E]})}}return s})()}}]);