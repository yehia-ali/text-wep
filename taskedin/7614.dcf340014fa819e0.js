"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[7614],{3131:(P,m,s)=>{s.d(m,{P:()=>p});var l=s(65619),c=s(65879);let p=(()=>{class u{constructor(){this.withSubMenu=new l.X(!0)}static{this.\u0275fac=function(h){return new(h||u)}}static{this.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},81854:(P,m,s)=>{s.d(m,{U:()=>_});var l=s(20553),c=s(65619),p=s(37398),u=s(65879),f=s(69862);let _=(()=>{class h{constructor(o){this.http=o,this.meta=new c.X({}),this.currentPage=new c.X({}),this.packages$=new c.X([])}getPackages(){return this.http.get(`${l.N.coreBase}/api/PaymentPacakage/Get`).pipe((0,p.U)(o=>{let x={pageSize:o.data.pageSize,totalItems:o.data.totalItems,totalPages:o.data.totalPages,totalUnSeen:o.data.totalUnSeen,currentPage:o.data.currentPage};return this.meta.next(x),this.currentPage.next(x.currentPage),this.packages$.next(o.data.items),o.data.items}))}createPackage(o){return this.http.post(`${l.N.apiUrl}api/PaymentPacakage/Create`,o)}updatePackage(o){return this.http.put(`${l.N.apiUrl}api/PaymentPacakage/Update`,o)}deletePackage(o){return this.http.put(`${l.N.apiUrl}api/PaymentPacakage/Delete`,o)}static{this.\u0275fac=function(x){return new(x||h)(u.LFG(f.eN))}}static{this.\u0275prov=u.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},74266:(P,m,s)=>{s.r(m),s.d(m,{BillingOrdersComponent:()=>X});var l=s(96814),c=s(89515),p=s(11486),u=s(38140),f=s(59466),_=s(76472),h=s(9619),Z=s(57105),o=s(65668),x=s(55006),v=s(18512),t=s(65879),i=s(65619),C=s(78645),O=s(83620),b=s(94664),D=s(37398),V=s(20553),w=s(69862);let y=(()=>{class n{constructor(e){this.http=e,this.meta=new i.X({}),this.orders=new i.X([]),this.currentPage=new i.X(1),this.currentPageValue=1,this.search=new C.x,this.searchValue="",this.loading=new i.X(!0),this.creationDateFrom=new i.X(""),this.creationDateFromValue="",this.creationDateTo=new i.X(""),this.creationDateToValue="",this.expiredDateFrom=new i.X(""),this.expiredDateFromValue="",this.expiredDateTo=new i.X(""),this.expiredDateToValue="",this.startDateFrom=new i.X(""),this.startDateFromValue="",this.startDateTo=new i.X(""),this.startDateToValue="",this.userCountFrom=new i.X(""),this.userCountFromValue="",this.userCountTo=new i.X(""),this.userCountToValue="",this.costFrom=new i.X(""),this.costFromValue="",this.costTo=new i.X(""),this.costToValue="",this.paymentStatus=new i.X(null),this.paymentStatusValue=null,this.packages=new i.X([]),this.packagesValue=[],this.limit=new i.X(15),this.limitValue=15,this.sort=new i.X(null),this.sortValue=null,this.sortDirection=new i.X(null),this.sortDirectionValue=null,this.currentPage.subscribe(a=>this.currentPageValue=a),this.search.subscribe(a=>this.searchValue=a),this.limit.subscribe(a=>this.limitValue=a),this.creationDateFrom.subscribe(a=>this.creationDateFromValue=a),this.creationDateTo.subscribe(a=>this.creationDateToValue=a),this.expiredDateFrom.subscribe(a=>this.expiredDateFromValue=a),this.expiredDateTo.subscribe(a=>this.expiredDateToValue=a),this.startDateFrom.subscribe(a=>this.startDateFromValue=a),this.startDateTo.subscribe(a=>this.startDateToValue=a),this.userCountFrom.subscribe(a=>this.userCountFromValue=a),this.userCountTo.subscribe(a=>this.userCountToValue=a),this.costFrom.subscribe(a=>this.costFromValue=a),this.costTo.subscribe(a=>this.costToValue=a),this.paymentStatus.subscribe(a=>this.paymentStatusValue=a),this.packages.subscribe(a=>this.packagesValue=a),this.sort.subscribe(a=>this.sortValue=a),this.sortDirection.subscribe(a=>this.sortDirectionValue=a),this.search.pipe((0,O.b)(700),(0,b.w)(()=>this.getBillingOrders())).subscribe()}getBillingOrders(){this.loading.next(!0);let e=new URL(`${V.N.apiUrl}api/PaymentOrder/GetBillingOrders`);return e.searchParams.append("limit",JSON.stringify(this.limitValue)),e.searchParams.append("page",this.currentPageValue),this.creationDateFromValue&&e.searchParams.append("CreationDateFrom",this.creationDateFromValue),this.creationDateToValue&&e.searchParams.append("CreationDateTo",this.creationDateToValue),this.expiredDateFromValue&&e.searchParams.append("ExpiredDateFrom",this.expiredDateFromValue),this.expiredDateToValue&&e.searchParams.append("ExpiredDateTo",this.expiredDateToValue),this.startDateFromValue&&e.searchParams.append("StartDateFrom",this.startDateFromValue),this.startDateToValue&&e.searchParams.append("StartDateTo",this.startDateToValue),this.userCountFromValue&&e.searchParams.append("UserCountFrom",this.userCountFromValue),this.userCountToValue&&e.searchParams.append("UserCountTo",this.userCountToValue),this.costFromValue&&e.searchParams.append("CostFrom",this.costFromValue),this.costToValue&&e.searchParams.append("CostTo",this.costToValue),this.sortValue&&(e.searchParams.append("orderKey",this.sortValue),e.searchParams.append("orderDirection",this.sortDirectionValue)),this.packagesValue.length>0&&this.packagesValue.map(a=>{e.searchParams.append("packageId",a.id)}),(0==this.paymentStatusValue||1==this.paymentStatusValue)&&e.searchParams.append("PaymentStatus",this.paymentStatusValue),this.searchValue&&e.searchParams.append("search",this.searchValue),this.http.get(`${e}`).pipe((0,D.U)(a=>{let r=a.data.items,g={pageSize:a.data.pageSize,totalItems:a.data.totalItems,totalPages:a.data.totalPages,totalUnSeen:a.data.totalUnSeen,currentPage:a.data.currentPage};return this.loading.next(!1),this.meta.next(g),this.currentPage.next(g.currentPage),this.orders.next(r),r}))}static{this.\u0275fac=function(a){return new(a||n)(t.LFG(w.eN))}}static{this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var A=s(17700),B=s(3131);function F(n,d){if(1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",1==e.paymentStatus?t.lcZ(2,1,"paid"):t.lcZ(3,3,"paid_offline")," ")}}function U(n,d){1&n&&(t.TgZ(0,"div",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"unpaid")," "))}function S(n,d){if(1&n&&(t.TgZ(0,"tr",16)(1,"td",9)(2,"p",17),t._uU(3),t.qZA()(),t.TgZ(4,"td",9)(5,"p"),t._uU(6),t.qZA()(),t.TgZ(7,"td",10)(8,"p",18),t._uU(9),t.qZA()(),t.TgZ(10,"td",10)(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"td")(14,"div",14)(15,"p"),t._uU(16),t.ALo(17,"arabicDate"),t.qZA()()(),t.TgZ(18,"td",9)(19,"p"),t._uU(20),t.qZA()(),t.TgZ(21,"td")(22,"p"),t._uU(23),t.qZA()(),t.TgZ(24,"td")(25,"div",14),t.YNc(26,F,4,5,"div",19),t.YNc(27,U,3,3,"div",20),t.qZA()(),t.TgZ(28,"td")(29,"p"),t._uU(30),t.qZA()(),t.TgZ(31,"td",10)(32,"p"),t._uU(33),t.qZA()()()),2&n){const e=d.$implicit,a=t.oxw(2);t.xp6(3),t.Oqu(e.id),t.xp6(3),t.Oqu(e.paymentGetWayOrderId),t.xp6(3),t.Oqu(e.spaceName),t.xp6(3),t.Oqu(e.spaceCreatorName),t.xp6(4),t.Oqu(e.startDate?t.lcZ(17,11,e.startDate):"-"),t.xp6(4),t.Oqu(e.paymentPackageName||"-"),t.xp6(3),t.Oqu(e.numberOfUser||"-"),t.xp6(3),t.Q6J("ngIf",1==e.paymentStatus||2==e.paymentStatus),t.xp6(1),t.Q6J("ngIf",0==e.paymentStatus),t.xp6(3),t.Oqu(e.totalPrice?e.totalPrice+" "+a.translate.instant("EGP"):"-"),t.xp6(3),t.Oqu(e.getaway)}}const E=function(n,d,e){return{itemsPerPage:n,currentPage:d,totalItems:e}};function I(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"table",7)(1,"thead",8)(2,"tr")(3,"th",9),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th",9),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th",10)(10,"div",11)(11,"p",12),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"sorting",13),t.NdJ("down",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(3,0))})("up",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(3,1))}),t.qZA()()(),t.TgZ(15,"th",10)(16,"div",11)(17,"p",12),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"sorting",13),t.NdJ("down",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(4,0))})("up",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(4,1))}),t.qZA()()(),t.TgZ(21,"th",9),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"th",9),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"th")(28,"div",14)(29,"p",12),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"sorting",13),t.NdJ("down",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(6,1))})("up",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(6,0))}),t.qZA()()(),t.TgZ(33,"th",9)(34,"div",14)(35,"p",12),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"sorting",13),t.NdJ("down",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(1,1))})("up",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(1,0))}),t.qZA()()(),t.TgZ(39,"th",9)(40,"div",14)(41,"p",12),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"sorting",13),t.NdJ("down",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(5,0))})("up",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.sort(5,1))}),t.qZA()()(),t.TgZ(45,"th",10),t._uU(46),t.ALo(47,"translate"),t.qZA()()(),t.TgZ(48,"tbody"),t.YNc(49,S,34,13,"tr",15),t.ALo(50,"paginate"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,12,"order_id")),t.xp6(3),t.Oqu(t.lcZ(8,14,"gateway_id")),t.xp6(5),t.Oqu(t.lcZ(13,16,"space_name")),t.xp6(6),t.Oqu(t.lcZ(19,18,"owner_name")),t.xp6(4),t.Oqu(t.lcZ(23,20,"creation_date")),t.xp6(3),t.Oqu(t.lcZ(26,22,"package_name")),t.xp6(5),t.Oqu(t.lcZ(31,24,"active_users")),t.xp6(6),t.Oqu(t.lcZ(37,26,"status")),t.xp6(6),t.Oqu(t.lcZ(43,28,"total_price")),t.xp6(4),t.Oqu(t.lcZ(47,30,"gateway")),t.xp6(3),t.Q6J("ngForOf",t.xi3(50,32,e.orders,t.kEZ(35,E,e.meta.pageSize,e.meta.currentPage,e.meta.totalItems)))("ngForTrackBy",e.trackBy)}}function M(n,d){1&n&&t._UZ(0,"not-found")}function N(n,d){1&n&&t._UZ(0,"loading")}let X=(()=>{class n{constructor(e,a,r,g,T){this.service=e,this.dialog=a,this.elm=r,this.layoutSer=g,this.translate=T,this.orders=[],this.loading=!1,this.dir=document.dir}ngOnInit(){this.layoutSer.withSubMenu.next(!1),this.service.orders.subscribe(e=>this.orders=e),this.service.meta.subscribe(e=>this.meta=e),this.service.loading.subscribe(e=>this.loading=e),0==this.orders.length&&this.service.search.next("")}getBillingOrders(){this.loading=!0,this.service.getBillingOrders().subscribe(()=>{this.loading=!1})}search(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.service.currentPage.next(1),this.service.search.next(e),this.getBillingOrders()},500)}changePage(e){this.service.currentPage.next(e),this.getBillingOrders()}sort(e,a){this.service.currentPage.next(1),this.service.sort.next(e),this.service.sortDirection.next(a),this.getBillingOrders()}limitChanged(e){this.service.currentPage.next(1),this.service.limit.next(e),this.getBillingOrders()}exportToExcel(){let e=this.elm.nativeElement.querySelector("#orders-table");const a=p.P6.table_to_sheet(e),r=p.P6.book_new();p.P6.book_append_sheet(r,a,"Sheet1"),p.NC(r,"orders.xlsx")}trackBy(e,a){return a.spaceId}static{this.\u0275fac=function(a){return new(a||n)(t.Y36(y),t.Y36(A.uw),t.Y36(t.SBq),t.Y36(B.P),t.Y36(c.sK))}}static{this.\u0275cmp=t.Xpm({type:n,selectors:[["billing-orders"]],standalone:!0,features:[t.jDz],decls:9,vars:7,consts:[[1,"p-2"],[3,"meta","admin","limit","pageChange","limitChanged"],["filters",""],[3,"service","export","emitChange"],["content",""],["class","table","id","orders-table",4,"ngIf"],[4,"ngIf"],["id","orders-table",1,"table"],[1,"bg-gray","border-bottom"],[1,"text-center"],[1,"text-left"],[1,"flex","aic"],[1,"mr-50"],[3,"down","up"],[1,"flex-center"],["class","border-bottom pointer",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-bottom","pointer"],[1,"fs-13"],[1,"bold","primary"],["class","flex jcc chip px-1 rounded-5 bg-primary white",4,"ngIf"],["class","flex jcc chip px-1 rounded-5 bg-danger white",4,"ngIf"],[1,"flex","jcc","chip","px-1","rounded-5","bg-primary","white"],[1,"flex","jcc","chip","px-1","rounded-5","bg-danger","white"]],template:function(a,r){1&a&&(t._UZ(0,"user-navbar"),t.TgZ(1,"div",0)(2,"layout-with-filters",1),t.NdJ("pageChange",function(T){return r.changePage(T)})("limitChanged",function(T){return r.limitChanged(T)}),t.ynx(3,2),t.TgZ(4,"spaces",3),t.NdJ("export",function(){return r.exportToExcel()})("emitChange",function(){return r.getBillingOrders()}),t.qZA(),t.BQk(),t.ynx(5,4),t.YNc(6,I,51,39,"table",5),t.YNc(7,M,1,0,"not-found",6),t.YNc(8,N,1,0,"loading",6),t.BQk(),t.qZA()()),2&a&&(t.xp6(2),t.Q6J("meta",r.meta)("admin",!0)("limit",r.service.limitValue),t.xp6(2),t.Q6J("service",r.service),t.xp6(2),t.Q6J("ngIf",r.orders&&r.orders.length>0&&!r.loading),t.xp6(1),t.Q6J("ngIf",r.orders&&0==r.orders.length&&!r.loading),t.xp6(1),t.Q6J("ngIf",r.loading))},dependencies:[l.ez,l.sg,l.O5,u.Y,c.aw,c.X$,f.i,_.JX,_._s,h.P,Z.w,o.N,x.o,v.v],styles:["table[_ngcontent-%COMP%]{min-width:150rem}th[_ngcontent-%COMP%]{min-width:max-content!important;width:max-content!important}"]})}}return n})()}}]);