"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[3923],{53851:(M,I,s)=>{s.d(I,{C:()=>x});var t=s(65879),C=s(96814),O=s(55254),v=s(17700),m=s(99758),h=s(56223),a=s(58964),Z=s(1350),E=s(32296),A=s(82458),K=s(89515),U=s(54807),e=s(52597),g=s(10480);function p(u,P){if(1&u){const _=t.EpF();t.TgZ(0,"div",11),t._UZ(1,"input-label",12),t.TgZ(2,"select-user",13),t.NdJ("getSelectedUsers",function(d){t.CHM(_);const D=t.oxw();return t.KtG(D.getUsers(d))}),t.qZA()()}if(2&u){const _=t.oxw();t.xp6(2),t.Q6J("selectedUsers",_.selectedUsers)}}function l(u,P){if(1&u){const _=t.EpF();t.TgZ(0,"div")(1,"div",14),t._UZ(2,"input-label",15),t.TgZ(3,"ng-select",16),t.NdJ("change",function(d){t.CHM(_);const D=t.oxw();return t.KtG(D.selectType(d))}),t.qZA(),t._UZ(4,"input-error",17),t.qZA()()}if(2&u){const _=t.oxw();t.Tol(null!=_.selectedLeaveType&&_.selectedLeaveType.isPermission?"col-lg-12":"col-lg-6"),t.xp6(2),t.Q6J("control",_.f.leaveTypeId),t.xp6(1),t.Q6J("items",_.leaveTypes)("clearSearchOnAdd",!0),t.xp6(1),t.Q6J("control",_.f.leaveTypeId)}}function c(u,P){if(1&u&&(t.TgZ(0,"div")(1,"div",18),t._UZ(2,"input-label",19)(3,"input",20)(4,"input-error",17),t.qZA()()),2&u){const _=t.oxw();t.Tol(null!=_.data&&_.data.leaveData?"col-lg-12":"col-lg-6"),t.xp6(2),t.Q6J("control",_.f.balance),t.xp6(2),t.Q6J("control",_.f.balance)}}let x=(()=>{class u{constructor(_,T,d){this.fb=_,this.data=T,this.dialogRef=d,this.service=(0,t.f3M)(O.e),this.leaveRequestsSer=(0,t.f3M)(e.N),this.leaveTypes=[],this.dialog=(0,t.f3M)(v.uw),this.alert=(0,t.f3M)(m.c),this.loading=!1,this.selectedUsers=[],this.form=this.fb.group({leaveTypeId:[null,h.kI.required],balance:[0,h.kI.required],accruals:[0,h.kI.required]})}ngOnInit(){this.leaveRequestsSer.getLeaveTypes().subscribe(_=>this.leaveTypes=_.data),this.data&&this.data.leaveData&&this.form.patchValue({leaveTypeId:this.data.leaveData.leaveTypeId,balance:this.data.leaveData.balance,accruals:this.data.leaveData.accruals})}selectType(_){this.selectedLeaveType=_}submit(){let _;if(_=this.data?[Number(this.data.employeeId)]:this.selectedUsers.map(T=>T.id),this.form.valid)if(this.loading=!0,this.data&&this.data.leaveData){let T={balance:-this.data.leaveData.balance+this.form.value.balance,userid:Number(this.data.employeeId),leaveTypeId:this.data.leaveData.leaveTypeId};this.service.updateBalance(T).subscribe(d=>{d.success?(this.alert.showAlert("balance_added"),this.dialogRef.close(!0)):this.loading=!1})}else{let T={...this.form.value,accruals:this.form.value.balance,usersId:_};this.service.addBalance(T).subscribe(d=>{d.success?(this.alert.showAlert("balance_added"),this.dialogRef.close(!0)):this.loading=!1})}}getUsers(_){this.selectedUsers=_}get f(){return this.form.controls}static{this.\u0275fac=function(T){return new(T||u)(t.Y36(h.qu),t.Y36(v.WI),t.Y36(v.so))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["assign-leave-form"]],standalone:!0,features:[t.jDz],decls:17,vars:13,consts:[[1,"add-leave","dir"],["mat-dialog-content","",1,"overflow-visible"],[3,"formGroup"],[1,"flex-grid","gap-y-2"],["class","col-lg-12",4,"ngIf"],[3,"class",4,"ngIf"],["mat-dialog-actions","","align","end"],[1,"flex","w-100"],["mat-dialog-close","",1,"px-4","flex-50","mr-2","dark-color","clickable-btn","rounded","cancel-btn"],["mat-raised-button","","color","primary",1,"px-5","fs-15","flex-50",3,"disabled","click"],[3,"text","loading"],[1,"col-lg-12"],["key","assignees"],["text","assignees",3,"selectedUsers","getSelectedUsers"],[1,"type"],["key","leave_type",3,"control"],["bindLabel","name","bindValue","id","appendTo","body","formControlName","leaveTypeId",3,"items","clearSearchOnAdd","change"],[3,"control"],[1,"days-number"],["key","days_number",3,"control"],["type","number","formControlName","balance","min","0",1,"input"]],template:function(T,d){1&T&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",1)(5,"form",2)(6,"div",3),t.YNc(7,p,3,1,"div",4),t.YNc(8,l,5,7,"div",5),t.YNc(9,c,5,5,"div",5),t.qZA()()(),t.TgZ(10,"div",6)(11,"div",7)(12,"button",8),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"button",9),t.NdJ("click",function(){return d.submit()}),t._UZ(16,"submit-button",10),t.qZA()()()()),2&T&&(t.xp6(2),t.Oqu(t.lcZ(3,9,null!=d.data&&d.data.leaveData?"edit_leave":"assign_leave")),t.xp6(3),t.Q6J("formGroup",d.form),t.xp6(2),t.Q6J("ngIf",!(null!=d.data&&d.data.disableUser)),t.xp6(1),t.Q6J("ngIf",!(null!=d.data&&d.data.leaveData)),t.xp6(1),t.Q6J("ngIf",!(null!=d.selectedLeaveType&&d.selectedLeaveType.isPermission)),t.xp6(4),t.Oqu(t.lcZ(14,11,"cancel")),t.xp6(2),t.Q6J("disabled",d.form.invalid||d.loading||0==d.selectedUsers.length&&!(null!=d.data&&d.data.disableUser)),t.xp6(1),t.Q6J("text",null!=d.data&&d.data.leaveData?"edit_leave":"assign_leave")("loading",d.loading))},dependencies:[C.ez,C.O5,a.w,Z.i,E.ot,E.lW,v.Is,v.ZT,v.xY,v.H8,h.UX,h._Y,h.Fj,h.wV,h.JJ,h.JL,h.qQ,h.sg,h.u,A.w,K.aw,K.X$,U.A0,U.w9,g.V],styles:[".overflow-visible[_ngcontent-%COMP%]{overflow:visible}"]})}}return u})()},9004:(M,I,s)=>{s.d(I,{D:()=>g});var t=s(65879),C=s(96814),O=s(70468),v=s(54807),m=s(56223),h=s(89515),a=s(24110);function Z(p,l){if(1&p&&t._UZ(0,"filter-label",3),2&p){const c=t.oxw();t.Q6J("key",c.label)}}function E(p,l){if(1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&p){const c=t.oxw().items;t.xp6(1),t.hij("",t.Dn7(2,1,c[0].name,0,10),"...")}}function A(p,l){if(1&p&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&p){const c=t.oxw().items;t.xp6(1),t.Oqu(c[0].name)}}function K(p,l){if(1&p&&(t.TgZ(0,"div",12)(1,"span",13),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&p){const c=t.oxw().items;t.xp6(2),t.AsE("",c.length-1," ",t.lcZ(3,2,"more"),"...")}}function U(p,l){if(1&p){const c=t.EpF();t.TgZ(0,"div",6)(1,"span",7)(2,"span",8),t.YNc(3,E,3,5,"span",9),t.YNc(4,A,2,1,"span",9),t.qZA()(),t.TgZ(5,"span",10),t.NdJ("click",function(){const u=t.CHM(c);return t.KtG((0,u.clear)(u.items[0]))}),t._uU(6,"\xd7"),t.qZA()(),t.YNc(7,K,4,4,"div",11)}if(2&p){const c=l.items;t.xp6(3),t.Q6J("ngIf",c[0].name.length>=10),t.xp6(1),t.Q6J("ngIf",c[0].name.length<10),t.xp6(3),t.Q6J("ngIf",c.length>1)}}function e(p,l){if(1&p&&(t.TgZ(0,"ng-select",4),t.ALo(1,"async"),t.YNc(2,U,8,3,"ng-template",5),t.qZA()),2&p){const c=t.oxw();t.Gre("",c.width," icon-input"),t.s9C("formControlName",c.formControlName),t.Q6J("items",t.lcZ(1,8,c.service.departments$))("clearSearchOnAdd",!0)("multiple",c.multiable)("closeOnSelect",c.closeOnSelect)}}let g=(()=>{class p{constructor(){this.label="departments",this.labelVisibilty=!0,this.width="w-24r",this.multiable=!0,this.selectedDepartment=this.multiable?[]:null,this.closeOnSelect=!1,this.formControlName=null,this.valueChanged=new t.vpe,this.service=(0,t.f3M)(a.U)}onChange(){this.valueChanged.emit(this.selectedDepartment)}static{this.\u0275fac=function(x){return new(x||p)}}static{this.\u0275cmp=t.Xpm({type:p,selectors:[["departments-form"]],inputs:{label:"label",labelVisibilty:"labelVisibilty",width:"width",multiable:"multiable",selectedDepartment:"selectedDepartment",closeOnSelect:"closeOnSelect",formControlName:"formControlName"},outputs:{valueChanged:"valueChanged"},standalone:!0,features:[t._Bn([],[{provide:m.gN,useExisting:m.sg}]),t.jDz],decls:3,vars:2,consts:[[1,"departments-filter"],[3,"key",4,"ngIf"],["bindLabel","name","bindValue","id","appendTo","body",3,"class","items","clearSearchOnAdd","multiple","closeOnSelect","formControlName",4,"ngIf"],[3,"key"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","clearSearchOnAdd","multiple","closeOnSelect","formControlName"],["ng-multi-label-tmp",""],[1,"ng-value","flex","aic"],[1,"ng-value-label"],[1,"flex","aic","fs-10"],[4,"ngIf"],["aria-hidden","true",1,"ng-value-icon","right",3,"click"],["class","ng-value rounded-2",4,"ngIf"],[1,"ng-value","rounded-2"],[1,"ng-value-label","fs-10"]],template:function(x,u){1&x&&(t.TgZ(0,"div",0),t.YNc(1,Z,1,1,"filter-label",1),t.YNc(2,e,3,10,"ng-select",2),t.qZA()),2&x&&(t.xp6(1),t.Q6J("ngIf",u.labelVisibilty),t.xp6(1),t.Q6J("ngIf",u.formControlName))},dependencies:[C.ez,C.O5,C.Ov,C.OU,O.r,v.A0,v.w9,v.zB,m.u5,m.JJ,h.aw,h.X$,m.UX,m.u],encapsulation:2})}}return p})()},46540:(M,I,s)=>{s.d(I,{o:()=>e});var t=s(65879),C=s(96814),O=s(70468),v=s(54807),m=s(56223),h=s(89515),a=s(69862),Z=s(69323);function E(g,p){if(1&g&&t._UZ(0,"i"),2&g){const l=t.oxw();t.Gre("fs-11 mr-50 bx ",l.icon,"")}}function A(g,p){if(1&g&&t._UZ(0,"filter-label",5),2&g){const l=t.oxw();t.Q6J("key",l.label)}}function K(g,p){if(1&g){const l=t.EpF();t.TgZ(0,"ng-select",6),t.NdJ("search",function(x){t.CHM(l);const u=t.oxw();return t.KtG(u.search(x))}),t.qZA()}if(2&g){const l=t.oxw();t.Gre("",l.width," icon-input"),t.Q6J("items",l.allItems)("formControlName",l.formControlName)("multiple",l.multiable)("closeOnSelect",l.closeOnSelect)}}function U(g,p){if(1&g){const l=t.EpF();t.TgZ(0,"ng-select",7),t.NdJ("search",function(x){t.CHM(l);const u=t.oxw();return t.KtG(u.search(x))}),t.qZA()}if(2&g){const l=t.oxw();t.Gre("",l.width," icon-input"),t.Q6J("items",l.allItems)("multiple",l.multiable)("closeOnSelect",l.closeOnSelect)}}let e=(()=>{class g{constructor(l){this.service=l,this.label="users",this.labelVisibilty=!0,this.width="w-100",this.multiable=!1,this.closeOnSelect=!0,this.formControlName=null,this.valueChanged=new t.vpe}ngOnInit(){this.getItems()}search(l){this.searchValue=l.term,this.getItems()}getItems(){let l=(new a.LE).set("limit",30);this.searchValue&&(l=l.set("search",this.searchValue)),this.service.getUsers(l).subscribe(c=>{this.allItems=c.data.items,this.totalItems=c.data.totalItems})}onChange(){this.valueChanged.emit(this.selectedDepartment)}static{this.\u0275fac=function(c){return new(c||g)(t.Y36(Z.j))}}static{this.\u0275cmp=t.Xpm({type:g,selectors:[["space-users-form"]],inputs:{icon:"icon",selectedDepartment:"selectedDepartment",label:"label",labelVisibilty:"labelVisibilty",width:"width",multiable:"multiable",closeOnSelect:"closeOnSelect",formControlName:"formControlName"},outputs:{valueChanged:"valueChanged"},standalone:!0,features:[t._Bn([],[{provide:m.gN,useExisting:m.sg}]),t.jDz],decls:5,vars:4,consts:[[1,"departments-filter"],[3,"class",4,"ngIf"],[3,"key",4,"ngIf"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","formControlName","class","multiple","closeOnSelect","search",4,"ngIf"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","class","multiple","closeOnSelect","search",4,"ngIf"],[3,"key"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","formControlName","multiple","closeOnSelect","search"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","multiple","closeOnSelect","search"]],template:function(c,x){1&c&&(t.TgZ(0,"div",0),t.YNc(1,E,1,3,"i",1),t.YNc(2,A,1,1,"filter-label",2),t.YNc(3,K,1,7,"ng-select",3),t.YNc(4,U,1,6,"ng-select",4),t.qZA()),2&c&&(t.xp6(1),t.Q6J("ngIf",x.icon),t.xp6(1),t.Q6J("ngIf",x.labelVisibilty),t.xp6(1),t.Q6J("ngIf",x.formControlName),t.xp6(1),t.Q6J("ngIf",!x.formControlName))},dependencies:[C.ez,C.O5,O.r,v.A0,v.w9,m.u5,m.JJ,h.aw,m.UX,m.u],encapsulation:2})}}return g})()},55254:(M,I,s)=>{s.d(I,{e:()=>v});var t=s(20553),C=s(65879),O=s(69862);let v=(()=>{class m{updateLeaveType(a){return this.http.post(`${t.N.apiUrl}api/Leave/UpdateLeaveType`,a)}constructor(a){this.http=a}addLeaves(a){return this.http.post(`${t.N.apiUrl}api/Leave/AddLeaveType`,a)}addBalance(a){return this.http.post(`${t.N.apiUrl}api/Leave/AddLeaveBalance`,a)}updateBalance(a){return this.http.put(`${t.N.apiUrl}api/Leave/UpdateLeaveBalance`,a)}addHoliday(a){return this.http.post(`${t.N.apiUrl}api/Space/AddHoliDay`,a)}editHoliday(a){return this.http.post(`${t.N.apiUrl}api/Space/UpdateHoliDay`,a)}static{this.\u0275fac=function(Z){return new(Z||m)(C.LFG(O.eN))}}static{this.\u0275prov=C.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()},26112:(M,I,s)=>{s.d(I,{u:()=>q});var t=s(89515),C=s(65668),O=s(96814),v=s(57105),m=s(17700),h=s(1350),a=s(56223),Z=s(58964),E=s(92596),A=s(52081),K=s(32801),U=s(10480),e=s(65879),g=s(69323),p=s(64190),l=s(99758);const c=["dialogTemplate"],x=["userDialogTemplate"];function u(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"a",10),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.openDialog())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"add_kpis")," "))}function P(i,f){1&i&&(e.TgZ(0,"div",11),e._UZ(1,"loading"),e.qZA())}function _(i,f){1&i&&(e.TgZ(0,"th",16),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"status")))}function T(i,f){1&i&&e._UZ(0,"i",27)}function d(i,f){1&i&&e._UZ(0,"i",28)}function D(i,f){if(1&i&&(e.TgZ(0,"td",21)(1,"div",24),e.YNc(2,T,1,0,"i",25),e.YNc(3,d,1,0,"i",26),e.qZA()()),2&i){const n=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("ngIf",(null==o.userKpi?null:o.userKpi.id)==n.id),e.xp6(1),e.Q6J("ngIf",(null==o.userKpi?null:o.userKpi.id)!=n.id)}}function y(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().$implicit,b=e.oxw(2);return e.KtG(b.activateKpi(r.id))}),e._UZ(1,"i",30),e.qZA()}}function L(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().$implicit,b=e.oxw(2);return e.KtG(b.openDialog(r.id))}),e._UZ(1,"img",31),e.qZA()}}function N(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().$implicit,b=e.oxw(2);return e.KtG(b.getKpiUsers(r))}),e._UZ(1,"i",32),e.qZA()}}function J(i,f){if(1&i&&(e.TgZ(0,"tr",19),e.YNc(1,D,4,2,"td",20),e.TgZ(2,"td",21),e._uU(3),e.ALo(4,"arabicNumbers"),e.qZA(),e.TgZ(5,"td",21),e._uU(6),e.ALo(7,"arabicNumbers"),e.qZA(),e.TgZ(8,"td",21),e._uU(9),e.ALo(10,"arabicNumbers"),e.qZA(),e.TgZ(11,"td",21),e._uU(12),e.ALo(13,"arabicNumbers"),e.qZA(),e.TgZ(14,"td",21),e._uU(15),e.ALo(16,"arabicNumbers"),e.qZA(),e.TgZ(17,"td",21)(18,"div",22),e.YNc(19,y,2,0,"div",23),e.YNc(20,L,2,0,"div",23),e.YNc(21,N,2,0,"div",23),e.qZA()()()),2&i){const n=f.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!o.space),e.xp6(2),e.Oqu(e.lcZ(4,9,n.tasksKPIValue)+" %"),e.xp6(3),e.Oqu(e.lcZ(7,11,n.rateKPIValue)+" %"),e.xp6(3),e.Oqu(e.lcZ(10,13,n.managerRateKPIValue)+" %"),e.xp6(3),e.Oqu(e.lcZ(13,15,n.timeSheetKPIValue)+" %"),e.xp6(3),e.Oqu(e.lcZ(16,17,n.attendanceKPIValue)+" %"),e.xp6(4),e.Q6J("ngIf",(null==o.userKpi?null:o.userKpi.id)!=n.id&&!o.space),e.xp6(1),e.Q6J("ngIf",o.space),e.xp6(1),e.Q6J("ngIf",o.space)}}function Q(i,f){if(1&i&&(e.TgZ(0,"div",12)(1,"table",13)(2,"thead")(3,"tr",14),e.YNc(4,_,3,3,"th",15),e.TgZ(5,"th",16),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"th",16),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"th",16),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"th",16),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"th",16),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"th",16),e.qZA()(),e.TgZ(21,"tbody",17),e.YNc(22,J,22,19,"tr",18),e.qZA()()()),2&i){const n=e.oxw();e.xp6(4),e.Q6J("ngIf",!n.space),e.xp6(2),e.Oqu(e.lcZ(7,7,"tasks_value")),e.xp6(3),e.Oqu(e.lcZ(10,9,"task_rate_value")),e.xp6(3),e.Oqu(e.lcZ(13,11,"manager_rate_value")),e.xp6(3),e.Oqu(e.lcZ(16,13,"timesheet_value")),e.xp6(3),e.Oqu(e.lcZ(19,15,"attendance_value")),e.xp6(4),e.Q6J("ngForOf",n.spaceKpis)}}function B(i,f){1&i&&(e.TgZ(0,"div",33),e._UZ(1,"not-found"),e.qZA())}function R(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",34)(1,"div",35)(2,"h4"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"i",36),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.closeDialog())}),e.qZA()(),e.TgZ(6,"mat-dialog-content")(7,"form",37)(8,"div",38)(9,"div",39)(10,"div",40),e._UZ(11,"input-label",41)(12,"input",42)(13,"input-error",43),e.qZA()(),e.TgZ(14,"div",39)(15,"div",40),e._UZ(16,"input-label",44)(17,"input",45)(18,"input-error",43),e.qZA()(),e.TgZ(19,"div",39)(20,"div",40),e._UZ(21,"input-label",46)(22,"input",47)(23,"input-error",43),e.qZA()(),e.TgZ(24,"div",39)(25,"div",40),e._UZ(26,"input-label",48)(27,"input",49)(28,"input-error",43),e.qZA()(),e.TgZ(29,"div",39)(30,"div",40),e._UZ(31,"input-label",50)(32,"input",51)(33,"input-error",43),e.qZA()()()()(),e.TgZ(34,"mat-dialog-actions")(35,"div",52)(36,"a",10),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.createKpi())}),e._uU(37),e.ALo(38,"translate"),e.qZA()()()()}if(2&i){const n=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,13,n.selectedKpi?"edit_kpis":"add_kpis")),e.xp6(4),e.Q6J("formGroup",n.form),e.xp6(4),e.Q6J("control",n.f.tasksKPIValue),e.xp6(2),e.Q6J("control",n.f.tasksKPIValue),e.xp6(3),e.Q6J("control",n.f.rateKPIValue),e.xp6(2),e.Q6J("control",n.f.rateKPIValue),e.xp6(3),e.Q6J("control",n.f.managerRateKPIValue),e.xp6(2),e.Q6J("control",n.f.managerRateKPIValue),e.xp6(3),e.Q6J("control",n.f.timeSheetKPIValue),e.xp6(2),e.Q6J("control",n.f.timeSheetKPIValue),e.xp6(3),e.Q6J("control",n.f.attendanceKPIValue),e.xp6(2),e.Q6J("control",n.f.attendanceKPIValue),e.xp6(4),e.hij(" ",e.lcZ(38,15,n.selectedKpi?"edit_kpis":"add_kpis")," ")}}function w(i,f){1&i&&(e.TgZ(0,"div",57),e._UZ(1,"loading"),e.qZA())}function F(i,f){if(1&i&&(e.TgZ(0,"p",59),e._UZ(1,"app-img-title",60),e.qZA()),2&i){const n=f.$implicit;e.xp6(1),e.Q6J("imgSrc",null==n?null:n.imageUrl)("title",null==n?null:n.name)("subTitle",n.jobTitle)}}function W(i,f){if(1&i&&(e.ynx(0),e.YNc(1,F,2,3,"p",58),e.BQk()),2&i){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.users)}}function S(i,f){1&i&&(e.TgZ(0,"div",61),e._UZ(1,"not-found"),e.qZA())}function V(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"a",65),e.NdJ("click",function(){e.CHM(n);const r=e.oxw(3);return e.KtG(r.activateKpi(r.selectedKpi.id))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"save")," "))}function Y(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",62),e.YNc(1,V,3,3,"a",63),e.TgZ(2,"select-user",64),e.NdJ("getSelectedUsers",function(r){e.CHM(n);const b=e.oxw(2);return e.KtG(b.getSelectedUsers(r))}),e.qZA()()}if(2&i){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.selectedUsers.length>0)}}function k(i,f){if(1&i){const n=e.EpF();e.TgZ(0,"div",34)(1,"div",35)(2,"h4"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"i",36),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.closeDialog())}),e.qZA()(),e.TgZ(6,"mat-dialog-content"),e.ynx(7),e.YNc(8,w,2,0,"div",53),e.YNc(9,W,2,1,"ng-container",54),e.YNc(10,S,2,0,"div",55),e.BQk(),e.qZA(),e.YNc(11,Y,3,1,"div",56),e.qZA()}if(2&i){const n=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,5,"employees")),e.xp6(5),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",n.users.length>0&&!n.loading),e.xp6(1),e.Q6J("ngIf",0==n.users.length&&!n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading)}}let q=(()=>{class i{getSelectedUsers(n){this.selectedUsers=[],setTimeout(()=>{n.forEach(o=>{this.selectedUsers.push(o.id)})},0)}constructor(n,o,r,b,G,j){this.datePipe=n,this.service=o,this.dialog=r,this.route=b,this.alert=G,this.fb=j,this.space=!1,this.spaceKpis=[],this.loading=!1,this.employeeId=this.route.snapshot.params.id,this.users=[],this.selectedUsers=[]}ngOnInit(){this.getKpisList(),this.form=this.fb.group({tasksKPIValue:[20,[a.kI.max(100),a.kI.required]],rateKPIValue:[20,[a.kI.max(100),a.kI.required]],managerRateKPIValue:[20,[a.kI.max(100),a.kI.required]],timeSheetKPIValue:[20,[a.kI.max(100),a.kI.required]],attendanceKPIValue:[20,[a.kI.max(100),a.kI.required]]})}getKpisList(){this.loading=!0,this.service.getKpisList().subscribe(n=>{n.success&&(this.spaceKpis=n.data,this.space?this.loading=!1:this.getUserKpi())})}getUserKpi(){this.service.getUserKpi(this.employeeId).subscribe(n=>{this.loading=!1,n.success&&(this.userKpi=n.data)})}openDialog(n){this.form.reset(),this.selectedKpi=null,setTimeout(()=>{n&&(this.selectedKpi=n),this.form.patchValue({...n}),this.dialog.open(this.dialogTemplate,{width:"700px"})},0)}closeDialog(){this.dialog.closeAll()}getKpiUsers(n){this.loading=!0,this.selectedKpi=n,this.dialog.open(this.userDialogTemplate,{width:"700px"}),this.getUsers()}getUsers(){this.service.getKpiUsers(this.selectedKpi.id).subscribe(n=>{this.loading=!1,this.users=n.data})}get f(){return this.form.controls}createKpi(){const n=Object.values(this.form.value).reduce((r,b)=>r+b,0);let o=this.form.value;this.selectedKpi&&null!=this.selectedKpi&&(o.id=this.selectedKpi.id),this.form.valid&&100==n?this.service.createOrUpdateKpi(o).subscribe(r=>{r.success&&(this.alert.showAlert("success"),this.getKpisList(),this.closeDialog())}):(this.form.markAllAsTouched(),this.alert.showAlert("total_values_must_equal_100","bg-danger"))}activateKpi(n){this.loading=!0,this.service.setUserKpi({kpiId:n,userId:this.employeeId?[this.employeeId]:this.selectedUsers}).subscribe(o=>{this.loading=!1,o.success&&(this.alert.showAlert("success"),this.getKpisList(),this.space&&(this.selectedUsers=[],this.getUsers()))})}deactivateKpi(){this.service.removeUserKpi(this.employeeId).subscribe(n=>{this.alert.showAlert("success"),this.getKpisList()})}static{this.\u0275fac=function(o){return new(o||i)(e.Y36(O.uU),e.Y36(g.j),e.Y36(m.uw),e.Y36(p.gz),e.Y36(l.c),e.Y36(a.qu))}}static{this.\u0275cmp=e.Xpm({type:i,selectors:[["kpis"]],viewQuery:function(o,r){if(1&o&&(e.Gf(c,5),e.Gf(x,5)),2&o){let b;e.iGM(b=e.CRH())&&(r.dialogTemplate=b.first),e.iGM(b=e.CRH())&&(r.userDialogTemplate=b.first)}},inputs:{space:"space"},standalone:!0,features:[e._Bn([O.uU]),e.jDz],decls:12,vars:4,consts:[[1,"py-1"],[1,"filters","flex-grid","mb-2","aie","jcsb","w-100","mx-0"],[1,"col-lg-12","text-right"],["style","display: inline-block;","class","btn rounded bg-primary white py-75 px-1 fs-14",3,"click",4,"ngIf"],[1,"px-50"],["class","aic flex jcc py-5 h-50v",4,"ngIf"],["class","table-container mx-1",4,"ngIf"],["class","py-5 text-center",4,"ngIf"],["dialogTemplate",""],["userDialogTemplate",""],[1,"btn","rounded","bg-primary","white","py-75","px-1","fs-14",2,"display","inline-block",3,"click"],[1,"aic","flex","jcc","py-5","h-50v"],[1,"table-container","mx-1"],[1,"w-100","rounded"],[1,"border-bottom","fs-12","simibold"],["class","text-left py-1",4,"ngIf"],[1,"text-left","py-1"],[1,"table-body"],["class","border-bottom fs-12",4,"ngFor","ngForOf"],[1,"border-bottom","fs-12"],["class","text-left",4,"ngIf"],[1,"text-left"],[1,"flex","aic","gap-x-2"],["class","img pointer",3,"click",4,"ngIf"],[1,"flex","aic"],["class","fs-18 success bx bx-check-circle",4,"ngIf"],["class","fs-18 danger bx bx-x-circle",4,"ngIf"],[1,"fs-18","success","bx","bx-check-circle"],[1,"fs-18","danger","bx","bx-x-circle"],[1,"img","pointer",3,"click"],[1,"bx","bx-check","success","fs-30"],["src","assets/images/icons/edit1.svg","alt","edit icon"],[1,"bx","bx-show","primary","fs-30"],[1,"py-5","text-center"],[1,"dir"],[1,"flex","w-100","jcsb"],[1,"bx","bx-x","fs-25","danger","pointer","p-1",3,"click"],["action","",3,"formGroup"],[1,"flex-grid","gap-y-2"],[1,"col-lg-6"],[1,"name"],["key","tasks_value",3,"control"],["type","number","max","100","formControlName","tasksKPIValue",1,"input"],[3,"control"],["key","rate_value",3,"control"],["type","number","max","100","formControlName","rateKPIValue",1,"input"],["key","manager_rate_value",3,"control"],["type","number","max","100","formControlName","managerRateKPIValue",1,"input"],["key","timesheet_value",3,"control"],["type","number","max","100","formControlName","timeSheetKPIValue",1,"input"],["key","attendance_value",3,"control"],["type","number","max","100","formControlName","attendanceKPIValue",1,"input"],[1,"text-right","w-100"],["class","aic flex jcc py-2 h-50v",4,"ngIf"],[4,"ngIf"],["class","py-2 text-center",4,"ngIf"],["class","flex jce","mat-dialog-actions","",4,"ngIf"],[1,"aic","flex","jcc","py-2","h-50v"],["class","py-1 border-bottom",4,"ngFor","ngForOf"],[1,"py-1","border-bottom"],[3,"imgSrc","title","subTitle"],[1,"py-2","text-center"],["mat-dialog-actions","",1,"flex","jce"],["class","flex aic py-75 shadow mr-1 rounded bg-primary white px-3 fs-14 pointer",3,"click",4,"ngIf"],["text","assignees",3,"getSelectedUsers"],[1,"flex","aic","py-75","shadow","mr-1","rounded","bg-primary","white","px-3","fs-14","pointer",3,"click"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,u,3,3,"a",3),e.qZA()(),e.TgZ(4,"div",4),e.YNc(5,P,2,0,"div",5),e.YNc(6,Q,23,17,"div",6),e.YNc(7,B,2,0,"div",7),e.qZA()(),e.YNc(8,R,39,17,"ng-template",null,8,e.W1O),e.YNc(10,k,12,7,"ng-template",null,9,e.W1O)),2&o&&(e.xp6(3),e.Q6J("ngIf",r.space),e.xp6(2),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",r.spaceKpis.length>0&&!r.loading),e.xp6(1),e.Q6J("ngIf",0==r.spaceKpis.length&&!r.loading))},dependencies:[O.ez,O.sg,O.O5,C.N,v.w,t.aw,t.X$,m.Is,m.xY,m.H8,a.u5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Fd,a.UX,a.sg,a.u,h.i,Z.w,E.AV,A.m,K.G,U.V],styles:["[_nghost-%COMP%]     .search, [_nghost-%COMP%]     .ng-select{width:100%}[_nghost-%COMP%]     label{font-size:11px}.table-container[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0}th[_ngcontent-%COMP%]{border:none;position:sticky;top:0;z-index:1}tbody[_ngcontent-%COMP%]{padding-bottom:5px}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-block:10px;padding-inline:15px;border:none;font-size:12px}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-inline:15px;border:none}tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.btn[_ngcontent-%COMP%]{display:inline-block;height:41.2px}.aie[_ngcontent-%COMP%]{align-items:end}.table-filter-content[_ngcontent-%COMP%]{height:calc(100vh - 110px)}.table-container[_ngcontent-%COMP%]{overflow:auto}.pagination-content[_ngcontent-%COMP%]{margin-top:-5px}"]})}}return i})()}}]);