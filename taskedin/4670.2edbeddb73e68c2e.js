"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[4670],{3131:(b,h,n)=>{n.d(h,{P:()=>e});var p=n(65619),x=n(65879);let e=(()=>{class m{constructor(){this.withSubMenu=new p.X(!0)}static{this.\u0275fac=function(f){return new(f||m)}}static{this.\u0275prov=x.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()},53451:(b,h,n)=>{n.d(h,{L:()=>v});var p=n(34673),x=n(83620),e=n(94664),m=n(37398),T=n(65619),u=n(20553),f=n(65879),U=n(69862);let v=(()=>{class g extends p.q{constructor(a){super(),this.http=a,this.users$=this.hasChanged.pipe((0,x.b)(400),(0,e.w)(()=>this.getUsers().pipe((0,m.U)(d=>d)))),this.selectedUsersToAddRole=new T.X([]),this.selectedUsersToAddRoleValue=[],this.selectedUsersToAddRole.subscribe(d=>this.selectedUsersToAddRoleValue=d)}getUsers(){this.loading.next(!0);const a=new URL(`${u.N.apiUrl}api/Space/GetSpaceUserProfiles`);return this.params(a,"all-users"),this.http.get(`${a}`).pipe((0,m.U)(d=>{this.loading.next(!1);let _=d.data.items;return this.setMeta(d),_.forEach(A=>{A.isSelected=this.selectedUsersToAddRoleValue.find(Z=>A.id==Z.id)}),_}))}addUserCV(a,d){return this.http.post(`${u.N.apiUrl}api/ProfileCv/AddUserCv?profileId=${d}`,a)}uploadCV(a,d,_){return this.http.put(`${u.N.apiUrl}api/ProfileCv/UploadUserCv?id=${d}&profileId=${_}`,a)}getRate(a){return this.http.get(`${u.N.apiUrl}api/Tasks/GetUserAverageRate?id=${a}`)}updateUser(a){return this.http.put(`${u.N.apiUrl}api/UserProfile/UpdateUserProfile`,a)}activateAccount(a){return this.http.put(`${u.N.apiUrl}api/UserProfile/UpdateActiveState`,a)}addOrRemoveRole(a){return this.http.post(`${u.N.apiUrl}api/ProfileRole/addOrRemoveRole`,a)}static{this.\u0275fac=function(d){return new(d||g)(f.LFG(U.eN))}}static{this.\u0275prov=f.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()},26560:(b,h,n)=>{n.r(h),n.d(h,{AllUsersComponent:()=>ee});var p=n(96814),x=n(38140),e=n(65879),m=n(85195),T=n(86760),u=n(55237),f=n(824),U=n(32296),v=n(75986),g=n(24971),N=n(10480),a=n(89515),d=n(17700),_=n(53451),A=n(15714);function Z(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"departments",14),e.NdJ("valueChanged",function(s){e.CHM(t);const r=e.oxw();return r.service.department.next(s),e.KtG(r.filter())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("selectedDepartment",t.service.department.value)}}function E(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"assignee-state",15),e.NdJ("valueChanged",function(s){e.CHM(t);const r=e.oxw();return r.service.assigneeState.next(s),e.KtG(r.filter())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("selectedValue",t.service.assigneeState.value)}}function R(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"date-filter",16),e.NdJ("valueChanged",function(s){e.CHM(t);const r=e.oxw();return r.service.dateFrom.next(s),r.service.dateTo.next(""),e.KtG(r.filter())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("selectedValue",t.service.dateFrom.value)}}function J(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"date-filter",17),e.NdJ("valueChanged",function(s){e.CHM(t);const r=e.oxw();return r.service.dateTo.next(s),e.KtG(r.filter())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("minDate",t.service.dateFrom.value)("selectedValue",t.service.dateTo.value)}}function P(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"select-user",18),e.NdJ("getSelectedUsers",function(s){e.CHM(t);const r=e.oxw();return r.service.managers.next(s),e.KtG(r.filter())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("selectedUsers",t.service.managers.value)}}function I(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"div",21)(1,"mat-checkbox",22),e.NdJ("change",function(){const r=e.CHM(t).$implicit,o=e.oxw(2);return e.KtG(o.unCheck(r))}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}if(2&l){const t=c.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("checked",i.visibleFilters[t])("indeterminate",!1)("labelPosition","after"),e.xp6(1),e.hij(" ",e.lcZ(3,4,t)," ")}}function k(l,c){if(1&l&&(e.TgZ(0,"div",19),e.NdJ("click",function(i){return i.stopImmediatePropagation()}),e.YNc(1,I,4,6,"div",20),e.qZA()),2&l){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filtersArray)}}const y=function(l){return{"bg-primary white":l}};let M=(()=>{class l{constructor(){this.export=new e.vpe,this.service=(0,e.f3M)(_.L),this.dialog=(0,e.f3M)(d.uw),this.showFilters=!1,this.visibleFilters={departments:!0,assignee_state:!0,managers:this.service.assignees.value.length>0,date:this.service.dateFrom.value||this.service.dateTo.value},this.filtersArray=Object.keys(this.visibleFilters).map(t=>t)}filter(){this.service.filter()}setRoles(){this.dialog.open(A.z,{panelClass:"add-roles-dialog",data:{users:this.service.selectedUsersToAddRoleValue}})}unCheck(t){this.visibleFilters[t]=!this.visibleFilters[t]}documentClickEvent(t){this.showFilters=!1}static{this.\u0275fac=function(i){return new(i||l)}}static{this.\u0275cmp=e.Xpm({type:l,selectors:[["all-users-filter"]],hostBindings:function(i,s){1&i&&e.NdJ("click",function(o){return s.documentClickEvent(o)},!1,e.evT)},outputs:{export:"export"},standalone:!0,features:[e.jDz],decls:18,vars:18,consts:[[1,"filters","flex","aic","jcsb","gap-x-4"],[1,"flex-wrap","aic","gap-x-1","gap-y-1"],[3,"key","valueChanged"],[3,"selectedDepartment","valueChanged",4,"ngIf"],[3,"selectedValue","valueChanged",4,"ngIf"],["key","start_date",3,"selectedValue","valueChanged",4,"ngIf"],["key","end_date",3,"minDate","selectedValue","valueChanged",4,"ngIf"],["class","no-label","text","managers",3,"selectedUsers","getSelectedUsers",4,"ngIf"],[1,"end","flex","aic","gap-x-2","pt-75"],["mat-raised-button","",3,"ngClass","disabled","click"],["mat-raised-button","",1,"bg-success","export",3,"click"],[1,"img","relative","pointer",3,"click"],["alt","","src","assets/images/icons/filters.svg",1,"convert-image-color"],["class","filters-menu bg-white p-1 rounded","magicScroll","",3,"click",4,"ngIf"],[3,"selectedDepartment","valueChanged"],[3,"selectedValue","valueChanged"],["key","start_date",3,"selectedValue","valueChanged"],["key","end_date",3,"minDate","selectedValue","valueChanged"],["text","managers",1,"no-label",3,"selectedUsers","getSelectedUsers"],["magicScroll","",1,"filters-menu","bg-white","p-1","rounded",3,"click"],["class","menu-item",4,"ngFor","ngForOf"],[1,"menu-item"],["color","primary",3,"checked","indeterminate","labelPosition","change"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"search",2),e.NdJ("valueChanged",function(o){return s.service.search.next(o),s.filter()}),e.qZA(),e.YNc(3,Z,1,1,"departments",3),e.YNc(4,E,1,1,"assignee-state",4),e.YNc(5,R,1,1,"date-filter",5),e.YNc(6,J,1,2,"date-filter",6),e.YNc(7,P,1,1,"select-user",7),e.qZA(),e.TgZ(8,"div",8)(9,"button",9),e.NdJ("click",function(){return s.setRoles()}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"button",10),e.NdJ("click",function(){return s.export.emit()}),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",11),e.NdJ("click",function(o){return o.stopImmediatePropagation(),s.showFilters=!0}),e._UZ(16,"img",12),e.YNc(17,k,2,1,"div",13),e.qZA()()()),2&i&&(e.xp6(2),e.Q6J("key",s.service.search.value),e.xp6(1),e.Q6J("ngIf",s.visibleFilters.departments),e.xp6(1),e.Q6J("ngIf",s.visibleFilters.assignee_state),e.xp6(1),e.Q6J("ngIf",s.visibleFilters.date),e.xp6(1),e.Q6J("ngIf",s.visibleFilters.date),e.xp6(1),e.Q6J("ngIf",s.visibleFilters.managers),e.xp6(2),e.Q6J("ngClass",e.VKq(16,y,s.service.selectedUsersToAddRoleValue.length>0))("disabled",0==s.service.selectedUsersToAddRoleValue.length),e.xp6(1),e.AsE(" ",e.lcZ(11,12,"set_roles")," (",s.service.selectedUsersToAddRoleValue.length,") "),e.xp6(3),e.Oqu(e.lcZ(14,14,"export")),e.xp6(4),e.Q6J("ngIf",s.showFilters))},dependencies:[p.ez,p.mk,p.sg,p.O5,m.r,T.g,u.S,f.h,U.ot,U.lW,v.p9,v.oG,g.g,N.V,a.aw,a.X$]})}}return l})();var O=n(76472),S=n(45843),D=n(9619),Q=n(57105),L=n(65668),C=n(11486),$=n(83318),w=n(9983),q=n(17476),Y=n(99758);function K(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"i",28),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw(2).$implicit,o=e.oxw(2);return e.KtG(o.removeRole(r,s.roleName))}),e.qZA()}}function B(l,c){if(1&l&&(e.TgZ(0,"div",26)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,K,1,0,"i",27),e.qZA()),2&l){const t=c.$implicit;e.xp6(2),e.Oqu(t.roleName),e.xp6(1),e.Q6J("ngIf","SpaceAdmin"==t.roleName||"SpacelimitedUser"==t.roleName)}}function V(l,c){if(1&l&&(e.TgZ(0,"div",24),e.YNc(1,B,4,2,"div",25),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.profileRoles)}}function G(l,c){1&l&&(e.TgZ(0,"p",12),e._uU(1,"-"),e.qZA())}function j(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"tr",14)(1,"td")(2,"div",8)(3,"mat-checkbox",9),e.NdJ("change",function(s){const o=e.CHM(t).$implicit,F=e.oxw(2);return e.KtG(F.selectUser(s,o))}),e.qZA(),e._UZ(4,"user-image",15),e.TgZ(5,"div",16)(6,"p",17),e._uU(7),e.qZA(),e.TgZ(8,"p",18),e._uU(9),e.qZA()()()(),e.TgZ(10,"td",11),e._uU(11),e.qZA(),e.TgZ(12,"td",11),e._uU(13),e.qZA(),e.TgZ(14,"td",11),e._uU(15),e.qZA(),e.TgZ(16,"th",19),e._uU(17),e.ALo(18,"arabicDate"),e.qZA(),e.TgZ(19,"td",11),e._uU(20),e.qZA(),e.TgZ(21,"td",12),e.YNc(22,V,2,1,"div",20),e.YNc(23,G,2,0,"p",21),e.qZA(),e.TgZ(24,"td")(25,"div",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit,o=e.oxw(2);return e.KtG(o.editUser(r))}),e._UZ(26,"img",23),e.qZA()()()}if(2&l){const t=c.$implicit;e.xp6(3),e.Q6J("checked",t.isSelected),e.xp6(1),e.Q6J("img",t.imageUrl)("id",t.isActivated?t.id:0),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.jobTitle),e.xp6(2),e.Oqu(t.phoneNumber),e.xp6(2),e.Oqu(t.departmentName),e.xp6(2),e.Oqu(t.managerName),e.xp6(2),e.Oqu(e.xi3(18,12,t.creationDate,"typicalDate")),e.xp6(3),e.Oqu(t.memberCode),e.xp6(2),e.Q6J("ngIf",t.profileRoles.length>0),e.xp6(1),e.Q6J("ngIf",t.profileRoles.length<1)}}const H=function(l,c,t){return{itemsPerPage:l,currentPage:c,totalItems:t}};function W(l,c){if(1&l){const t=e.EpF();e.TgZ(0,"table",6)(1,"thead",7)(2,"tr")(3,"th")(4,"div",8)(5,"mat-checkbox",9),e.NdJ("change",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.selectAllUsers(s))}),e.qZA(),e.TgZ(6,"div",10),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"th",11),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"th",11),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"th",11),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"th"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"th",11),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"th",12),e._uU(25),e.ALo(26,"translate"),e.qZA(),e._UZ(27,"th"),e.qZA()(),e.TgZ(28,"tbody"),e.YNc(29,j,27,15,"tr",13),e.ALo(30,"paginate"),e.qZA()()}if(2&l){const t=e.oxw();e.xp6(5),e.Q6J("checked",t.allChecked),e.xp6(2),e.Oqu(e.lcZ(8,10,"user")),e.xp6(3),e.Oqu(e.lcZ(11,12,"phone")),e.xp6(3),e.Oqu(e.lcZ(14,14,"department")),e.xp6(3),e.Oqu(e.lcZ(17,16,"manager")),e.xp6(3),e.Oqu(e.lcZ(20,18,"joining_date")),e.xp6(3),e.Oqu(e.lcZ(23,20,"code")),e.xp6(3),e.Oqu(e.lcZ(26,22,"role")),e.xp6(4),e.Q6J("ngForOf",e.xi3(30,24,t.users,e.kEZ(27,H,t.meta.pageSize,t.meta.currentPage,t.meta.totalItems)))("ngForTrackBy",t.trackBy)}}function z(l,c){1&l&&e._UZ(0,"not-found")}function X(l,c){1&l&&e._UZ(0,"loading")}let ee=(()=>{class l{constructor(t,i,s,r,o){this.service=t,this.dialog=i,this.rolesSer=s,this.elm=r,this.alert=o,this.users=[],this.loading=!1,this.allChecked=!1,this.selectedUsers=[],this.selectedUsersToAddRole=[]}ngOnInit(){this.service.selectedUsersToAddRole.subscribe(t=>this.selectedUsersToAddRole=t),this.rolesSer.isAdmin.subscribe(t=>this.spaceAdmin=t),this.service.meta.subscribe(t=>this.meta=t),this.service.users$.subscribe(t=>{this.users=t,this.checkAllCheckedUsers()}),this.service.loading.subscribe(t=>this.loading=t),0==this.users.length&&this.service.search.next("")}getUsers(){this.service.hasChanged.next(!0)}selectAllUsers(t){this.allChecked=!0,this.users.forEach(i=>{this.selectUser(t,i)})}selectUser(t,i){t.checked?(i.isSelected=!0,this.getSelectedUsers()):(this.allChecked=!1,this.removeSelectedUser(i),i.isSelected=!1),this.checkAllCheckedUsers()}getSelectedUsers(){this.selectedUsers=this.users.filter(i=>i.isSelected),this.selectedUsers=this.selectedUsers.filter(i=>!this.selectedUsersToAddRole.find(s=>i.id==s.id)),this.service.selectedUsersToAddRole.next([].concat(this.selectedUsersToAddRole,this.selectedUsers))}removeSelectedUser(t){let i=this.selectedUsersToAddRole.filter(s=>t.id!=s.id);this.service.selectedUsersToAddRole.next(i)}checkAllCheckedUsers(){let t=0;this.users.forEach(i=>{i.isSelected&&t++}),this.allChecked=t==this.users.length}editUser(t){let i=!1;t.profileRoles.forEach(s=>{"SpaceSuperAdmin"==s.roleName&&(i=!0)}),this.dialog.open(w.a,{panelClass:"w-90v",data:{user:t,isSuperAdmin:i}})}removeRole(t,i){this.dialog.open($.v,{panelClass:"confirmation-dialog",data:{message:"delete_role",btn_name:"confirm",classes:"w-100 bg-primary white",user:t,roleName:i}}).afterClosed().subscribe(r=>{r&&this.service.addOrRemoveRole({profileIds:[t.id],roleNames:[i],isAddedRole:!1}).subscribe(F=>{F.success&&(this.alert.showAlert("role_removed"),this.service.hasChanged.next(!0))})})}pageChanged(t){this.service.page.next(t),this.getUsers()}limitChanged(t){this.service.page.next(1),this.service.limit.next(t),this.getUsers()}exportToExcel(){let t=this.elm.nativeElement.querySelector("#users");const i=C.P6.table_to_sheet(t),s=C.P6.book_new();C.P6.book_append_sheet(s,i,"Sheet1"),C.NC(s,"users.xlsx")}trackBy(t,i){return i.id}static{this.\u0275fac=function(i){return new(i||l)(e.Y36(_.L),e.Y36(d.uw),e.Y36(q.f),e.Y36(e.SBq),e.Y36(Y.c))}}static{this.\u0275cmp=e.Xpm({type:l,selectors:[["all-users"]],standalone:!0,features:[e.jDz],decls:7,vars:6,consts:[[3,"meta","admin","limit","pageChange","limitChanged"],["filters",""],[3,"export"],["content",""],["class","table","id","users",4,"ngIf"],[4,"ngIf"],["id","users",1,"table"],[1,"bg-gray","border-bottom"],[1,"flex","aic"],["color","primary",1,"mr-1","example-margin",3,"checked","change"],[1,"title"],[1,"text-left"],[1,"text-center"],["class","border-bottom",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-bottom"],[3,"img","id"],[1,"ml-1","text-left"],[1,"primary","bold","fs-14"],[1,"job-title","fs-11","muted"],[2,"width","13rem"],["class","flex-column gap-y-1",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"img","pointer",3,"click"],["src","assets/images/icons/edit1.svg","alt","edit icon"],[1,"flex-column","gap-y-1"],["class","flex-center gap-x-1",4,"ngFor","ngForOf"],[1,"flex-center","gap-x-1"],["class","bx bx-x danger fs-22 pointer",3,"click",4,"ngIf"],[1,"bx","bx-x","danger","fs-22","pointer",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"layout-with-filters",0),e.NdJ("pageChange",function(o){return s.pageChanged(o)})("limitChanged",function(o){return s.limitChanged(o)}),e.ynx(1,1),e.TgZ(2,"all-users-filter",2),e.NdJ("export",function(){return s.exportToExcel()}),e.qZA(),e.BQk(),e.ynx(3,3),e.YNc(4,W,31,31,"table",4),e.YNc(5,z,1,0,"not-found",5),e.YNc(6,X,1,0,"loading",5),e.BQk(),e.qZA()),2&i&&(e.Q6J("meta",s.meta)("admin",!0)("limit",s.service.limit.value),e.xp6(4),e.Q6J("ngIf",s.users&&s.users.length>0&&!s.loading),e.xp6(1),e.Q6J("ngIf",s.users&&0==s.users.length&&!s.loading),e.xp6(1),e.Q6J("ngIf",s.loading))},dependencies:[p.ez,p.sg,p.O5,x.Y,M,v.p9,v.oG,a.aw,a.X$,O.JX,O._s,S.l,D.P,Q.w,L.N],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:1.3rem!important}"]})}}return l})()}}]);