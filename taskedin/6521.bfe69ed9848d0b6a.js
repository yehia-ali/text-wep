"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[6521,1428,6526],{1428:(v,u,i)=>{i.d(u,{$:()=>f});var d=i(65879),p=i(96814),h=i(3131);const c=function(l){return{"max-width":l}},_=["*"];let f=(()=>{class l{constructor(){this.scroll=!1,this.service=(0,d.f3M)(h.P)}static{this.\u0275fac=function(g){return new(g||l)}}static{this.\u0275cmp=d.Xpm({type:l,selectors:[["layout"]],inputs:{scroll:"scroll"},standalone:!0,features:[d.jDz],ngContentSelectors:_,decls:2,vars:6,consts:[[3,"ngStyle"]],template:function(g,b){1&g&&(d.F$t(),d.TgZ(0,"div",0),d.Hsn(1),d.qZA()),2&g&&(d.Gre("",b.scroll?"scroll":""," layout rounded bg-white border"),d.Q6J("ngStyle",d.VKq(4,c,b.service.withSubMenu.value?"100vw":"calc(100vw - 92px)")))},dependencies:[p.ez,p.PC],styles:[".layout[_ngcontent-%COMP%]{overflow:hidden;height:calc(100vh - 11rem);box-shadow:0 1px 38px #0000001a,0 2px 4px -1px #0000000f}.scroll[_ngcontent-%COMP%]{overflow-y:auto!important}"]})}}return l})()},3131:(v,u,i)=>{i.d(u,{P:()=>h});var d=i(65619),p=i(65879);let h=(()=>{class c{constructor(){this.withSubMenu=new d.X(!0)}static{this.\u0275fac=function(l){return new(l||c)}}static{this.\u0275prov=p.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})()},46521:(v,u,i)=>{i.r(u),i.d(u,{LeaderBoardComponent:()=>Q});var d=i(56223),p=i(89515),h=i(96814),c=i(76472),_=i(1428),f=i(32801),l=i(52081),T=i(55006),x=i(69862),g=i(65668),b=i(57105),L=i(24971),D=i(20553),B=i(9619),M=i(11383),t=i(65879),y=i(37398);let Z=(()=>{class r{constructor(e){this.http=e,this.url=D.N.apiUrl}getKPI(){return this.http.get(`${this.url}api/KPIValues/GetBySpaceId`).pipe((0,y.U)(e=>e.data))}getLeaderBoardCached(e){return this.http.get(`${this.url}api/Tasks/LeaderBoardCached`,{params:e}).pipe((0,y.U)(a=>a.data))}setKPI(e){return this.http.post(`${this.url}api/KPIValues/edit`,e)}getLeaderBoard(e){return this.http.get(`${this.url}api/Tasks/LeaderBoard`,{params:e}).pipe((0,y.U)(a=>{const n=a.data.map((o,m)=>({...o,number:m+1}));return{pageSize:a.data.pageSize,totalActive:a.data.totalActive,totalUnSeen:a.data.totalUnSeen,totalPages:a.data.totalPages,totalItems:a.data.totalItems,items:n}}))}static{this.\u0275fac=function(a){return new(a||r)(t.LFG(x.eN))}}static{this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const w=["leaderBoardList"];function C(r,s){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",21),t.NdJ("click",function(){const o=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.dateRange(o.number))}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()}if(2&r){const e=s.$implicit,a=t.oxw();t.xp6(1),t.Gre("date-filter mr-1 pointer py-1 px-1 ",a.selectedDateFilter==e.number?"primary active":"",""),t.xp6(1),t.Oqu(t.lcZ(3,4,e.name))}}function P(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"div",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.monthFilter(n))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&r){const e=t.oxw().$implicit,a=t.oxw(2);t.Gre("month-filter mr-1 pointer py-25 rounded-4 border px-50 fs-12 ",a.currentMonth.name==e.name?"white bg-primary active-month":"",""),t.xp6(1),t.Oqu(t.lcZ(2,4,e.name))}}function I(r,s){if(1&r&&(t.ynx(0),t.YNc(1,P,3,6,"div",23),t.BQk()),2&r){const e=s.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.month<=a.currentCMonth.month)}}function A(r,s){if(1&r&&(t.ynx(0),t.TgZ(1,"div",22),t.YNc(2,I,2,1,"ng-container",5),t.qZA(),t.BQk()),2&r){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.months)}}function F(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"a",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.quarterFilter(n))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&r){const e=t.oxw().$implicit,a=t.oxw(2);t.Gre("month-filter mr-1 pointer py-25 rounded-4 border px-50 fs-12 ",e.start-1==a.quarterStartMonth?"white bg-primary active-month":"",""),t.xp6(1),t.Oqu(t.lcZ(2,4,e.name))}}function U(r,s){if(1&r&&(t.ynx(0),t.YNc(1,F,3,6,"a",23),t.BQk()),2&r){const e=s.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.start-1<=a.quarterCStartMonth)}}function S(r,s){if(1&r&&(t.ynx(0),t.TgZ(1,"div",22),t.YNc(2,U,2,1,"ng-container",5),t.qZA(),t.BQk()),2&r){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.quarters)}}function O(r,s){if(1&r&&(t.TgZ(0,"div",24)(1,"div")(2,"div"),t._UZ(3,"app-img-title",25),t.qZA(),t.TgZ(4,"h4",26),t._uU(5),t.qZA(),t.TgZ(6,"p",27),t._uU(7),t.qZA(),t.TgZ(8,"div",28)(9,"h5"),t._uU(10),t.ALo(11,"arabicNumbers"),t.qZA()()()()),2&r){const e=s.$implicit;t.xp6(1),t.Gre("item ",1==e.number?"primary-dark":"primary-light"," rounded p-1 h-100 text-center"),t.xp6(1),t.Gre("img aic jcc rounded-50 ",1==(null==e?null:e.number)?"leader":"",""),t.xp6(1),t.Q6J("imgSize",1==(null==e?null:e.number)?65:45)("imgSrc",null==e?null:e.data.img),t.xp6(2),t.Oqu(null==e?null:e.data.name),t.xp6(2),t.Oqu(null==e?null:e.data.jobTitle),t.xp6(2),t.Gre("rounded-50 light-bg white aic jcc bold ",1==(null==e?null:e.number)?"leader":"top",""),t.xp6(1),t.Oqu(t.lcZ(11,14,null==e?null:e.number))}}function K(r,s){if(1&r&&(t.TgZ(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),t._uU(4),t.qZA(),t.TgZ(5,"div",33),t._UZ(6,"app-img-title",34),t.qZA()(),t.TgZ(7,"div",35),t._UZ(8,"div"),t.TgZ(9,"div",36)(10,"p",37),t._uU(11),t.ALo(12,"arabicNumbers"),t.qZA()()()()()),2&r){const e=s.$implicit,a=s.index;t.xp6(4),t.Oqu(a+1),t.xp6(2),t.Q6J("imgSrc",e.img)("imgSize",50)("title",e.name)("subTitle",e.jobTitle),t.xp6(5),t.Oqu(t.lcZ(12,6,e.percentage))}}function q(r,s){1&r&&t._UZ(0,"loading")}function E(r,s){1&r&&t._UZ(0,"not-found")}let Q=(()=>{class r{constructor(e,a){this.service=e,this.datePipe=a,this.limit=10,this.page=1,this.leaderBoard=[],this.topThree=[],this.selectedDateFilter=1,this.dateFilterList=[{number:1,name:"monthly"},{number:2,name:"quarter"},{number:3,name:"yearly"}],this.months=[{month:1,name:"january",monthDays:31},{month:2,name:"february",monthDays:29},{month:3,name:"march",monthDays:31},{month:4,name:"april",monthDays:30},{month:5,name:"may",monthDays:31},{month:6,name:"june",monthDays:30},{month:7,name:"july",monthDays:31},{month:8,name:"august",monthDays:31},{month:9,name:"september",monthDays:30},{month:10,name:"october",monthDays:31},{month:11,name:"november",monthDays:30},{month:12,name:"december",monthDays:31}],this.quarters=[{start:1,end:3,name:"first_quarter",monthDays:31},{start:4,end:6,name:"second_quarter",monthDays:30},{start:7,end:9,name:"third_quarter",monthDays:30},{start:10,end:12,name:"fourth_quarter",monthDays:31}],this.defultKPI={tasksKPIValue:20,rateKPIValue:20,managerRateKPIValue:20,timeSheetKPIValue:20,attendanceKPIValue:20},this.currentMonth=this.months[(new Date).getMonth()],this.currentCMonth=this.months[(new Date).getMonth()],this.moreUsersStatus=!0,this.url=D.N.apiUrl,this.spaceId=localStorage.getItem("space-id"),this.startDate=this.datePipe.transform(new Date,"yyyy-MM-01"),this.endDate=this.datePipe.transform(new Date,"yyyy-MM-dd")}ngOnInit(){this.loading=!0,this.service.getKPI().subscribe(e=>{e?(this.currentKPI=e,this.getLeaderBoard()):this.setKpiValues(this.defultKPI)})}ngAfterViewInit(){this.leaderBoardList&&this.leaderBoardList.nativeElement.addEventListener("scroll",this.onScroll.bind(this))}onScroll(e){}setKpiValues(e){this.service.setKPI(e).subscribe(a=>{a.success&&this.getKpiValues()})}getKpiValues(){this.loading=!0,this.service.getKPI().subscribe(e=>{this.currentKPI=e,this.getLeaderBoard()})}getLeaderBoard(){this.loading=!0;let e=new x.LE;this.urlDetails=`api/Tasks/LeaderBoardExcel?from=${this.startDate}&to=${this.endDate}&spaceId=${this.spaceId}`,e=e.set("from",this.startDate).set("to",this.endDate),this.searchValue&&(e=e.set("search",this.searchValue)),this.refresh&&(e=e.set("Recache",this.refresh)),this.service.getLeaderBoardCached(e).subscribe(a=>{this.loading=!1,this.casheTime=this.datePipe.transform(a.cacheTime,"yyyy-MM-ddTHH:mm:ss","UTC"),a.data.forEach(n=>{this.leaderBoard.push(n)}),this.totalItems=a.totalItems,this.moreUsersStatus=!(this.page>=this.totalItems/this.limit),a.data.length>=3&&0==this.topThree.length&&(this.topThree=[{data:a.data[1],number:2},{data:a.data[0],number:1},{data:a.data[2],number:3}])},a=>{console.log(a),this.getLeaderBoard()})}dateRange(e){const a=new Date;let n,o;switch(this.page=1,this.topThree=[],this.leaderBoard=[],this.currentMonth=this.months[(new Date).getMonth()],e){case 1:default:n=new Date(a.getFullYear(),a.getMonth(),1),o=a,this.selectedDateFilter=1;break;case 2:const m=a.getMonth();this.quarterStartMonth=3*Math.floor(m/3),this.quarterCStartMonth=3*Math.floor(m/3),n=new Date(a.getFullYear(),this.quarterStartMonth,1),o=a,this.selectedDateFilter=2;break;case 3:n=new Date(a.getFullYear(),0,1),o=a,this.selectedDateFilter=3}this.startDate=this.datePipe.transform(n,"yyyy-MM-dd"),this.endDate=this.datePipe.transform(o,"yyyy-MM-dd"),this.getLeaderBoard()}monthFilter(e){let a=new Date;this.page=1,this.topThree=[],this.leaderBoard=[],this.currentMonth=e,a.setMonth(e.month-1),a.setDate(e.monthDays),this.startDate=this.datePipe.transform(a,"yyyy-MM-01"),this.endDate=this.datePipe.transform(a,"yyyy-MM-dd"),this.getLeaderBoard()}quarterFilter(e){let a=new Date,n=new Date;this.page=1,this.topThree=[],this.leaderBoard=[],this.currentMonth=e,this.quarterStartMonth=e.start-1,a.setMonth(e.start-1),n.setMonth(e.end-1),n.setDate(e.monthDays),this.startDate=this.datePipe.transform(a,"yyyy-MM-01"),this.endDate=this.datePipe.transform(n,"yyyy-MM-dd"),this.getLeaderBoard()}getByDepartment(e){}pageChanged(e){this.page=e,this.getLeaderBoard()}changeLimit(){this.getLeaderBoard()}search(e){this.searchValue=e,this.page=1,this.topThree=[],this.leaderBoard=[],this.getLeaderBoard()}refreshBtn(){this.refresh=!0,this.page=1,this.topThree=[],this.leaderBoard=[],this.getLeaderBoard(),setTimeout(()=>{this.refresh=!1},0)}static{this.\u0275fac=function(a){return new(a||r)(t.Y36(Z),t.Y36(h.uU))}}static{this.\u0275cmp=t.Xpm({type:r,selectors:[["leader-board"]],viewQuery:function(a,n){if(1&a&&t.Gf(w,7),2&a){let o;t.iGM(o=t.CRH())&&(n.leaderBoardList=o.first)}},standalone:!0,features:[t.jDz],decls:37,vars:27,consts:[[1,"p-2"],[1,"mx-50","mt-50","simibold","bg-light-danger","p-1","rounded"],[1,"filters","text-right","border-bottom"],[1,"flex","aic","jcsb"],[1,"date","flex","aic"],[4,"ngFor","ngForOf"],[1,"mr-1","flex","aic"],[1,"bx","bx-refresh","primary","fs-18","pointer",3,"click"],[1,"flex","aic"],[3,"newSearch","width","hideLabel","classes","valueChanged"],["target","_blank",1,"btn","mr-1","rounded","bg-primary","white","py-50","px-2","fs-12",3,"href"],[4,"ngIf"],[1,"leader-board-content","relative"],[1,"flex-grid","m-0","w-100","flex-grid-margin"],[1,"col-xl-12","px-0"],[1,"leader-board-list"],["leaderBoardList",""],[1,"flex-grid","aic","top-three","pt-3","mx-0","w-100","flex-grid-margin","mb-2"],["class","col-md-4 px-1",4,"ngFor","ngForOf"],["class"," mx-1 rounded-3 border shadow pl-1 mb-2 item-list",4,"ngFor","ngForOf"],[1,"loading","py-5","w-100"],[3,"click"],[1,"flex","aic","w-100","pt-1","px-1","pb-75","border-bottom"],[3,"class","click",4,"ngIf"],[1,"col-md-4","px-1"],[3,"imgSize","imgSrc"],[1,"name","gold-color","simibold"],[1,"job-title","white"],[1,"number"],[1,"mx-1","rounded-3","border","shadow","pl-1","mb-2","item-list"],[1,"flex-grid","mx-0"],[1,"col-sm-6","flex","aic","px-0"],[1,"simibold","primary","mr-1"],[1,"img-list"],[3,"imgSrc","imgSize","title","subTitle"],[1,"col-sm-6","flex","aic","jcsb","px-0"],[1,"percentage","white","bg-primary","flex-column","aic","jcc","rounded-3"],[1,"simibold"]],template:function(a,n){1&a&&(t._UZ(0,"user-navbar"),t.TgZ(1,"div",0)(2,"layout")(3,"p",1),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4),t.YNc(9,C,4,6,"ng-container",5),t.qZA(),t.TgZ(10,"p",6)(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"arabicDate"),t.ALo(17,"arabicTime"),t.qZA(),t.TgZ(18,"i",7),t.NdJ("click",function(){return n.refreshBtn()}),t.qZA()(),t.TgZ(19,"div",8)(20,"search",9),t.NdJ("valueChanged",function(m){return n.search(m)}),t.qZA(),t.TgZ(21,"a",10),t._uU(22),t.ALo(23,"translate"),t.qZA()()()(),t.YNc(24,A,3,1,"ng-container",11),t.YNc(25,S,3,1,"ng-container",11),t.TgZ(26,"div",12)(27,"div",13)(28,"div",14)(29,"div",15,16)(31,"div",17),t.YNc(32,O,12,16,"div",18),t.qZA(),t.YNc(33,K,13,8,"div",19),t.qZA()()()(),t.TgZ(34,"div",20),t.YNc(35,q,1,0,"loading",11),t.YNc(36,E,1,0,"not-found",11),t.qZA()()()),2&a&&(t.xp6(4),t.Oqu(t.lcZ(5,17,"beta")),t.xp6(5),t.Q6J("ngForOf",n.dateFilterList),t.xp6(3),t.hij(" ",t.lcZ(13,19,"last_update")," : "),t.xp6(3),t.AsE("",t.lcZ(16,21,n.casheTime)," - ",t.lcZ(17,23,n.casheTime),""),t.xp6(5),t.Q6J("newSearch",!0)("width","w-20r")("hideLabel",!0)("classes","py-50 pr-1 fs-10 mr-1"),t.xp6(1),t.Q6J("href",n.url+n.urlDetails,t.LSH),t.xp6(1),t.hij(" ",t.lcZ(23,25,"export")," "),t.xp6(2),t.Q6J("ngIf",1==n.selectedDateFilter),t.xp6(1),t.Q6J("ngIf",2==n.selectedDateFilter),t.xp6(7),t.Q6J("ngForOf",n.topThree),t.xp6(1),t.Q6J("ngForOf",n.leaderBoard),t.xp6(2),t.Q6J("ngIf",n.loading),t.xp6(1),t.Q6J("ngIf",!n.loading&&0==n.leaderBoard.length))},dependencies:[c.JX,d.u5,h.ez,h.sg,h.O5,_.$,p.aw,p.X$,f.G,l.m,T.o,g.N,b.w,L.g,B.P,M.E],styles:['.gold-color{color:gold}.primary-light{background-color:#7b55d3cc}.primary-dark{background-color:#7b55d3}.light-bg{background-color:#fff3}.date-filter{border-bottom:3px solid #fff}.date-filter.active{border-color:#7b55d3!important}.img-list{margin-block:-4px;overflow:visible}.img-list img{border:2px solid #fff;box-shadow:0 0 5px 1px #0003}.flex-grid-margin{margin-inline:auto!important}.leader-board-content .leader-board-list{height:calc(100vh - 25rem);overflow-y:auto;overflow-x:hidden}.percentage{margin-block:-1px;width:150px;display:flex;height:100%;border-start-start-radius:0px!important;border-end-start-radius:0px!important}.top-three .img{border:3px solid #fff;display:inline-flex;box-shadow:0 0 5px 1px #0003}.top-three .img.leader{margin-top:-35px}.top-three .number{margin-top:10px}.top-three .number h5{display:inline-flex}.top-three .number .leader{width:40px;height:40px;font-size:25px;color:gold!important;position:relative;margin-bottom:15px}.top-three .number .leader:before{content:"";height:45px;width:58px;position:absolute;background-image:url(top-one.6be346ce6b6b80d5.png);background-size:100%;background-repeat:no-repeat;bottom:-12px}.top-three .number .top{width:30px;height:30px}.bx-refresh{transition:ease-in-out .3s}.bx-refresh:hover{transform:rotate(180deg)}\n'],encapsulation:2})}}return r})()}}]);