"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[3166],{17986:(J,I,c)=>{c.d(I,{_:()=>M});var e=c(65879),m=c(96814),t=c(1428);const U=[[["","top",""]],[["","sidebar",""]],[["","top-section",""]],[["","content",""]]],l=function(h){return{open:h}},C=function(h){return{width:h}},Z=function(h){return{"d-block":h}},v=["[top]","[sidebar]","[top-section]","[content]"];let M=(()=>{class h{constructor(){this.open=!1,this.width=30}ngOnInit(){}openSidebar(){this.open=!0}onResize(f){f.target.innerWidth>=991&&(this.open=!1)}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=e.Xpm({type:h,selectors:[["layout-with-sidebar"]],hostBindings:function(p,u){1&p&&e.NdJ("resize",function(b){return u.onResize(b)},!1,e.Jf7)},inputs:{width:"width"},ngContentSelectors:v,decls:12,vars:11,consts:[[1,"layout-with-sidebar","w-100","h-100","relative"],[1,"flex","h-100"],[1,"sidebar","bg-white","border-right",3,"ngClass","ngStyle"],[1,"content"],[1,"menu-button","pl-1","pr-4","flex","aic","relative"],[1,"bx","bx-menu","p-1","fs-25","pointer","d-lg-none",3,"click"],[1,"backdrop","d-none",3,"ngClass","click"]],template:function(p,u){1&p&&(e.F$t(U),e.TgZ(0,"div",0)(1,"layout"),e.Hsn(2),e.TgZ(3,"div",1)(4,"div",2),e.Hsn(5,1),e.qZA(),e.TgZ(6,"div",3)(7,"div",4)(8,"i",5),e.NdJ("click",function(){return u.openSidebar()}),e.qZA(),e.Hsn(9,2),e.qZA(),e.Hsn(10,3),e.qZA()()(),e.TgZ(11,"div",6),e.NdJ("click",function(){return u.open=!1}),e.qZA()()),2&p&&(e.xp6(4),e.Q6J("ngClass",e.VKq(5,l,u.open))("ngStyle",e.VKq(7,C,u.width+"rem")),e.xp6(2),e.Akn("width: calc(100% - "+u.width+"rem)"),e.xp6(5),e.Q6J("ngClass",e.VKq(9,Z,u.open)))},dependencies:[m.mk,m.PC,t.$],styles:['[_ngcontent-%COMP%]:root{--primary: #7b58ca;--light-primary: #7b58ca80;--dark-color: #707070;--gray: #FAF9FD;--success: #29CC99;--danger: #ea5455;--canceled: #C7C7CC;--warning: #F69E42;--info: #007AFF;--dark-white: #283046;--dark-gray: #161D31;--white-color: #b4b7bd;--dark-border: #404656;--border-color: #e7e7e7;--closed: rgba(234, 84, 85, .53)}.primary[_ngcontent-%COMP%]{color:#7b58ca!important}.bg-primary[_ngcontent-%COMP%]{background:#7b58ca!important}.bg-light-primary-10[_ngcontent-%COMP%]{background:rgba(123,88,202,.1)!important}.light-primary[_ngcontent-%COMP%]{color:#7b58ca80!important}.bg-light-primary[_ngcontent-%COMP%]{background:rgba(123,88,202,.5019607843)!important}.closed-color[_ngcontent-%COMP%]{color:#ea545587!important}.bg-closed-color[_ngcontent-%COMP%]{background:rgba(234,84,85,.53)!important}.bg-archived[_ngcontent-%COMP%]{background:#c5c5c5!important}.bg-light-success-1[_ngcontent-%COMP%]{color:#29cc99b5;background-color:#f7fffa}.bg-light-primary-1[_ngcontent-%COMP%]{color:#7b58ca;background:#fbf9ff}.bg-light-warning-2[_ngcontent-%COMP%]{color:#f69e42;background-color:#f69e4233!important}.bg-light-primary-2[_ngcontent-%COMP%]{color:#7b58ca;background-color:#7b58ca33!important}.bg-light-success-2[_ngcontent-%COMP%]{color:#29cc99;background-color:#29cc991a!important}.bg-light-canceled-2[_ngcontent-%COMP%]{color:#c7c7cc;background-color:#c7c7cc33!important}.bg-light-danger-1[_ngcontent-%COMP%]{color:#ea5455;background-color:#fff3f3}.border-primary[_ngcontent-%COMP%]{border:1px solid #7b58ca!important}.layout-with-sidebar[_ngcontent-%COMP%]{overflow:hidden}.sidebar[_ngcontent-%COMP%]{transition:inset-inline-start .4s cubic-bezier(.25,.8,.25,1)}.menu-button[_ngcontent-%COMP%]   .bx-menu[_ngcontent-%COMP%]:after{content:"";width:100%;position:absolute;bottom:0;left:0}@media (max-width: 991px){.content[_ngcontent-%COMP%]{width:100%!important}.content[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{border-bottom:1px solid #e7e7e7}.sidebar[_ngcontent-%COMP%]{position:absolute;inset-inline-start:-100%;top:0;height:100%;z-index:98}.sidebar.open[_ngcontent-%COMP%]{inset-inline-start:0}}.backdrop[_ngcontent-%COMP%]{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000000b3;z-index:5}']})}}return h})()},84943:(J,I,c)=>{c.d(I,{x:()=>U});var e=c(96814),m=c(1428),t=c(65879);let U=(()=>{class l{static{this.\u0275fac=function(v){return new(v||l)}}static{this.\u0275mod=t.oAB({type:l})}static{this.\u0275inj=t.cJS({imports:[e.ez,m.$,m.$]})}}return l})()},47921:(J,I,c)=>{c.d(I,{R:()=>l});var e=c(96814),m=c(65879);function t(C,Z){if(1&C&&m._UZ(0,"img",3),2&C){const v=m.oxw();m.Q6J("width",v.logo_width)}}function U(C,Z){1&C&&m._UZ(0,"img",4)}let l=(()=>{class C{constructor(){this.logo_width="35",this.large=!1}ngOnInit(){}static{this.\u0275fac=function(M){return new(M||C)}}static{this.\u0275cmp=m.Xpm({type:C,selectors:[["logo"]],inputs:{logo_width:"logo_width",large:"large"},standalone:!0,features:[m.jDz],decls:3,vars:2,consts:[["href","https://taskedin.net/",1,"img"],["alt","","src","assets/images/logo/logo.png",3,"width",4,"ngIf"],["alt","","src","assets/images/logo/logo.svg",4,"ngIf"],["alt","","src","assets/images/logo/logo.png",3,"width"],["alt","","src","assets/images/logo/logo.svg"]],template:function(M,h){1&M&&(m.TgZ(0,"a",0),m.YNc(1,t,1,1,"img",1),m.YNc(2,U,1,0,"img",2),m.qZA()),2&M&&(m.xp6(1),m.Q6J("ngIf",!h.large),m.xp6(1),m.Q6J("ngIf",h.large))},dependencies:[e.ez,e.O5],encapsulation:2})}}return C})()},9798:(J,I,c)=>{c.d(I,{h:()=>f});var e=c(96814),m=c(89515),t=c(65879);function U(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"new")))}function l(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"completed")))}function C(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"in_progress")))}function Z(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"canceled")))}function v(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"pending")))}function M(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"rejected")))}function h(p,u){1&p&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"notified")))}const x=function(p,u,T,b,_,w,k){return{"chip-light-danger":p,"chip-light-primary":u,"chip-light-warning":T,"chip-light-success":b,"chip-light-gray":_,"chip-light-canceled":w,"chip-light-info":k}};let f=(()=>{class p{constructor(){this.classes=""}static{this.\u0275fac=function(b){return new(b||p)}}static{this.\u0275cmp=t.Xpm({type:p,selectors:[["task-status"]],inputs:{state:"state",classes:"classes"},standalone:!0,features:[t.jDz],decls:8,vars:19,consts:[[3,"ngClass"],[4,"ngIf"]],template:function(b,_){1&b&&(t.TgZ(0,"div",0),t.YNc(1,U,3,3,"span",1),t.YNc(2,l,3,3,"span",1),t.YNc(3,C,3,3,"span",1),t.YNc(4,Z,3,3,"span",1),t.YNc(5,v,3,3,"span",1),t.YNc(6,M,3,3,"span",1),t.YNc(7,h,3,3,"span",1),t.qZA()),2&b&&(t.Gre("chip rounded fs-13 text-center ",_.classes,""),t.Q6J("ngClass",t.Hh0(11,x,8==_.state,1==_.state,3==_.state,2==_.state,7==_.state,6==_.state,9==_.state)),t.xp6(1),t.Q6J("ngIf",1==_.state),t.xp6(1),t.Q6J("ngIf",2==_.state),t.xp6(1),t.Q6J("ngIf",3==_.state),t.xp6(1),t.Q6J("ngIf",6==_.state),t.xp6(1),t.Q6J("ngIf",7==_.state),t.xp6(1),t.Q6J("ngIf",8==_.state),t.xp6(1),t.Q6J("ngIf",9==_.state))},dependencies:[e.ez,e.mk,e.O5,m.aw,m.X$],encapsulation:2})}}return p})()},68577:(J,I,c)=>{c.d(I,{p:()=>h});var e=c(96814),m=c(89515),t=c(52081),U=c(88492),l=c(65879);function C(x,f){1&x&&(l.TgZ(0,"span",3),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&x&&(l.xp6(1),l.Oqu(l.lcZ(2,1,"left")))}function Z(x,f){if(1&x&&(l.TgZ(0,"span",3),l._uU(1),l.ALo(2,"arabicNumbers"),l.qZA()),2&x){const p=l.oxw(2);l.xp6(1),l.Oqu(l.lcZ(2,1,p.timeLeft))}}function v(x,f){1&x&&(l.TgZ(0,"span",4),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&x&&(l.xp6(1),l.Oqu(l.lcZ(2,1,"left")))}function M(x,f){if(1&x&&(l.ynx(0),l.TgZ(1,"div"),l._UZ(2,"div"),l.YNc(3,C,3,3,"span",1),l.YNc(4,Z,3,3,"span",1),l.TgZ(5,"span"),l._uU(6),l.ALo(7,"translate"),l.ALo(8,"defineDays"),l.qZA(),l.YNc(9,v,3,3,"span",2),l.qZA(),l.BQk()),2&x){const p=l.oxw();l.xp6(1),l.Gre("flex aic ",p.classes,""),l.xp6(1),l.Gre("bullet ",p.bullet," rounded-50 mr-75"),l.xp6(1),l.Q6J("ngIf","ar"==p.lang&&p.showLeft),l.xp6(1),l.Q6J("ngIf",p.timeLeft>2&&"ar"==p.lang||"en"==p.lang),l.xp6(2),l.Oqu(l.lcZ(7,10,l.lcZ(8,12,p.timeLeft)+"_"+p.label)),l.xp6(3),l.Q6J("ngIf","en"==p.lang&&p.showLeft)}}let h=(()=>{class x{constructor(){this.label="",this.classes="",this.bullet="",this.lang=localStorage.getItem("language")||"en"}static{this.\u0275fac=function(u){return new(u||x)}}static{this.\u0275cmp=l.Xpm({type:x,selectors:[["time-left"]],inputs:{timeLeft:"timeLeft",label:"label",classes:"classes",bullet:"bullet",showLeft:"showLeft"},standalone:!0,features:[l.jDz],decls:1,vars:1,consts:[[4,"ngIf"],["class","mr-50",4,"ngIf"],["class","ml-50",4,"ngIf"],[1,"mr-50"],[1,"ml-50"]],template:function(u,T){1&u&&l.YNc(0,M,10,14,"ng-container",0),2&u&&l.Q6J("ngIf",T.timeLeft)},dependencies:[e.ez,e.O5,m.aw,m.X$,t.m,U.K],styles:[".bullet[_ngcontent-%COMP%]{width:1rem;height:1rem}"]})}}return x})()},88492:(J,I,c)=>{c.d(I,{K:()=>m});var e=c(65879);let m=(()=>{class t{constructor(){this.lang=localStorage.getItem("language")}transform(l){return new Intl.PluralRules("ar-EG").select(l)}static{this.\u0275fac=function(C){return new(C||t)}}static{this.\u0275pipe=e.Yjl({name:"defineDays",type:t,pure:!0,standalone:!0})}}return t})()},77053:(J,I,c)=>{c.r(I),c.d(I,{ChatModule:()=>Be});var e=c(96814),m=c(64190),t=c(65879),U=c(17986),l=c(55006),C=c(37398),Z=c(12867),v=c(68671),M=c(824),h=c(74104),x=c(57105),f=c(56223);function p(o){let g=new Date,n=new Date(1e3*o.lastMessage.timeStamp.seconds),r=n.getDate(),s=n.getFullYear(),i=n.getMonth();o.dateType=s==g.getFullYear()&&i==g.getMonth()&&g.getDate()==r+1?"yesterday":s==g.getFullYear()&&i==g.getMonth()&&g.getDate()==r?"today":"unknown",o.date=n}var u=c(92596),T=c(47921),b=c(89515);const _=function(o){return{black:o}};function w(o,g){if(1&o&&(t.TgZ(0,"p",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngClass",t.VKq(4,_,n.notSeen)),t.xp6(1),t.hij(" ",t.lcZ(2,2,"you"),"")}}function k(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function K(o,g){if(1&o&&(t.TgZ(0,"p",6),t._uU(1),t.ALo(2,"slice"),t.YNc(3,k,2,0,"span",4),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngClass",t.VKq(8,_,n.notSeen))("matTooltip",n.chat.lastMessage.senderName&&n.chat.lastMessage.senderName.length>10?n.chat.lastMessage.senderName:""),t.xp6(1),t.hij(" ",t.Dn7(2,4,n.chat.lastMessage.senderName,0,10)," "),t.xp6(2),t.Q6J("ngIf",n.chat.lastMessage.senderName&&n.chat.lastMessage.senderName.length>10)}}function j(o,g){if(1&o&&(t.TgZ(0,"span",7),t._uU(1,":"),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngClass",t.VKq(1,_,n.notSeen))}}function X(o,g){if(1&o&&(t.TgZ(0,"p",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngClass",t.VKq(4,_,n.notSeen)),t.xp6(1),t.hij(" ",t.lcZ(2,2,"attachment")," ")}}function V(o,g){1&o&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"you_deleted_message")))}function W(o,g){1&o&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"message_was_deleted")))}function H(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function z(o,g){if(1&o&&(t.TgZ(0,"p",6),t.ALo(1,"translate"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"slice"),t.YNc(5,H,2,0,"span",4),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngClass",t.VKq(12,_,n.notSeen))("matTooltip",n.chat.lastMessage.text.length>12?t.lcZ(1,4,n.chat.lastMessage.text):""),t.xp6(2),t.hij("",t.lcZ(3,6,t.Dn7(4,8,n.chat.lastMessage.text,0,20))," "),t.xp6(3),t.Q6J("ngIf",n.chat.lastMessage.text&&n.chat.lastMessage.text.length>20)}}let L=(()=>{class o{constructor(){this.notSeen=!1,this.currentUserId=localStorage.getItem("id")}ngOnInit(){}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-last-message"]],inputs:{chat:"chat",notSeen:"notSeen"},decls:8,vars:7,consts:[[1,"last-message","muted","fs-13","flex","aic"],[3,"ngClass",4,"ngIf"],[3,"ngClass","matTooltip",4,"ngIf"],["class","fs-18 ml-25 mr-25",3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[3,"ngClass","matTooltip"],[1,"fs-18","ml-25","mr-25",3,"ngClass"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t.YNc(1,w,3,6,"p",1),t.YNc(2,K,4,10,"p",2),t.YNc(3,j,2,3,"span",3),t.YNc(4,X,3,6,"p",1),t.YNc(5,V,3,3,"p",4),t.YNc(6,W,3,3,"p",4),t.YNc(7,z,6,14,"p",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",s.chat.lastMessage.senderId==s.currentUserId),t.xp6(1),t.Q6J("ngIf",s.chat.lastMessage.senderId!=s.currentUserId),t.xp6(1),t.Q6J("ngIf",s.chat.lastMessage.senderName),t.xp6(1),t.Q6J("ngIf","text"!=s.chat.lastMessage.messageType&&"server"!=s.chat.lastMessage.messageType&&!s.chat.lastMessage.isDeleted),t.xp6(1),t.Q6J("ngIf",s.chat.lastMessage.isDeleted&&s.chat.lastMessage.senderId==s.currentUserId),t.xp6(1),t.Q6J("ngIf",s.chat.lastMessage.isDeleted&&s.chat.lastMessage.senderId!=s.currentUserId),t.xp6(1),t.Q6J("ngIf",("text"==s.chat.lastMessage.messageType||"server"==s.chat.lastMessage.messageType)&&!s.chat.lastMessage.isDeleted))},dependencies:[e.mk,e.O5,u.gM,e.OU,b.X$]})}}return o})();var P=c(9619),S=c(11383);function ee(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function te(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"yesterday")))}function ne(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicTime"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,!1))}}function se(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicDate"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,"long"))}}let ae=(()=>{class o{constructor(){}ngOnInit(){}ngOnChanges(n){p(this.chat)}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-group-task-chat"]],inputs:{chat:"chat"},features:[t.TTD],decls:14,vars:13,consts:[[1,"flex","aic","gap-x-1"],[1,"chat-content","w-100"],[1,"flex","aic","jcsb"],[1,"task-title","fs-14",3,"matTooltip"],[4,"ngIf"],[1,"date","fs-13"],[3,"chat"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t._UZ(1,"logo"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3),t._uU(5),t.ALo(6,"translate"),t.ALo(7,"slice"),t.YNc(8,ee,2,0,"span",4),t.qZA(),t.TgZ(9,"div",5),t.YNc(10,te,3,3,"span",4),t.YNc(11,ne,3,4,"span",4),t.YNc(12,se,3,4,"span",4),t.qZA()(),t._UZ(13,"app-last-message",6),t.qZA()()),2&r&&(t.xp6(4),t.Q6J("matTooltip",s.chat.name.length>25?s.chat.name:""),t.xp6(1),t.hij(" ",t.lcZ(6,7,t.Dn7(7,9,s.chat.name,0,25))," "),t.xp6(3),t.Q6J("ngIf",s.chat.name&&s.chat.name.length>25),t.xp6(2),t.Q6J("ngIf","yesterday"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","today"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","unknown"==s.chat.dateType),t.xp6(1),t.Q6J("chat",s.chat))},dependencies:[e.O5,u.gM,T.R,L,e.OU,b.X$,P.P,S.E]})}}return o})();var q=c(20553);function oe(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function ie(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"yesterday")))}function re(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicTime"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,!1))}}function ce(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicDate"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,"long"))}}let le=(()=>{class o{constructor(){this.apiUrl=q.N.apiUrl}ngOnInit(){}ngOnChanges(n){p(this.chat)}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-group-chat"]],inputs:{chat:"chat"},features:[t.TTD],decls:13,vars:11,consts:[[1,"flex","aic","gap-x-1"],[1,"chat-content","w-100"],[1,"flex","aic","jcsb"],[1,"task-title","fs-14",3,"matTooltip"],[4,"ngIf"],[1,"date","fs-13"],[3,"chat"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t._UZ(1,"logo"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3),t._uU(5),t.ALo(6,"slice"),t.YNc(7,oe,2,0,"span",4),t.qZA(),t.TgZ(8,"div",5),t.YNc(9,ie,3,3,"span",4),t.YNc(10,re,3,4,"span",4),t.YNc(11,ce,3,4,"span",4),t.qZA()(),t._UZ(12,"app-last-message",6),t.qZA()()),2&r&&(t.xp6(4),t.Q6J("matTooltip",s.chat.name.length>25?s.chat.name:""),t.xp6(1),t.hij(" ",t.Dn7(6,7,s.chat.name,0,25)," "),t.xp6(2),t.Q6J("ngIf",s.chat.name&&s.chat.name.length>25),t.xp6(2),t.Q6J("ngIf","yesterday"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","today"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","unknown"==s.chat.dateType),t.xp6(1),t.Q6J("chat",s.chat))},dependencies:[e.O5,u.gM,T.R,L,e.OU,b.X$,P.P,S.E]})}}return o})();var B=c(45843);function pe(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function ge(o,g){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"yesterday")))}function me(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicTime"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,!1))}}function de(o,g){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"arabicDate"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.chat.date,"long"))}}let ue=(()=>{class o{constructor(){this.notSeen=!1,this.currentUserId=localStorage.getItem("id")}ngOnInit(){}ngOnChanges(n){this.user=this.chat.members.filter(r=>r.id!=this.currentUserId)[0],p(this.chat)}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-private-chat"]],inputs:{chat:"chat",notSeen:"notSeen"},features:[t.TTD],decls:13,vars:13,consts:[[1,"flex","aic","gap-x-1"],[3,"img"],[1,"chat-content","w-100"],[1,"flex","aic","jcsb"],[1,"task-title","fs-14",3,"matTooltip"],[4,"ngIf"],[1,"date","fs-13"],[3,"chat","notSeen"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t._UZ(1,"user-image",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5),t.ALo(6,"slice"),t.YNc(7,pe,2,0,"span",5),t.qZA(),t.TgZ(8,"div",6),t.YNc(9,ge,3,3,"span",5),t.YNc(10,me,3,4,"span",5),t.YNc(11,de,3,4,"span",5),t.qZA()(),t._UZ(12,"app-last-message",7),t.qZA()()),2&r&&(t.xp6(1),t.Q6J("img",s.user.avatar),t.xp6(3),t.Q6J("matTooltip",s.user.name.length>25?s.user.name:""),t.xp6(1),t.hij(" ",t.Dn7(6,9,s.user.name,0,25)," "),t.xp6(2),t.Q6J("ngIf",s.user.name&&s.user.name.length>25),t.xp6(2),t.Q6J("ngIf","yesterday"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","today"==s.chat.dateType),t.xp6(1),t.Q6J("ngIf","unknown"==s.chat.dateType),t.xp6(1),t.Q6J("chat",s.chat)("notSeen",s.notSeen))},dependencies:[e.O5,B.l,u.gM,L,e.OU,b.X$,P.P,S.E]})}}return o})();var he=c(48180),fe=c(69862);let _e=(()=>{class o{constructor(n){this.http=n}uploadImage(n){return this.http.post(`${q.N.apiUrl}api/Chat/UploadAttachment`,n)}static{this.\u0275fac=function(r){return new(r||o)(t.LFG(fe.eN))}}static{this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var A=c(17700),E=c(63934),Q=c(17857),Y=c(49388),$=c(32296),Ce=c(82458),xe=c(1350),Te=c(58964),D=c(10480);let ye=(()=>{class o{constructor(n,r,s,i,a,d,y){this.firestore=n,this.service=r,this.fb=s,this.dialog=i,this.chatSer=a,this.userSer=d,this.spacesSer=y,this.spaceId=localStorage.getItem("space-id"),this.chatId=localStorage.getItem("chat-id"),this.loading=!1,this.usersToAdd=[],this.form=this.fb.group({name:["",f.kI.required]})}ngOnInit(){this.userSer.user$.subscribe(n=>this.currentUser=n),this.spacesSer.currentSpace.subscribe(n=>{this.companyName=n.spaceName})}createGroupChat(){this.loading=!0;let n=this.usersToAdd.map(a=>JSON.stringify(a.id)),r=this.usersToAdd.map(a=>({avatar:a.imageUrl,company:this.companyName,companyId:a.spaceId,department:a.departmentName,departmentId:a.departmentId,id:JSON.stringify(a.id),name:a.name})),s=this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc();const i={createdAt:new Date,creatorId:JSON.stringify(this.currentUser.id),id:s.ref.id,membersIds:[...n,JSON.stringify(this.currentUser.id)],name:this.form.value.name,picture:this.filePath||null,subType:"group",type:"group"};s.set(i).then(()=>{r.map(a=>{s.ref.collection("members").doc(a.id).set(a).then()}),s.ref.collection("members").doc(JSON.stringify(this.currentUser.id)).set({avatar:this.currentUser.imageUrl,company:this.companyName,companyId:this.currentUser.spaceId,department:this.currentUser.departmentName,departmentId:this.currentUser.departmentId,id:JSON.stringify(this.currentUser.id),name:this.currentUser.name}).then(()=>{this.chatSer.roomId.next(s.ref.id),this.chatSer.roomUsersIds.next(r.map(a=>a.id)),this.chatSer.newRoomCreated.next(!0),this.chatSer.messages$.next([]),this.chatSer.getRoomChat(!0),this.dialog.closeAll()})})}uploadImage(n){this.imageToUpload=n;let r=new FormData;r.append("uploadedFiles",this.imageToUpload),this.service.uploadImage(r).subscribe(s=>{this.filePath=s.data.filePath})}static{this.\u0275fac=function(r){return new(r||o)(t.Y36(Z.ST),t.Y36(_e),t.Y36(f.qu),t.Y36(A.uw),t.Y36(v.a),t.Y36(E.K),t.Y36(Q.s))}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-group-chat"]],decls:19,vars:12,consts:[["dir","auto"],["mat-dialog-title","",1,"black"],["mat-dialog-content",""],[1,"flex","aifs","gap-x-2"],[1,"flex-auto",3,"formGroup"],[3,"control","key"],["formControlName","name",1,"input"],[3,"control"],["text","users","classes","w-100 mt-1",3,"getSelectedUsers"],["mat-dialog-actions",""],[1,"flex","w-100","mt-1","mb-1","gap-x-1","jcfe"],["mat-dialog-close","",1,"px-2","dark-color","clickable-btn","rounded","cancel-btn"],[1,"submit-btn"],["mat-raised-button","","color","primary",1,"w-100","flex-auto","rounded","bg-primary","white",3,"disabled","click"],["text","create",3,"loading"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"form",4),t._UZ(7,"input-label",5)(8,"input",6)(9,"input-error",7),t.qZA()(),t.TgZ(10,"select-user",8),t.NdJ("getSelectedUsers",function(a){return s.usersToAdd=a}),t.qZA()(),t.TgZ(11,"div",9)(12,"div",10)(13,"button",11),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"div",12)(17,"button",13),t.NdJ("click",function(){return s.createGroupChat()}),t._UZ(18,"submit-button",14),t.qZA()()()()()),2&r&&(t.xp6(2),t.Oqu(t.lcZ(3,8,"create_group_chat")),t.xp6(4),t.Q6J("formGroup",s.form),t.xp6(1),t.Q6J("control",s.form.controls.name)("key","group_name"),t.xp6(2),t.Q6J("control",s.form.controls.name),t.xp6(5),t.Oqu(t.lcZ(15,10,"cancel")),t.xp6(3),t.Q6J("disabled",s.form.invalid||s.loading||0==(null==s.usersToAdd?null:s.usersToAdd.length)),t.xp6(1),t.Q6J("loading",s.loading))},dependencies:[A.ZT,A.uh,A.xY,A.H8,Y.Lv,$.lW,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,Ce.w,xe.i,Te.w,D.V,b.X$]})}}return o})();var N=c(6311);let ve=(()=>{class o{constructor(n,r,s,i,a){this.firestore=n,this.dialog=r,this.userSer=s,this.service=i,this.spacesSer=a,this.selectedUser=[],this.currentUserId=localStorage.getItem("id"),this.spaceId=localStorage.getItem("space-id"),this.chatId=localStorage.getItem("chat-id")}ngOnInit(){this.userSer.user$.subscribe(n=>this.currentUser=n),this.spacesSer.currentSpace.subscribe(n=>this.companyName=n.spaceName)}createGroupChat(){this.dialog.open(ye,{panelClass:"create-group-chat-dialog"})}createPrivateChat(n){let r;this.privateChatUser=n[0],this.currentUserId&&(r=+this.currentUserId>this.privateChatUser?.id?`${this.currentUserId}_${this.privateChatUser?.id}`:`${this.privateChatUser?.id}_${this.currentUserId}`),this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(r).snapshotChanges().pipe((0,he.q)(1)).subscribe(s=>{if(s.payload.data())this.service.roomId.next(r),this.service.roomUsersIds.next([this.privateChatUser?.id,this.currentUserId]),this.service.newRoomCreated.next(!0),this.service.getRoomChat(!0);else{let i=[{avatar:this.privateChatUser?.imageUrl,company:this.companyName,companyId:JSON.stringify(this.privateChatUser?.spaceId),department:this.privateChatUser?.departmentName,departmentId:JSON.stringify(this.privateChatUser?.departmentId),id:JSON.stringify(this.privateChatUser?.id),name:this.privateChatUser?.name},{avatar:this.currentUser.imageUrl,company:this.companyName,companyId:JSON.stringify(this.currentUser.spaceId),department:this.currentUser.departmentName,departmentId:JSON.stringify(this.currentUser.departmentId),id:JSON.stringify(this.currentUser.id),name:this.currentUser.name}];const a={createdAt:new Date,id:r,members:i,membersIds:[JSON.stringify(this.privateChatUser?.id),this.currentUserId],subType:"private",type:"private"};this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(r).set(a).then(()=>{this.service.roomId.next(r),this.service.roomUsersIds.next([this.privateChatUser?.id,this.currentUserId]),this.service.newRoomCreated.next(!0),this.service.messages$.next([]),this.service.getRoomChat(!0)})}})}static{this.\u0275fac=function(r){return new(r||o)(t.Y36(Z.ST),t.Y36(A.uw),t.Y36(E.K),t.Y36(v.a),t.Y36(Q.s))}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-chat"]],decls:10,vars:9,consts:[[1,"create-chat","rounded-50","flex-center","bg-primary","white","pointer",3,"matMenuTriggerFor","matTooltip"],[1,"bx","bxs-message-alt-detail","fs-22"],["menu","matMenu"],["mat-menu-item",""],["classes","clear-btn-style","text","create_private_chat",3,"chat","multi","getSelectedUsers"],["mat-menu-item","",3,"click"]],template:function(r,s){if(1&r&&(t.TgZ(0,"div",0),t.ALo(1,"translate"),t._UZ(2,"i",1),t.qZA(),t.TgZ(3,"mat-menu",null,2)(5,"button",3)(6,"select-user",4),t.NdJ("getSelectedUsers",function(a){return s.createPrivateChat(a)}),t.qZA()(),t.TgZ(7,"button",5),t.NdJ("click",function(){return s.createGroupChat()}),t._uU(8),t.ALo(9,"translate"),t.qZA()()),2&r){const i=t.MAs(4);t.Q6J("matMenuTriggerFor",i)("matTooltip",t.lcZ(1,5,"create_chat")),t.xp6(6),t.Q6J("chat",!0)("multi",!1),t.xp6(2),t.Oqu(t.lcZ(9,7,"create_group_chat"))}},dependencies:[u.gM,N.VK,N.OP,N.p6,D.V,b.X$],styles:[".create-chat[_ngcontent-%COMP%]{width:4rem;height:4rem}"]})}}return o})();const R=function(o){return{active:o}};function be(o,g){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",11),t.NdJ("click",function(){const i=t.CHM(n).$implicit,a=t.oxw(2);return t.KtG(a.openRoom(i))}),t._UZ(2,"app-group-task-chat",12),t.qZA(),t.BQk()}if(2&o){const n=g.$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(2,R,n.id==r.roomId)),t.xp6(1),t.Q6J("chat",n)}}function Ze(o,g){1&o&&t._UZ(0,"not-found")}function Ie(o,g){if(1&o&&(t.ynx(0),t.YNc(1,be,3,4,"ng-container",10),t.YNc(2,Ze,1,0,"not-found",8),t.BQk()),2&o){const n=g.ngIf,r=t.oxw();t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",r.trackBy),t.xp6(1),t.Q6J("ngIf",0==n.length)}}function Me(o,g){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",11),t.NdJ("click",function(){const i=t.CHM(n).$implicit,a=t.oxw(2);return t.KtG(a.openRoom(i))}),t._UZ(2,"app-group-chat",12),t.qZA(),t.BQk()}if(2&o){const n=g.$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(2,R,n.id==r.roomId)),t.xp6(1),t.Q6J("chat",n)}}function Ue(o,g){1&o&&t._UZ(0,"not-found")}function Oe(o,g){if(1&o&&(t.ynx(0),t.YNc(1,Me,3,4,"ng-container",10),t.YNc(2,Ue,1,0,"not-found",8),t.BQk()),2&o){const n=g.ngIf,r=t.oxw();t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",r.trackBy),t.xp6(1),t.Q6J("ngIf",0==n.length)}}function Ae(o,g){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",11),t.NdJ("click",function(){const i=t.CHM(n).$implicit,a=t.oxw(2);return t.KtG(a.openRoom(i))}),t._UZ(2,"app-private-chat",12),t.qZA(),t.BQk()}if(2&o){const n=g.$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(2,R,n.id==r.roomId)),t.xp6(1),t.Q6J("chat",n)}}function Je(o,g){1&o&&t._UZ(0,"not-found")}function Qe(o,g){if(1&o&&(t.ynx(0),t.YNc(1,Ae,3,4,"ng-container",10),t.YNc(2,Je,1,0,"not-found",8),t.BQk()),2&o){const n=g.ngIf,r=t.oxw();t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",r.trackBy),t.xp6(1),t.Q6J("ngIf",0==n.length)}}let Ne=(()=>{class o{constructor(n,r){this.firestore=n,this.service=r,this.chatId=localStorage.getItem("chat-id"),this.userId=localStorage.getItem("id"),this.chats$=this.firestore.collection("companies").doc(this.chatId).collection("rooms",s=>s.where("membersIds","array-contains",this.userId).orderBy("lastMessage.timeStamp","desc")).snapshotChanges().pipe((0,C.U)(s=>s.map(i=>i.payload.doc.data()))),this.privateChat$=this.getPrivateChat(),this.groupChat$=this.getGroupChat(),this.groupTaskChat$=this.getTaskChat(),this.tabIndex=0,this.query="",this.roomId="0",this.activeRoom="0"}ngOnInit(){this.service.roomId.subscribe(n=>this.roomId=n)}openRoom(n){this.activeRoom=n.id,n.id!=this.roomId&&(this.service.roomId.next(n.id),this.service.isNewRoom.next(!0),this.service.getRoomChat(!0),this.service.roomUsersIds.next(n.membersIds))}search(n){this.query=n,0==this.tabIndex?this.groupTaskChat$=this.getTaskChat(n):1==this.tabIndex?this.groupChat$=this.getGroupChat(n):2==this.tabIndex&&(this.privateChat$=this.getPrivateChat(n))}selectedTabChanged(n){this.search(""),this.tabIndex=n.index,this.query=""}getTaskChat(n=""){return this.chats$.pipe((0,C.U)(r=>r.filter(s=>"task"==s.subType&&"group"==s.type&&s.name.toLowerCase().includes(n.toLowerCase()))))}getGroupChat(n=""){return this.chats$.pipe((0,C.U)(r=>r.filter(s=>"group"==s.subType&&"group"==s.type&&s.name.toLowerCase().includes(n.toLowerCase()))))}getPrivateChat(n=""){return this.chats$.pipe((0,C.U)(r=>{let s=[];return r.map(i=>{if("private"==i.type&&"private"==i.subType){let a=i.members.find(d=>d.id!=this.userId);s.push(a?.id)}}),s.length>0&&this.service.getUserProfiles(s).subscribe(i=>{let a=i;r.map(d=>{if("private"==d.type&&"private"==d.subType){let y=d.members.find(O=>O.id!=this.userId),Ee=a.find(O=>O.id==y?.id);d.members.map(O=>{O.id!=this.userId&&(O.name=Ee.name,O.avatar=Ee.imageUrl)})}})}),r.filter(i=>"private"==i.subType&&"private"==i.type&&i.members.filter(a=>a.id!=this.userId)[0].name.toLowerCase().includes(n.toLowerCase()))}))}trackBy(n,r){return r.id}static{this.\u0275fac=function(r){return new(r||o)(t.Y36(Z.ST),t.Y36(v.a))}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-chats-list"]],decls:21,vars:22,consts:[[1,"chats","h-100"],[1,"top-section","bg-white","flex","aic","w-100","gap-x-1","border-bottom"],[1,"w-100","flex","aic","gap-x-1"],["type","text",1,"input","full-rounded",3,"ngModel","placeholder","input","ngModelChange"],["magicScroll","",1,"content"],[1,"chats-list","relative","h-100"],["animationDuration","0ms",3,"selectedTabChange"],[1,"h-100",3,"label"],[4,"ngIf"],[3,"label"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"chat","px-2","py-1","pointer",3,"ngClass","click"],[3,"chat"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),t.NdJ("input",function(){return s.search(s.query)})("ngModelChange",function(a){return s.query=a}),t.ALo(4,"translate"),t.qZA(),t._UZ(5,"app-create-chat"),t.qZA()(),t.TgZ(6,"div",4)(7,"div",5)(8,"mat-tab-group",6),t.NdJ("selectedTabChange",function(a){return s.selectedTabChanged(a)}),t.TgZ(9,"mat-tab",7),t.ALo(10,"translate"),t.YNc(11,Ie,3,3,"ng-container",8),t.ALo(12,"async"),t.qZA(),t.TgZ(13,"mat-tab",9),t.ALo(14,"translate"),t.YNc(15,Oe,3,3,"ng-container",8),t.ALo(16,"async"),t.qZA(),t.TgZ(17,"mat-tab",9),t.ALo(18,"translate"),t.YNc(19,Qe,3,3,"ng-container",8),t.ALo(20,"async"),t.qZA()()()()()),2&r&&(t.xp6(3),t.Q6J("ngModel",s.query)("placeholder",t.lcZ(4,8,"search")),t.xp6(6),t.Q6J("label",t.lcZ(10,10,"task")),t.xp6(2),t.Q6J("ngIf",t.lcZ(12,12,s.groupTaskChat$)),t.xp6(2),t.Q6J("label",t.lcZ(14,14,"group")),t.xp6(2),t.Q6J("ngIf",t.lcZ(16,16,s.groupChat$)),t.xp6(2),t.Q6J("label",t.lcZ(18,18,"private")),t.xp6(2),t.Q6J("ngIf",t.lcZ(20,20,s.privateChat$)))},dependencies:[e.mk,e.sg,e.O5,M.h,h.uX,h.SP,x.w,f.Fj,f.JJ,f.On,ae,le,ue,ve,e.Ov,b.X$],styles:["[_ngcontent-%COMP%]:root{--primary: #7b58ca;--light-primary: #7b58ca80;--dark-color: #707070;--gray: #FAF9FD;--success: #29CC99;--danger: #ea5455;--canceled: #C7C7CC;--warning: #F69E42;--info: #007AFF;--dark-white: #283046;--dark-gray: #161D31;--white-color: #b4b7bd;--dark-border: #404656;--border-color: #e7e7e7;--closed: rgba(234, 84, 85, .53)}.primary[_ngcontent-%COMP%]{color:#7b58ca!important}.bg-primary[_ngcontent-%COMP%]{background:#7b58ca!important}.bg-light-primary-10[_ngcontent-%COMP%]{background:rgba(123,88,202,.1)!important}.light-primary[_ngcontent-%COMP%]{color:#7b58ca80!important}.bg-light-primary[_ngcontent-%COMP%]{background:rgba(123,88,202,.5019607843)!important}.closed-color[_ngcontent-%COMP%]{color:#ea545587!important}.bg-closed-color[_ngcontent-%COMP%]{background:rgba(234,84,85,.53)!important}.bg-archived[_ngcontent-%COMP%]{background:#c5c5c5!important}.bg-light-success-1[_ngcontent-%COMP%]{color:#29cc99b5;background-color:#f7fffa}.bg-light-primary-1[_ngcontent-%COMP%]{color:#7b58ca;background:#fbf9ff}.bg-light-warning-2[_ngcontent-%COMP%]{color:#f69e42;background-color:#f69e4233!important}.bg-light-primary-2[_ngcontent-%COMP%]{color:#7b58ca;background-color:#7b58ca33!important}.bg-light-success-2[_ngcontent-%COMP%]{color:#29cc99;background-color:#29cc991a!important}.bg-light-canceled-2[_ngcontent-%COMP%]{color:#c7c7cc;background-color:#c7c7cc33!important}.bg-light-danger-1[_ngcontent-%COMP%]{color:#ea5455;background-color:#fff3f3}.border-primary[_ngcontent-%COMP%]{border:1px solid #7b58ca!important}.top-section[_ngcontent-%COMP%]{padding:1.2rem 2rem}.content[_ngcontent-%COMP%]{height:calc(100% - 6.6rem)}.chat[_ngcontent-%COMP%]:hover, .chat.active[_ngcontent-%COMP%]{background:rgba(123,88,202,.2)}"]})}}return o})();var we=c(67145);const ke=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.Xpm({type:o,selectors:[["app-chat"]],decls:7,vars:1,consts:[[1,"py-2","px-1"],[1,"chat-layout",3,"width"],["sidebar","",1,"chats-list","h-100"],["content","",1,"current-chat-content","h-100"]],template:function(r,s){1&r&&(t._UZ(0,"user-navbar"),t.TgZ(1,"div",0)(2,"layout-with-sidebar",1)(3,"div",2),t._UZ(4,"app-chats-list"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"app-room"),t.qZA()()()),2&r&&(t.xp6(2),t.Q6J("width",45))},dependencies:[U._,l.o,Ne,we.Y]})}}return o})()}];let Le=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=t.oAB({type:o})}static{this.\u0275inj=t.cJS({imports:[m.Bz.forChild(ke),m.Bz]})}}return o})();var G=c(84943),Pe=c(24971),Se=c(7314),Ye=c(41614),De=c(20400),Re=c(74100),Fe=c(65668),qe=c(32801);let Be=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=t.oAB({type:o})}static{this.\u0275inj=t.cJS({imports:[e.ez,Le,G.x,B.l,Pe.g,u.AV,b.aw,h.Nh,x.w,f.u5,N.Tx,$.ot,Se.T,Ye.K,De.t,G.x,T.R,Re.H,l.o,D.V,Fe.N,qe.G]})}}return o})()},67145:(J,I,c)=>{c.d(I,{Y:()=>g});var e=c(65879),m=c(68671),t=c(96814),U=c(824),l=c(57105),C=c(83318),Z=c(12867),v=c(17700),M=c(45843),h=c(6311),x=c(47921),f=c(81540),p=c(89515);let u=(()=>{class n{constructor(){}ngOnInit(){}ngOnChanges(s){this.message.text=(0,f.w)(this.message.text)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-text"]],inputs:{message:"message"},features:[e.TTD],decls:2,vars:3,consts:[[1,"contains-link",3,"innerHTML"]],template:function(i,a){1&i&&(e._UZ(0,"p",0),e.ALo(1,"translate")),2&i&&e.Q6J("innerHTML",e.lcZ(1,1,a.message.text),e.oJD)},dependencies:[p.X$],styles:["p[_ngcontent-%COMP%]{word-break:break-word}"]})}}return n})();var T=c(20553);function b(n,r){if(1&n&&(e.TgZ(0,"p",4),e._uU(1),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(s.message.text)}}let _=(()=>{class n{constructor(s){this.dialog=s,this.apiUrl=T.N.imageUrl}ngOnInit(){}openImage(){this.message&&this.message.url?this.dialog.open(w,{panelClass:"image-preview-dialog",data:{url:`${this.apiUrl}/${this.message.url}`}}):console.warn("No image URL provided in the message")}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(v.uw))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-image"]],inputs:{message:"message"},decls:4,vars:2,consts:[[1,"image-message","pointer",3,"click"],[1,"img","mb-50"],["alt","","width","200",1,"rounded","object-fit-cover",3,"src"],["class","mt-50",4,"ngIf"],[1,"mt-50"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return a.openImage()}),e.TgZ(1,"div",1),e._UZ(2,"img",2),e.qZA(),e.YNc(3,b,2,1,"p",3),e.qZA()),2&i&&(e.xp6(2),e.Q6J("src",a.apiUrl+"/"+a.message.url,e.LSH),e.xp6(1),e.Q6J("ngIf",a.message.text))},dependencies:[t.O5],styles:["img[_ngcontent-%COMP%]{max-height:30rem}"]})}}return n})(),w=(()=>{class n{constructor(s){this.data=s}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(v.WI))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["image-preview-dialog"]],decls:2,vars:1,consts:[[1,"image-dialog"],["alt","Image Preview",3,"src"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"img",1),e.qZA()),2&i&&(e.xp6(1),e.Q6J("src",a.data.url,e.LSH))},styles:[".image-dialog[_ngcontent-%COMP%]{text-align:center}img[_ngcontent-%COMP%]{max-width:100%;max-height:800px}"]})}}return n})();function k(n,r){if(1&n&&(e.TgZ(0,"p",3),e._uU(1),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(s.message.text)}}let K=(()=>{class n{constructor(){this.apiUrl=T.N.imageUrl}ngOnInit(){document.addEventListener("play",function(s){let i=document.getElementsByTagName("video");for(let a=0;a<i.length;a++)i[a]!=s.target&&i[a].pause()},!0)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-video"]],inputs:{message:"message"},decls:3,vars:2,consts:[[1,"video-message"],["class","mb-50",4,"ngIf"],["width","300","controls","",1,"rounded",3,"src"],[1,"mb-50"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e.YNc(1,k,2,1,"p",1),e._UZ(2,"video",2),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf",a.message.text),e.xp6(1),e.Q6J("src",a.apiUrl+"/"+a.message.url,e.LSH))},dependencies:[t.O5],styles:["video[_ngcontent-%COMP%]{max-height:40rem;width:100%}"]})}}return n})();function j(n,r){if(1&n&&(e.TgZ(0,"p",4),e._uU(1),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(s.message.text)}}let X=(()=>{class n{constructor(){this.apiUrl=T.N.imageUrl}ngOnInit(){document.addEventListener("play",function(s){let i=document.getElementsByTagName("audio");for(let a=0;a<i.length;a++)i[a]!=s.target&&i[a].pause()},!0)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-audio"]],inputs:{message:"message"},decls:5,vars:2,consts:[[1,"audio-message"],["class","mb-50",4,"ngIf"],["controls","controls",1,"w-100","rounded","border"],["type","audio/mpeg",3,"src"],[1,"mb-50"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e.YNc(1,j,2,1,"p",1),e.TgZ(2,"audio",2),e._UZ(3,"source",3),e._uU(4," Your browser does not support the audio element. "),e.qZA()()),2&i&&(e.xp6(1),e.Q6J("ngIf",a.message.text),e.xp6(2),e.s9C("src",a.apiUrl+"/"+a.message.url,e.LSH))},dependencies:[t.O5],styles:[".audio-message[_ngcontent-%COMP%]{min-width:30rem}"]})}}return n})(),V=(()=>{class n{constructor(){this.apiUrl=T.N.imageUrl}ngOnInit(){}ngOnChanges(s){this.message.url&&(this.extension=this.message.url.split(".")),this.extensionToDisplay=this.extension[this.extension.length-1],this.extension="xlsx"==this.extensionToDisplay||"pdf"==this.extensionToDisplay||"pptx"==this.extensionToDisplay||"docx"==this.extensionToDisplay?this.extensionToDisplay:"not-found"}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-files"]],inputs:{message:"message"},features:[e.TTD],decls:6,vars:3,consts:[[1,"d-block","mt-50"],["target","_blank",3,"href"],[1,"flex","gap-x-1","aic","mb-25"],["alt","","width","30",3,"src"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"a",1)(2,"span",2),e._UZ(3,"img",3),e.TgZ(4,"span"),e._uU(5),e.qZA()()()()),2&i&&(e.xp6(1),e.Q6J("href",a.apiUrl+"/"+a.message.url,e.LSH),e.xp6(2),e.Q6J("src","assets/images/extensions/"+a.extension+".png",e.LSH),e.xp6(2),e.Oqu(a.message.displayName+"."+a.extensionToDisplay))}})}}return n})();var W=c(9619),H=c(11383);const z=function(n){return{"order-2":n}};function L(n,r){if(1&n&&e._UZ(0,"user-image",7),2&n){const s=e.oxw();e.Q6J("img",s.message.senderAvatar)("id",s.message.senderId)("ngClass",e.VKq(3,z,s.message.senderId==s.currentUserId))}}function P(n,r){1&n&&e._UZ(0,"logo")}function S(n,r){if(1&n){const s=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(s);const a=e.oxw(2);return e.KtG(a.reply(a.message))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"reply")))}function ee(n,r){if(1&n){const s=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(s);const a=e.oxw(2);return e.KtG(a.deleteMessage(a.message))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"delete")))}function te(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"i",8),e.TgZ(2,"mat-menu",null,9),e.YNc(4,S,3,3,"button",10),e.YNc(5,ee,3,3,"button",10),e.qZA(),e.BQk()),2&n){const s=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",s),e.xp6(3),e.Q6J("ngIf","text"==i.message.messageType),e.xp6(1),e.Q6J("ngIf",i.message.senderId==i.currentUserId)}}function ne(n,r){if(1&n&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&n){const s=e.oxw(3);e.xp6(1),e.hij("",null==s.message.message?null:s.message.message.senderName,":")}}function se(n,r){1&n&&(e.TgZ(0,"p",16),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij("",e.lcZ(2,1,"you"),":"))}function ae(n,r){if(1&n&&(e.TgZ(0,"p",17),e._uU(1),e.qZA()),2&n){const s=e.oxw(3);e.xp6(1),e.Oqu(null==s.message.message?null:s.message.message.text)}}function q(n,r){1&n&&(e.TgZ(0,"p",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"attachment")))}function oe(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",13),e.YNc(2,ne,2,1,"p",14),e.YNc(3,se,3,3,"p",14),e.YNc(4,ae,2,1,"p",15),e.YNc(5,q,3,3,"p",15),e.qZA(),e.BQk()),2&n){const s=e.oxw(2);e.xp6(2),e.Q6J("ngIf",s.currentUserId!=(null==s.message.message?null:s.message.message.senderId)),e.xp6(1),e.Q6J("ngIf",s.currentUserId==(null==s.message.message?null:s.message.message.senderId)),e.xp6(1),e.Q6J("ngIf","text"==(null==s.message.message?null:s.message.message.messageType)),e.xp6(1),e.Q6J("ngIf","text"!=(null==s.message.message?null:s.message.message.messageType))}}function ie(n,r){if(1&n&&e._UZ(0,"app-text",18),2&n){const s=e.oxw(2);e.Q6J("message",s.message)}}function re(n,r){if(1&n&&e._UZ(0,"app-image",18),2&n){const s=e.oxw(2);e.Q6J("message",s.message)}}function ce(n,r){if(1&n&&e._UZ(0,"app-video",18),2&n){const s=e.oxw(2);e.Q6J("message",s.message)}}function le(n,r){if(1&n&&e._UZ(0,"app-audio",18),2&n){const s=e.oxw(2);e.Q6J("message",s.message)}}function B(n,r){if(1&n&&e._UZ(0,"app-files",18),2&n){const s=e.oxw(2);e.Q6J("message",s.message)}}function pe(n,r){if(1&n&&(e.ynx(0),e.YNc(1,oe,6,4,"ng-container",2),e.YNc(2,ie,1,1,"app-text",12),e.YNc(3,re,1,1,"app-image",12),e.YNc(4,ce,1,1,"app-video",12),e.YNc(5,le,1,1,"app-audio",12),e.YNc(6,B,1,1,"app-files",12),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.message.isReply),e.xp6(1),e.Q6J("ngIf","text"==s.message.messageType||"server"==s.message.messageType),e.xp6(1),e.Q6J("ngIf","image"==s.message.messageType),e.xp6(1),e.Q6J("ngIf","video"==s.message.messageType),e.xp6(1),e.Q6J("ngIf","audio"==s.message.messageType||"record"==s.message.messageType),e.xp6(1),e.Q6J("ngIf","document"==s.message.messageType)}}function ge(n,r){1&n&&(e.O4$(),e.kcU(),e.TgZ(0,"p",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"message_was_deleted")))}function me(n,r){1&n&&(e.O4$(),e.kcU(),e.TgZ(0,"p",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"you_deleted_message")))}function de(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",19),e.O4$(),e.TgZ(2,"svg",20),e._UZ(3,"path",21),e.qZA(),e.YNc(4,ge,3,3,"p",22),e.YNc(5,me,3,3,"p",22),e.qZA(),e.BQk()),2&n){const s=e.oxw();e.xp6(4),e.Q6J("ngIf",s.message.senderId!=s.currentUserId),e.xp6(1),e.Q6J("ngIf",s.message.senderId==s.currentUserId)}}function ue(n,r){if(1&n&&(e.TgZ(0,"p",24),e._uU(1),e.ALo(2,"arabicTime"),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(e.xi3(2,1,s.message.date,!1))}}function he(n,r){if(1&n&&(e.TgZ(0,"p",24),e._uU(1),e.ALo(2,"arabicDate"),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(e.xi3(2,1,s.message.date,"long"))}}const fe=function(n){return{jcfe:n}},_e=function(n){return{"order-1 aife bg-light-primary-1 dark":n}};let A=(()=>{class n{constructor(s,i,a){this.firestore=s,this.service=i,this.dialog=a,this.currentUserId=localStorage.getItem("id"),this.spaceId=localStorage.getItem("space-id")}ngOnInit(){}ngOnChanges(s){this.message.date=new Date(1e3*this.message.timeStamp.seconds);let i=(new Date).getDate()==this.message.date.getDate(),a=(new Date).getFullYear()==this.message.date.getFullYear(),d=(new Date).getMonth()==this.message.date.getMonth();this.message.isToday=i&&a&&d}deleteMessage(s){this.dialog.open(C.v,{panelClass:"confirmation-dialog",data:{message:"delete_message",btn_name:"confirm",classes:"bg-primary white",messageId:s.id}}).afterClosed().subscribe(a=>{a&&this.firestore.collection("companies").doc(localStorage.getItem("chat-id")||"").collection("rooms").doc(this.service.roomIdValue).collection("messages").doc(s.id).update({isDeleted:!0})})}reply(s){this.service.messageReply.next(s)}ngOnDestroy(){}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(Z.ST),e.Y36(m.a),e.Y36(v.uw))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-message"]],inputs:{message:"message"},features:[e.TTD],decls:13,vars:16,consts:[[1,"message","flex","gap-x-1","mb-2",3,"ngClass"],[3,"img","id","ngClass",4,"ngIf"],[4,"ngIf"],[1,"text","flex-column","jcc","px-1","pt-50","pb-50","rounded","bg-gray",3,"ngClass"],[1,"w-100","flex","aic","jcsb","gap-x-2"],[1,"primary"],["class","muted fs-13",4,"ngIf"],[3,"img","id","ngClass"],[1,"bx","bx-dots-horizontal-rounded","fs-23","pointer",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"message",4,"ngIf"],[1,"bg-white","w-100","mb-50","pb-50","pt-50","pl-75","pr-75","rounded","flex","aifs"],["class","max-content",4,"ngIf"],["class","ml-50",4,"ngIf"],[1,"max-content"],[1,"ml-50"],[3,"message"],[1,"flex","aic"],["viewBox","0 0 24 24","height","24","width","24","preserveAspectRatio","xMidYMid meet","fill","none",1,""],["fill-rule","evenodd","clip-rule","evenodd","d","M7.75897 6.43054C8.93584 5.533 10.4057 5 12 5C15.866 5 19 8.13401 19 12C19 13.5943 18.467 15.0642 17.5695 16.241L7.75897 6.43054ZM6.35707 7.85707C5.50399 9.01706 5 10.4497 5 12C5 15.866 8.13401 19 12 19C13.5503 19 14.9829 18.496 16.1429 17.6429L6.35707 7.85707ZM12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3Z","fill","currentColor"],["class","muted ml-50",4,"ngIf"],[1,"muted","ml-50"],[1,"muted","fs-13"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e.YNc(1,L,1,5,"user-image",1),e.YNc(2,P,1,0,"logo",2),e.TgZ(3,"div",3)(4,"div",4)(5,"p",5),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.YNc(8,te,6,3,"ng-container",2),e.qZA(),e.YNc(9,pe,7,6,"ng-container",2),e.YNc(10,de,6,2,"ng-container",2),e.YNc(11,ue,3,4,"p",6),e.YNc(12,he,3,4,"p",6),e.qZA()()),2&i&&(e.Q6J("ngClass",e.VKq(12,fe,a.message.senderId==a.currentUserId)),e.xp6(1),e.Q6J("ngIf","server"!=a.message.messageType),e.xp6(1),e.Q6J("ngIf","server"==a.message.messageType),e.xp6(1),e.Q6J("ngClass",e.VKq(14,_e,a.message.senderId==a.currentUserId)),e.xp6(3),e.Oqu(a.message.senderName||e.lcZ(7,10,"taskedin")),e.xp6(2),e.Q6J("ngIf",!a.message.isDeleted&&"text"==a.message.messageType||"text"!==a.message.messageType&&a.message.senderId==a.currentUserId&&!a.message.isDeleted),e.xp6(1),e.Q6J("ngIf",!a.message.isDeleted),e.xp6(1),e.Q6J("ngIf",a.message.isDeleted),e.xp6(1),e.Q6J("ngIf",a.message.isToday),e.xp6(1),e.Q6J("ngIf",!a.message.isToday))},dependencies:[t.mk,t.O5,M.l,h.VK,h.OP,h.p6,x.R,u,_,K,X,V,p.X$,W.P,H.E],styles:[".text[_ngcontent-%COMP%]{max-width:75%}.order-2[_ngcontent-%COMP%]{order:2}"]})}}return n})();var E=c(63934),Q=c(92596),Y=c(56223),$=c(74100);const Ce=["fileInput"];function xe(n,r){if(1&n&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&n){const s=e.oxw(2);e.xp6(1),e.Oqu(s.reply.text)}}function Te(n,r){1&n&&(e.TgZ(0,"p",14),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"attachment")))}function D(n,r){if(1&n){const s=e.EpF();e.TgZ(0,"div",11),e.YNc(1,xe,2,1,"p",12),e.YNc(2,Te,3,3,"p",12),e.TgZ(3,"i",13),e.NdJ("click",function(){e.CHM(s);const a=e.oxw();return e.KtG(a.clearReply())}),e.qZA()()}if(2&n){const s=e.oxw();e.xp6(1),e.Q6J("ngIf","text"==s.reply.messageType),e.xp6(1),e.Q6J("ngIf","text"!=s.reply.messageType)}}const ye=function(n){return{isRecording:n}},N=function(n){return{pointer:n}},ve=function(n,r){return{primary:n,"bx-rotate-180":r}};let R=(()=>{class n{constructor(s,i,a){this.firestore=s,this.userSer=i,this.service=a,this.chatBtns=!0,this.message="",this.dir=document.dir,this.chatId=localStorage.getItem("chat-id"),this.isRecording=!1}ngOnInit(){this.userSer.user$.subscribe(s=>this.currentUser=s),this.service.roomId.subscribe(s=>{this.roomIdValue=s,this.message="",this.service.messageReply.next(null)}),this.service.messageReply.subscribe(s=>{s?(this.reply=s,delete this.reply.date,delete this.reply.isToday,document.getElementById("send-message")?.focus()):this.reply=null})}sendMessage(){if(this.message){let s=this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(this.roomIdValue).collection("messages").doc().ref;const i={id:s.id,text:this.message,senderId:JSON.stringify(this.currentUser.id),senderName:this.currentUser.name,senderAvatar:this.currentUser.imageUrl?T.N.apiUrl+this.currentUser.imageUrl:null,timeStamp:new Date,isDeleted:!1,isForward:!1,messageType:"text",messageStatus:"pending",isReply:!!this.reply,...!!this.reply&&{message:this.reply}};s.set(i).then(),this.message="",this.reply&&this.service.messageReply.next(null)}}uploadFiles(s){let i=s.target.files;for(let a=0;a<i.length;a++){let d=i[a],y=new FormData;y.append("uploadedFiles",d);let O=d.name.split(".")[0],Ge=this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(this.roomIdValue).collection("messages").doc().ref;this.service.uploadAttachments(y).subscribe(Ke=>{if(Ke.success){const je={id:Ge.id,url:Ke.data.filePath,size:d.size,text:this.message,senderId:JSON.stringify(this.currentUser.id),senderName:this.currentUser.name,senderAvatar:T.N.apiUrl+this.currentUser.imageUrl,timeStamp:new Date,isDeleted:!1,isForward:!1,messageStatus:"pending",isReply:!1,displayName:O};let F;F=d.type.includes("image")?"image":d.type.includes("video")?"video":d.type.includes("audio")?"audio":"document";const Xe={...je,messageType:F};Ge.set(Xe).then(()=>{this.fileInput.nativeElement.value=""})}})}this.message=""}record(s){let i=new FormData;i.append("uploadedFiles",s);let a=this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(this.roomIdValue).collection("messages").doc().ref;this.service.uploadAttachments(i).subscribe(d=>{if(d.success){const y={id:a.id,url:d.data.filePath,size:s.size,text:this.message,senderId:JSON.stringify(this.currentUser.id),senderName:this.currentUser.name,senderAvatar:T.N.apiUrl+this.currentUser.imageUrl,timeStamp:new Date,isDeleted:!1,isForward:!1,messageStatus:"pending",messageType:"record",displayName:"record",isReply:!!this.reply,...!!this.reply&&{message:this.reply}};a.set(y).then(),this.reply&&this.service.messageReply.next(null)}})}clearReply(){this.service.messageReply.next(null)}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(Z.ST),e.Y36(E.K),e.Y36(m.a))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-send-message"]],viewQuery:function(i,a){if(1&i&&e.Gf(Ce,5),2&i){let d;e.iGM(d=e.CRH())&&(a.fileInput=d.first)}},inputs:{chatBtns:"chatBtns"},decls:16,vars:28,consts:[["class","reply w-100 bg-gray flex aic jcsb px-2",4,"ngIf"],[1,"send-message","flex","aic","relative"],["type","text","id","send-message",1,"rounded-0","border-top","dark","fs-16","bg-gray","flex-auto",3,"placeholder","ngModel","ngClass","ngModelChange","keyup.enter"],[1,"record","mr-1","mt-50",3,"matTooltip"],[3,"forChat","soundDescription","isRecording"],["for","files",1,"mt-50","mr-1",3,"matTooltip"],[1,"bx","bx-paperclip","fs-22","pointer"],[1,"send-message-btn","img",3,"ngClass","matTooltip","click"],[1,"bx","bx-send","fs-22",3,"ngClass"],["type","file","hidden","","multiple","","id","files",3,"change"],["fileInput",""],[1,"reply","w-100","bg-gray","flex","aic","jcsb","px-2"],["class","muted reply-text",4,"ngIf"],[1,"bx","bx-x","fs-25","danger","pointer",3,"click"],[1,"muted","reply-text"]],template:function(i,a){1&i&&(e.YNc(0,D,4,2,"div",0),e.TgZ(1,"div",1)(2,"input",2),e.NdJ("ngModelChange",function(y){return a.message=y})("keyup.enter",function(){return a.sendMessage()}),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div")(5,"div",3),e.ALo(6,"translate"),e.TgZ(7,"record",4),e.NdJ("soundDescription",function(y){return a.record(y)})("isRecording",function(y){return a.isRecording=y}),e.qZA()(),e.TgZ(8,"label",5),e.ALo(9,"translate"),e._UZ(10,"i",6),e.qZA(),e.TgZ(11,"div",7),e.NdJ("click",function(){return a.sendMessage()}),e.ALo(12,"translate"),e._UZ(13,"i",8),e.qZA()()(),e.TgZ(14,"input",9,10),e.NdJ("change",function(y){return a.uploadFiles(y)}),e.qZA()),2&i&&(e.Q6J("ngIf",a.reply),e.xp6(2),e.Q6J("placeholder",e.lcZ(3,13,"send_message"))("ngModel",a.message)("ngClass",e.VKq(21,ye,a.isRecording)),e.xp6(2),e.Gre("flex absolute px-2 aic pb-50 ",a.chatBtns?"mr-4":"",""),e.xp6(1),e.Q6J("matTooltip",e.lcZ(6,15,"sound_description")),e.xp6(2),e.Q6J("forChat",!0),e.xp6(1),e.Q6J("matTooltip",e.lcZ(9,17,"upload_files")),e.xp6(3),e.Q6J("ngClass",e.VKq(23,N,a.message))("matTooltip",a.message?e.lcZ(12,19,"send"):""),e.xp6(2),e.Q6J("ngClass",e.WLB(25,ve,a.message,"rtl"==a.dir)))},dependencies:[t.mk,t.O5,Q.gM,Y.Fj,Y.JJ,Y.On,$.H,p.X$],styles:["[_ngcontent-%COMP%]:root{--primary: #7b58ca;--light-primary: #7b58ca80;--dark-color: #707070;--gray: #FAF9FD;--success: #29CC99;--danger: #ea5455;--canceled: #C7C7CC;--warning: #F69E42;--info: #007AFF;--dark-white: #283046;--dark-gray: #161D31;--white-color: #b4b7bd;--dark-border: #404656;--border-color: #e7e7e7;--closed: rgba(234, 84, 85, .53)}.primary[_ngcontent-%COMP%]{color:#7b58ca!important}.bg-primary[_ngcontent-%COMP%]{background:#7b58ca!important}.bg-light-primary-10[_ngcontent-%COMP%]{background:rgba(123,88,202,.1)!important}.light-primary[_ngcontent-%COMP%]{color:#7b58ca80!important}.bg-light-primary[_ngcontent-%COMP%]{background:rgba(123,88,202,.5019607843)!important}.closed-color[_ngcontent-%COMP%]{color:#ea545587!important}.bg-closed-color[_ngcontent-%COMP%]{background:rgba(234,84,85,.53)!important}.bg-archived[_ngcontent-%COMP%]{background:#c5c5c5!important}.bg-light-success-1[_ngcontent-%COMP%]{color:#29cc99b5;background-color:#f7fffa}.bg-light-primary-1[_ngcontent-%COMP%]{color:#7b58ca;background:#fbf9ff}.bg-light-warning-2[_ngcontent-%COMP%]{color:#f69e42;background-color:#f69e4233!important}.bg-light-primary-2[_ngcontent-%COMP%]{color:#7b58ca;background-color:#7b58ca33!important}.bg-light-success-2[_ngcontent-%COMP%]{color:#29cc99;background-color:#29cc991a!important}.bg-light-canceled-2[_ngcontent-%COMP%]{color:#c7c7cc;background-color:#c7c7cc33!important}.bg-light-danger-1[_ngcontent-%COMP%]{color:#ea5455;background-color:#fff3f3}.border-primary[_ngcontent-%COMP%]{border:1px solid #7b58ca!important}input[_ngcontent-%COMP%]{height:5rem!important;width:100%;outline:none!important;padding-top:.5rem;padding-bottom:.5rem;padding-inline-start:2rem!important;border:none}input.btn-start[_ngcontent-%COMP%]{padding-inline-end:12rem!important}input.isRecording[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important;padding-inline-start:2rem!important;padding-inline-end:43rem!important}.reply[_ngcontent-%COMP%]{height:5rem!important}.reply[_ngcontent-%COMP%]   .reply-text[_ngcontent-%COMP%]{width:95%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.absolute[_ngcontent-%COMP%]{position:absolute;inset-inline-end:0;bottom:0}.jce[_ngcontent-%COMP%]{justify-content:end}"]})}}return n})();var be=c(64190),Ze=c(65648),Ie=c(20400),Me=c(65668),Ue=c(41614);function Oe(n,r){if(1&n&&(e.TgZ(0,"div",8)(1,"div",9),e._UZ(2,"user-image",10),e.qZA(),e.TgZ(3,"div",11)(4,"p",12),e._uU(5),e.qZA()()()),2&n){const s=r.$implicit;e.xp6(2),e.Q6J("img",s.avatar)("id",+s.id)("dim",35),e.xp6(3),e.Oqu(s.name)}}let Ae=(()=>{class n{constructor(s,i){this.firestore=s,this.service=i,this.chatId=localStorage.getItem("chat-id"),this.users=[],this.open=!1}ngOnInit(){}getMembers(){this.users=[],this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(this.service.roomIdValue).collection("members").snapshotChanges().subscribe(s=>{s.map(i=>{this.users.push(i.payload.doc.data())}),this.getUsers()})}getUsers(){this.open=!1,setTimeout(()=>{this.open=!0},0)}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(Z.ST),e.Y36(m.a))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-group-members"]],decls:11,vars:8,consts:[[1,"img","pointer",3,"matTooltip","click"],["src","assets/images/main-sidebar/users.svg","alt","","width","25",1,"convert-image-color"],[3,"open"],["header",""],[1,"black"],["content",""],[1,"p-2"],["class","reporter bg-gray rounded mb-1 p-1 flex aic",4,"ngFor","ngForOf"],[1,"reporter","bg-gray","rounded","mb-1","p-1","flex","aic"],[1,"start"],[3,"img","id","dim"],[1,"end","ml-1"],[1,"line-height"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return a.getMembers()}),e.ALo(1,"translate"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"info-sidebar",2),e.ynx(4,3),e.TgZ(5,"h2",4),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.BQk(),e.ynx(8,5),e.TgZ(9,"div",6),e.YNc(10,Oe,6,4,"div",7),e.qZA(),e.BQk(),e.qZA()),2&i&&(e.Q6J("matTooltip",e.lcZ(1,4,"group_members")),e.xp6(3),e.Q6J("open",a.open),e.xp6(3),e.Oqu(e.lcZ(7,6,"group_members")),e.xp6(4),e.Q6J("ngForOf",a.users))},dependencies:[t.sg,M.l,Q.gM,Ue.K,p.X$]})}}return n})();function Je(n,r){1&n&&e._UZ(0,"logo")}function Qe(n,r){if(1&n&&e._UZ(0,"user-image",7),2&n){const s=e.oxw(2);e.Q6J("img",null==s.user?null:s.user.avatar)("id",null==s.user?null:s.user.id)}}function Ne(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw(2);e.xp6(1),e.hij(" ",s.selectedRoom.name," ")}}function we(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw(2);e.xp6(1),e.hij(" ",null==s.user?null:s.user.name," ")}}function $e(n,r){if(1&n){const s=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){e.CHM(s);const a=e.oxw(3);return e.KtG(a.getTask())}),e.ALo(1,"translate"),e._UZ(2,"img",11),e.qZA()}2&n&&e.Q6J("matTooltip",e.lcZ(1,1,"go_to_task"))}function ke(n,r){1&n&&(e.ynx(0),e._UZ(1,"app-group-members"),e.BQk())}function Le(n,r){if(1&n&&(e.TgZ(0,"div",8),e.YNc(1,$e,3,3,"div",9),e.YNc(2,ke,2,0,"ng-container",0),e.qZA()),2&n){const s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","task"==s.selectedRoom.subType&&"group"==s.selectedRoom.type),e.xp6(1),e.Q6J("ngIf","group"==s.selectedRoom.subType&&"group"==s.selectedRoom.type)}}function G(n,r){if(1&n&&e._UZ(0,"task-group-details",12),2&n){const s=e.oxw(2);e.Q6J("open",s.open)("task",s.taskId)("reporters",s.reporters)("isChat",!0)}}function Pe(n,r){1&n&&e._UZ(0,"loading")}function Se(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,Je,1,0,"logo",0),e.YNc(5,Qe,1,2,"user-image",4),e.qZA(),e.TgZ(6,"p"),e.YNc(7,Ne,2,1,"ng-container",0),e.YNc(8,we,2,1,"ng-container",0),e.qZA()(),e.YNc(9,Le,3,2,"div",5),e.qZA(),e.YNc(10,G,1,4,"task-group-details",6),e.YNc(11,Pe,1,0,"loading",0),e.BQk()),2&n){const s=e.oxw();e.xp6(4),e.Q6J("ngIf","group"==s.selectedRoom.type&&("task"==s.selectedRoom.subType||"group"==s.selectedRoom.subType)),e.xp6(1),e.Q6J("ngIf","private"==s.selectedRoom.subType),e.xp6(2),e.Q6J("ngIf","private"!=s.selectedRoom.subType),e.xp6(1),e.Q6J("ngIf","private"==s.selectedRoom.subType),e.xp6(1),e.Q6J("ngIf",!s.taskDetails),e.xp6(1),e.Q6J("ngIf",s.open),e.xp6(1),e.Q6J("ngIf",s.loading)}}let Ye=(()=>{class n{constructor(s,i,a,d){this.firestore=s,this.service=i,this.router=a,this.taskGroupDetailsSer=d,this.taskDetails=!1,this.apiUrl=T.N.apiUrl,this.chatId=localStorage.getItem("chat-id"),this.currentUserId=localStorage.getItem("id"),this.open=!1,this.assignees=[],this.reporters=[]}ngOnInit(){this.service.roomId.subscribe(s=>{this.firestore.collection("companies").doc(this.chatId).collection("rooms").doc(s).snapshotChanges().subscribe(i=>{if(this.selectedRoom=i.payload.data(),"private"==this.selectedRoom.subType){let a=this.selectedRoom.members.filter(d=>d.id!=this.currentUserId)[0];this.service.getUserProfiles([a.id]).subscribe(d=>{let y=d[0];console.log(y),this.user={name:y.name,avatar:y.imageUrl,id:y.id}})}})})}getTask(){this.loading=!0,this.service.getTask(this.selectedRoom.id).subscribe(s=>{this.loading=!1,this.taskId={id:s.data.taskGroupForCreator,title:this.selectedRoom.name},s.data.taskForTheAssignee?this.router.navigate(["/tasks/inbox/details/"+s.data.taskForTheAssignee]):(this.open=!1,setTimeout(()=>{this.open=!0},0),this.taskGroupDetailsSer.getReporters(s.data.taskGroupForCreator).subscribe(i=>{this.reporters=i.data.items}))})}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(Z.ST),e.Y36(m.a),e.Y36(be.F0),e.Y36(Ze.Q))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-top-section"]],inputs:{taskDetails:"taskDetails"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"top-section","bg-gray","flex","aic","jcsb","px-2","border-bottom"],[1,"start","flex","aic","gap-x-1"],[1,"img"],[3,"img","id",4,"ngIf"],["class","end",4,"ngIf"],[3,"open","task","reporters","isChat",4,"ngIf"],[3,"img","id"],[1,"end"],["class","img pointer",3,"matTooltip","click",4,"ngIf"],[1,"img","pointer",3,"matTooltip","click"],["src","assets/images/main-sidebar/tasks.svg","alt","tasks icon","width","25",1,"convert-image-color"],[3,"open","task","reporters","isChat"]],template:function(i,a){1&i&&e.YNc(0,Se,12,7,"ng-container",0),2&i&&e.Q6J("ngIf",a.selectedRoom)},dependencies:[t.O5,M.l,Q.gM,Ie.t,x.R,Me.N,Ae,p.X$],styles:[".top-section[_ngcontent-%COMP%]{height:6rem}"]})}}return n})();function De(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"app-top-section",3),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("taskDetails",s.taskDetails)}}function Re(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"app-message",5),e.BQk()),2&n){const s=r.$implicit;e.xp6(1),e.Q6J("message",s)}}function Fe(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Re,2,1,"ng-container",4),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.room)("ngForTrackBy",s.trackBy)}}function qe(n,r){1&n&&(e.ynx(0),e._UZ(1,"not-found",6),e.BQk())}function Be(n,r){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"app-send-message",8),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("chatBtns",s.chatBtns)}}const o=function(n,r){return{jcc:n,withReply:r}};let g=(()=>{class n{constructor(s){this.service=s,this.taskDetails=!1,this.header=!0,this.chatBtns=!0,this.newRoom=!1,this.hasReply=!1}ngOnInit(){this.sub1=this.service.messages$.subscribe(i=>{this.room=i}),this.sub2=this.service.messageReply.subscribe(i=>{this.hasReply=!!i}),this.service.newRoomCreated.subscribe(i=>this.newRoom=i);let s=document.getElementById("room");s.addEventListener("scroll",()=>{clearTimeout(this.timeout),Math.abs(s.scrollTop)+s.clientHeight+100>=s.scrollHeight&&"0"!=this.service.roomIdValue&&(this.timeout=setTimeout(()=>{this.service.getRoomChat(!1)},300))})}ngOnDestroy(){this.sub1.unsubscribe(),this.sub2.unsubscribe()}trackBy(s,i){return i.id}static{this.\u0275fac=function(i){return new(i||n)(e.Y36(m.a))}}static{this.\u0275cmp=e.Xpm({type:n,selectors:[["app-room"]],inputs:{taskDetails:"taskDetails",header:"header",chatBtns:"chatBtns"},decls:6,vars:11,consts:[[4,"ngIf"],["id","room","magicScroll","",1,"room","p-2",3,"ngClass"],["class","input-field",4,"ngIf"],[3,"taskDetails"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"message"],["message","select_chat"],[1,"input-field"],[3,"chatBtns"]],template:function(i,a){1&i&&(e.TgZ(0,"div"),e.YNc(1,De,2,1,"ng-container",0),e.TgZ(2,"div",1),e.YNc(3,Fe,2,2,"ng-container",0),e.YNc(4,qe,2,0,"ng-container",0),e.qZA(),e.YNc(5,Be,2,1,"div",2),e.qZA()),2&i&&(e.Gre("h-100 ",a.header?"":"no-header",""),e.xp6(1),e.Q6J("ngIf",(a.room.length>0||a.newRoom)&&1==a.header),e.xp6(1),e.Q6J("ngClass",e.WLB(8,o,0===a.room.length,a.hasReply)),e.xp6(1),e.Q6J("ngIf",a.room.length>0||a.newRoom),e.xp6(1),e.Q6J("ngIf",0==a.room.length&&!a.newRoom),e.xp6(1),e.Q6J("ngIf",a.room.length>0||a.newRoom))},dependencies:[t.mk,t.sg,t.O5,U.h,l.w,A,R,Ye],styles:[".input-field[_ngcontent-%COMP%]{height:5rem}.room[_ngcontent-%COMP%]{height:calc(100% - 11rem);display:flex;flex-direction:column-reverse}.room.withReply[_ngcontent-%COMP%]{height:calc(100% - 16rem)}.no-header[_ngcontent-%COMP%]   .room[_ngcontent-%COMP%]{height:calc(100% - 5rem)!important}"]})}}return n})()}}]);