"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[8820,1428,6526],{1428:(y,f,o)=>{o.d(f,{$:()=>x});var l=o(65879),h=o(96814),_=o(3131);const d=function(p){return{"max-width":p}},k=["*"];let x=(()=>{class p{constructor(){this.scroll=!1,this.service=(0,l.f3M)(_.P)}static{this.\u0275fac=function(m){return new(m||p)}}static{this.\u0275cmp=l.Xpm({type:p,selectors:[["layout"]],inputs:{scroll:"scroll"},standalone:!0,features:[l.jDz],ngContentSelectors:k,decls:2,vars:6,consts:[[3,"ngStyle"]],template:function(m,g){1&m&&(l.F$t(),l.TgZ(0,"div",0),l.Hsn(1),l.qZA()),2&m&&(l.Gre("",g.scroll?"scroll":""," layout rounded bg-white border"),l.Q6J("ngStyle",l.VKq(4,d,g.service.withSubMenu.value?"100vw":"calc(100vw - 92px)")))},dependencies:[h.ez,h.PC],styles:[".layout[_ngcontent-%COMP%]{overflow:hidden;height:calc(100vh - 11rem);box-shadow:0 1px 38px #0000001a,0 2px 4px -1px #0000000f}.scroll[_ngcontent-%COMP%]{overflow-y:auto!important}"]})}}return p})()},3131:(y,f,o)=>{o.d(f,{P:()=>_});var l=o(65619),h=o(65879);let _=(()=>{class d{constructor(){this.withSubMenu=new l.X(!0)}static{this.\u0275fac=function(p){return new(p||d)}}static{this.\u0275prov=h.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()},58820:(y,f,o)=>{o.r(f),o.d(f,{RequestsComponent:()=>ae});var l=o(96814),h=o(1428),_=o(57105),d=o(65668),k=o(39326),x=o(92596),p=o(45843),v=o(89515),u=o(17700),m=o(32296),g=o(56223),e=o(65879),q=o(49388);const w=function(i){return{"bg-danger":i}};let A=(()=>{class i{constructor(){this.reason=""}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.Xpm({type:i,selectors:[["task-rejection-reason"]],standalone:!0,features:[e.jDz],decls:17,vars:18,consts:[["dir","auto",1,"rejection-reason"],["mat-dialog-content","",1,"reason"],["rows","4",1,"input",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],[1,"flex","w-100"],["mat-raised-button","","mat-dialog-close","",1,"flex-auto","dark-color","clickable-btn","rounded","cancel-btn"],["mat-raised-button","",1,"flex-auto","rounded",3,"mat-dialog-close","ngClass","disabled"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"h3"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"textarea",2),e.NdJ("ngModelChange",function(r){return n.reason=r}),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4)(11,"button",5),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",6),e._uU(15),e.ALo(16,"translate"),e.qZA()()()()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,8,"reject_task")),e.xp6(4),e.Oqu(e.lcZ(7,10,"reason_of_rejection")),e.xp6(2),e.Q6J("ngModel",n.reason),e.xp6(4),e.Oqu(e.lcZ(13,12,"cancel")),e.xp6(2),e.Q6J("mat-dialog-close",n.reason)("ngClass",e.VKq(16,w,n.reason))("disabled",!n.reason),e.xp6(1),e.Oqu(e.lcZ(16,14,"reject")))},dependencies:[l.ez,l.mk,u.Is,u.ZT,u.xY,u.H8,q.Lv,v.aw,v.X$,m.ot,m.lW,g.u5,g.Fj,g.JJ,g.On],encapsulation:2})}}return i})();var M=o(824),R=o(42666),U=o(83318),Z=o(69862),I=o(54807),K=o(32801),b=o(96296);function J(i,c){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"assign_kpi_categeory_first")))}function O(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"ng-select",16),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.selectedCategory=n)})("change",function(n){e.CHM(t);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.onCategoryChange(n,a))}),e.qZA()}if(2&i){const t=e.oxw().$implicit,s=e.oxw(2);e.Q6J("items",t.kpiCategories)("multiple",!1)("ngModel",t.selectedCategory)("compareWith",s.compareCategories)}}function D(i,c){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"assign_kpi_categeory_first")))}const L=function(){return[]};function N(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"ng-select",17),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.selectedKpi=n)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,s=e.oxw(2);e.Q6J("items",(null==t.selectedCategory?null:t.selectedCategory.kpis)||e.DdM(4,L))("multiple",!1)("ngModel",t.selectedKpi)("compareWith",s.compareKpis)}}function S(i,c){if(1&i&&(e.TgZ(0,"div",10)(1,"div",11),e._UZ(2,"app-img-title",12),e.qZA(),e.TgZ(3,"div",11),e.YNc(4,J,3,3,"span",13),e.YNc(5,O,1,4,"ng-select",14),e.qZA(),e.TgZ(6,"div"),e.YNc(7,D,3,3,"span",13),e.YNc(8,N,1,5,"ng-select",15),e.qZA()()),2&i){const t=c.$implicit;e.xp6(2),e.Q6J("title",t.userName)("subTitle",t.userJobTitle)("userId",t.userId)("imgSrc",t.userPic),e.xp6(2),e.Q6J("ngIf",0==t.kpiCategories.length),e.xp6(1),e.Q6J("ngIf",t.kpiCategories.length>0),e.xp6(2),e.Q6J("ngIf",0==(null==t.selectedCategory?null:t.selectedCategory.kpis.length)),e.xp6(1),e.Q6J("ngIf",(null==t.selectedCategory?null:t.selectedCategory.kpis.length)>0)}}function P(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",6),e.YNc(1,S,9,8,"div",7),e.TgZ(2,"div",8)(3,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e._uU(4),e.ALo(5,"translate"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.itemsList),e.xp6(3),e.Oqu(e.lcZ(5,2,"save"))}}function Q(i,c){1&i&&e._UZ(0,"loading",20),2&i&&e.Q6J("centerd",!0)}function j(i,c){1&i&&e._UZ(0,"not-found")}function Y(i,c){if(1&i&&(e.TgZ(0,"div",18),e.YNc(1,Q,1,1,"loading",19),e.YNc(2,j,1,0,"not-found",13),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading&&0==t.itemsList.length)}}let E=(()=>{class i{constructor(t,s,n){this.data=t,this.service=s,this.dialogRef=n,this.kpisValue=new e.vpe,this.loading=!0,this.itemsList=[],this.assignees=[],this.selectedUsersKpis=[],this.backupItemsList=[],this.assignees=this.data.assignees.map(a=>a),this.data.selectedData&&this.data.selectedData.length>0&&(this.selectedUsersKpis=this.data.selectedData.map(a=>a))}ngOnInit(){this.getItemsList()}getItemsList(){this.loading=!0;let t=(new Z.LE).set("IsAutomatic","true");this.assignees.length>0?(this.assignees.forEach(s=>{t=t.append("EmployeeIds",s)}),this.service.getAllEmployeesWithkpi(t).subscribe(s=>{this.itemsList=s.data,this.loading=!1})):this.loading=!1}onCategoryChange(t,s){t&&t.employeeCategoryId!==s.selectedCategory?.employeeCategoryId&&(s.selectedCategory=t,s.selectedKpi=null)}submit(){const t=this.itemsList.filter(s=>s.selectedKpi).map(s=>({userId:s.userId,employeeCategoryId:s.selectedCategory.employeeCategoryId,employeeKpiId:s.selectedKpi.employeeKpiId||s.selectedKpi}));this.kpisValue.emit(t),this.dialogRef.close(t)}compareCategories(t,s){return t&&s?t.employeeCategoryId===s.employeeCategoryId:t===s}compareKpis(t,s){return t&&s?t.employeeKpiId===s.employeeKpiId:t===s}static{this.\u0275fac=function(s){return new(s||i)(e.Y36(u.WI),e.Y36(b.q),e.Y36(u.so))}}static{this.\u0275cmp=e.Xpm({type:i,selectors:[["show-user-kpis-dialog"]],outputs:{kpisValue:"kpisValue"},standalone:!0,features:[e.jDz],decls:8,vars:5,consts:[[1,"dir","py-2"],[1,"flex","aic","jcsb","px-2","mb-2"],[1,"fs-18","black","simibold"],[1,"bx","bx-x","fs-20","pointer",3,"click"],["class","px-2",4,"ngIf"],["class","flex aic jcc py-5",4,"ngIf"],[1,"px-2"],["class","",4,"ngFor","ngForOf"],[1,"text-right","mt-2"],[1,"btn","bg-primary","rounded","py-75","px-1","white",3,"click"],[1,""],[1,"mb-2"],[3,"title","subTitle","userId","imgSrc"],[4,"ngIf"],["bindLabel","categoryName","bindValue","employeeCategoryId","class","icon-input",3,"items","multiple","ngModel","compareWith","ngModelChange","change",4,"ngIf"],["bindLabel","kpiName","bindValue","employeeKpiId","class","icon-input",3,"items","multiple","ngModel","compareWith","ngModelChange",4,"ngIf"],["bindLabel","categoryName","bindValue","employeeCategoryId",1,"icon-input",3,"items","multiple","ngModel","compareWith","ngModelChange","change"],["bindLabel","kpiName","bindValue","employeeKpiId",1,"icon-input",3,"items","multiple","ngModel","compareWith","ngModelChange"],[1,"flex","aic","jcc","py-5"],[3,"centerd",4,"ngIf"],[3,"centerd"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"i",3),e.NdJ("click",function(){return n.dialogRef.close()}),e.qZA()(),e.YNc(6,P,6,4,"div",4),e.YNc(7,Y,3,2,"div",5),e.qZA()),2&s&&(e.xp6(3),e.Oqu(e.lcZ(4,3,"link_kpi_to_task")),e.xp6(3),e.Q6J("ngIf",!n.loading&&n.itemsList.length>0),e.xp6(1),e.Q6J("ngIf",n.loading||0==n.itemsList.length))},dependencies:[v.aw,v.X$,d.N,_.w,l.ez,l.sg,l.O5,g.u5,g.JJ,g.On,I.A0,I.w9,K.G],styles:[".table-container[_ngcontent-%COMP%]{height:465px;max-height:465px;overflow-y:auto}"]})}}return i})();var F=o(20553),$=o(65619),G=o(37398);let W=(()=>{class i{constructor(t){this.http=t,this.taskRequests=new $.X([])}getTaskRequests(){return this.http.get(`${F.N.apiUrl}api/TaskRequests/GetMyTaskRequests`).pipe((0,G.U)(t=>{let s=t.data.items;return this.taskRequests.next(s),s}))}static{this.\u0275fac=function(s){return new(s||i)(e.LFG(Z.eN))}}static{this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var V=o(24110),z=o(64190),B=o(99758),H=o(68671);function X(i,c){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(null==t?null:t.title)}}function ee(i,c){if(1&i&&(e.TgZ(0,"span",22),e._uU(1),e.ALo(2,"slice"),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("matTooltip",t.title),e.xp6(1),e.hij("",e.Dn7(2,2,null==t?null:t.title,0,20)," ...")}}const te=function(i){return{"bx-rotate-180":i}};function se(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.getTask(a.taskId))}),e.TgZ(1,"div",7),e._UZ(2,"priority",8),e.TgZ(3,"h4",9),e.YNc(4,X,2,1,"span",3),e.YNc(5,ee,3,6,"span",10),e.qZA()(),e.TgZ(6,"div",11),e._UZ(7,"user-image",12),e.TgZ(8,"p",13),e._uU(9),e.qZA(),e._UZ(10,"i",14)(11,"user-image",12),e.TgZ(12,"p",13),e._uU(13),e.qZA()(),e.TgZ(14,"div",15),e.NdJ("click",function(n){return n.stopImmediatePropagation()}),e.TgZ(15,"div",16),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.rejectTaskRequest(a.taskId))}),e.ALo(16,"translate"),e._UZ(17,"i",17),e.qZA(),e.TgZ(18,"div",18),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.forward(a))}),e.ALo(19,"translate"),e._UZ(20,"img",19),e.qZA(),e.TgZ(21,"div",20),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.approveTaskRequest(a.taskId,a.taskGroupId,a.assigneeId))}),e.ALo(22,"translate"),e._UZ(23,"i",21),e.qZA()()()}if(2&i){const t=c.$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("priority",null==t?null:t.priority),e.xp6(2),e.Q6J("ngIf",t.title.length<=20),e.xp6(1),e.Q6J("ngIf",t.title.length>20),e.xp6(2),e.Q6J("img",t.creatorProfilePicture),e.xp6(2),e.Oqu(null==t?null:t.creatorName),e.xp6(1),e.Q6J("ngClass",e.VKq(17,te,"ltr"==s.dir)),e.xp6(1),e.Q6J("img",t.assigneeProfilePicture),e.xp6(2),e.Oqu(null==t?null:t.assigneeName),e.xp6(2),e.Q6J("matTooltip",e.lcZ(16,11,"reject")),e.xp6(3),e.Q6J("matTooltip",e.lcZ(19,13,"forward")),e.xp6(3),e.Q6J("matTooltip",e.lcZ(22,15,"approve"))}}function ie(i,c){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,se,24,19,"div",5),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.requests)("ngForTrackBy",t.trackBy)}}function ne(i,c){1&i&&e._UZ(0,"not-found")}function oe(i,c){1&i&&e._UZ(0,"loading")}let ae=(()=>{class i{constructor(t,s,n,a,r,C,T){this.service=t,this.kpiServ=s,this.globalSer=n,this.router=a,this.alert=r,this.dialog=C,this.chatSer=T,this.requests=[],this.loading=!1,this.dir=document.dir}ngOnInit(){this.service.taskRequests.subscribe(t=>{this.requests=t,this.requests.length>0&&(this.loading=!1)}),0==this.requests.length&&this.getRequests()}getRequests(){this.loading=!0,this.service.getTaskRequests().subscribe(()=>{this.loading=!1})}getTask(t){this.router.navigate(["/tasks/sent/details/",t])}approveTaskRequest(t,s,n=null){this.dialog.open(U.v,{panelClass:"confirmation-dialog",autoFocus:!1,data:{message:"link_kpi_to_task_message",btn_name:"approve",classes:"bg-primary white"}}).afterClosed().subscribe(r=>{this.globalSer.approveOrRejectTaskRequest({id:t,isApproved:!0}).subscribe(C=>{C.success&&(this.chatSer.refreshTaskUser(s||t).subscribe(),this.alert.showAlert("task_approved"),this.getRequests())}),r&&this.dialog.open(E,{width:"500px",data:{assignees:[n],selectedData:null}}).afterClosed().subscribe(T=>{T&&this.kpiServ.addTaskToKpi({taskId:t,employeeKpiId:T[0].employeeKpiId}).subscribe(re=>{re.success&&this.alert.showAlert("link_kpi_to_task_successfully")})})})}rejectTaskRequest(t){this.dialog.open(A,{panelClass:"confirmation-dialog",data:{id:t,btn_name:"reject",redirect:!1}}).afterClosed().subscribe(n=>{n&&this.globalSer.approveOrRejectTaskRequest({id:t,isApproved:!1,reason:n}).subscribe(r=>{r.success&&(this.alert.showAlert("task_rejected"),this.getRequests())})})}forward(t){this.dialog.open(R.$,{panelClass:"select-users-dialog",data:{selectedUsers:[],multi:!1}}).afterClosed().subscribe(n=>{n?.changed&&this.globalSer.forwardTask({assigneeId:n.users[0].id,taskId:t.taskId,taskGroupId:t.taskGroupId}).subscribe(r=>{r.success&&(this.alert.showAlert("task_forwarded"),this.chatSer.refreshTaskUser(t.taskGroupId||t.taskId).subscribe(),this.getRequests())})})}trackBy(t,s){return s.taskId}static{this.\u0275fac=function(s){return new(s||i)(e.Y36(W),e.Y36(b.q),e.Y36(V.U),e.Y36(z.F0),e.Y36(B.c),e.Y36(u.uw),e.Y36(H.a))}}static{this.\u0275cmp=e.Xpm({type:i,selectors:[["requests"]],standalone:!0,features:[e.jDz],decls:6,vars:3,consts:[[1,"task-requests"],["magicScroll","",1,"task-requests","h-100","relative"],["class","requests",4,"ngIf"],[4,"ngIf"],[1,"requests"],["class","task-request px-3 py-2 border-bottom flex aic pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"task-request","px-3","py-2","border-bottom","flex","aic","pointer",3,"click"],[1,"start","flex","aic","flex-33"],[3,"priority"],[1,"ml-2"],[3,"matTooltip",4,"ngIf"],[1,"middle","flex","aic","flex-auto","fs-13"],[3,"img"],[1,"ml-1"],[1,"bx","bx-arrow-back","primary","fs-23","mx-1",3,"ngClass"],[1,"end","flex","aic","jcfe","flex-10",3,"click"],[1,"reject","bg-danger","rounded-50","action","flex-center","pointer",3,"matTooltip","click"],[1,"bx","bx-x","white","fs-24"],[1,"img","forward","bg-primary","mx-2","rounded-50","action","flex-center","pointer","px-25","pt-25","pb-25",3,"matTooltip","click"],["src","assets/images/icons/forward.svg","alt","forward",1,"forward-image"],[1,"approve","bg-success","rounded-50","action","flex-center","pointer",3,"matTooltip","click"],[1,"bx","bx-check","white","fs-24"],[3,"matTooltip"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"layout")(2,"div",1),e.YNc(3,ie,2,2,"div",2),e.YNc(4,ne,1,0,"not-found",3),e.YNc(5,oe,1,0,"loading",3),e.qZA()()()),2&s&&(e.xp6(3),e.Q6J("ngIf",n.requests.length>0&&!n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading&&0==n.requests.length),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.ez,l.mk,l.sg,l.O5,l.OU,h.$,_.w,d.N,k.t,x.AV,x.gM,p.l,v.aw,v.X$,M.h],styles:[".task-requests[_ngcontent-%COMP%]   .requests[_ngcontent-%COMP%]{min-width:90rem}.task-requests[_ngcontent-%COMP%]   .task-request[_ngcontent-%COMP%]:hover{background-color:#0000000d}.task-requests[_ngcontent-%COMP%]   .forward[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:brightness(0) invert(1)!important;width:1.9rem}.flex-30[_ngcontent-%COMP%]{flex:1 1 30%;max-width:30%}"]})}}return i})()}}]);