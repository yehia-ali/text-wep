"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[6902],{16862:(D,C,s)=>{s.d(C,{$:()=>y});var t=s(96814),d=s(89515),h=s(56223),n=s(17700),Z=s(32296),b=s(66507),I=s(52081),x=s(1350),e=s(65879),l=s(98771),g=s(99758),c=s(64379);function r(v,k){if(1&v&&(e.TgZ(0,"div",13)(1,"div",14)(2,"div",15),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",16),e._uU(6),e.ALo(7,"arabicNumbers"),e.qZA()()()),2&v){const m=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"target")),e.xp6(3),e.Oqu(e.lcZ(7,4,m.data.target))}}function _(v,k){if(1&v&&(e.TgZ(0,"p",17),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"arabicNumbers"),e.qZA()),2&v){const m=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,"average_rate")," ",e.lcZ(3,4,m.rate),"")}}function p(v,k){if(1&v){const m=e.EpF();e.TgZ(0,"div",18),e._UZ(1,"input-label",19),e.TgZ(2,"input",20),e.NdJ("ngModelChange",function(u){e.CHM(m);const O=e.oxw();return e.KtG(O.achieved=u)}),e.qZA()()}if(2&v){const m=e.oxw();e.xp6(2),e.Q6J("ngModel",m.achieved)}}function M(v,k){if(1&v){const m=e.EpF();e.TgZ(0,"div",21),e._UZ(1,"input-label",22),e.TgZ(2,"textarea",23),e.NdJ("ngModelChange",function(u){e.CHM(m);const O=e.oxw();return e.KtG(O.rateReason=u)}),e.qZA()()}if(2&v){const m=e.oxw();e.xp6(1),e.s9C("key",6==m.data.taskType?"comment":"rate_reason"),e.xp6(1),e.Q6J("ngModel",m.rateReason)}}let y=(()=>{class v{constructor(m,A,u,O,E){this.data=m,this.service=A,this.dialog=u,this.alert=O,this.sessionService=E,this.rated=!1,this.rate=0,this.rateReason="",this.achieved=0,console.log(this.data)}ratedFun(){this.rated=!0,this.rateReason=""}submit(){let m;this.data?.isSession?(m={sessionAttendeeId:this.data.session.id,rateReason:this.rateReason,rateValue:this.rate},this.sessionService.rateSession(m).subscribe(A=>{this.dialog.closeAll(),this.sessionService.hasChanged.next(!0),this.alert.showAlert("session_updated")})):(m={id:this.data.id,rateReason:this.rateReason,rate:this.rate,achived:this.achieved},this.service.addRate(m).subscribe(A=>{A.success&&(this.dialog.closeAll(),this.service.hasChanged.next(!0),this.alert.showAlert("task_updated"))}))}static{this.\u0275fac=function(A){return new(A||v)(e.Y36(n.WI),e.Y36(l.i),e.Y36(n.uw),e.Y36(g.c),e.Y36(c.f))}}static{this.\u0275cmp=e.Xpm({type:v,selectors:[["rate-form"]],standalone:!0,features:[e.jDz],decls:19,vars:15,consts:[[1,"add-rate","dir"],[1,"black","text-center"],["class","target text-center pt-2 flex aic jcc",4,"ngIf"],["mat-dialog-content",""],[1,"flex-center","mt-1"],["id","rate",3,"ngModel","change","ngModelChange"],["class","mb-2 text-center fs-14",4,"ngIf"],["class","mb-2",4,"ngIf"],["class","reason",4,"ngIf"],["mat-dialog-actions","",1,"mt-50"],[1,"flex","aic","gap-x-2","w-100"],["mat-dialog-close","","mat-raised-button","",1,"flex-50","w-100","dark-color","rounded","cancel-btn"],["mat-raised-button","","color","primary",1,"flex-50","w-100","rounded",3,"disabled","click"],[1,"target","text-center","pt-2","flex","aic","jcc"],[1,"bg-gray","py-75","px-2","w-19r","rounded"],[1,"fs-18"],[1,"fs-22","bold","primary",2,"margin-top","-5px"],[1,"mb-2","text-center","fs-14"],[1,"mb-2"],["key","achieved"],["type","number","min","1",1,"input",3,"ngModel","ngModelChange"],[1,"reason"],[3,"key"],["rows","3",1,"input","mb-1",3,"ngModel","ngModelChange"]],template:function(A,u){1&A&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,r,8,6,"div",2),e.TgZ(5,"div",3)(6,"div",4)(7,"ngx-star-rating",5),e.NdJ("change",function(){return u.ratedFun()})("ngModelChange",function(E){return u.rate=E}),e.qZA()(),e.YNc(8,_,4,6,"p",6),e.YNc(9,p,3,1,"div",7),e.YNc(10,M,3,2,"div",8),e.qZA(),e.TgZ(11,"div",9)(12,"div",10)(13,"button",11),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"button",12),e.NdJ("click",function(){return u.submit()}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()),2&A&&(e.xp6(2),e.Oqu(e.lcZ(3,9,"whats_your_rate")),e.xp6(2),e.Q6J("ngIf",u.data.target&&6==u.data.taskType),e.xp6(3),e.Q6J("ngModel",u.rate),e.xp6(1),e.Q6J("ngIf",u.rated),e.xp6(1),e.Q6J("ngIf",u.data.target&&6==u.data.taskType),e.xp6(1),e.Q6J("ngIf",u.rated&&u.rate<3||6==u.data.taskType),e.xp6(4),e.Oqu(e.lcZ(15,11,"cancel")),e.xp6(2),e.Q6J("disabled",!u.rate||u.rateReason.length<1&&u.rate<3||u.achieved<1&&6==u.data.taskType),e.xp6(1),e.Oqu(e.lcZ(18,13,"save")))},dependencies:[t.ez,t.O5,d.aw,d.X$,h.u5,h.Fj,h.wV,h.JJ,h.qQ,h.On,n.Is,n.ZT,n.xY,n.H8,Z.ot,Z.lW,I.m,b.nI,b.wK,x.i],encapsulation:2})}}return v})()},47919:(D,C,s)=>{s.d(C,{J:()=>e});var t=s(65879),d=s(96814),h=s(6311),n=s(89515),Z=s(49388);function b(l,g){if(1&l){const c=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(c);const _=t.oxw();return t.KtG(_.reassignFun())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&l&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"reassign")))}function I(l,g){if(1&l){const c=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(c);const _=t.oxw();return t.KtG(_.editTask())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&l&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"edit")))}function x(l,g){if(1&l){const c=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(c);const _=t.oxw();return t.KtG(_.deleteFun())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&l&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"delete")))}let e=(()=>{class l{constructor(){this.reassign=new t.vpe,this.cancel=new t.vpe,this.delete=new t.vpe,this.edit=new t.vpe,this.reassignVisible=!0,this.taskDetails=!1,this.isRepate=!1,this.dir=document.dir}ngOnInit(){}reassignFun(){this.reassign.emit()}cancelFun(){this.cancel.emit()}deleteFun(){this.delete.emit()}editTask(){this.edit.emit()}static{this.\u0275fac=function(r){return new(r||l)}}static{this.\u0275cmp=t.Xpm({type:l,selectors:[["task-actions"]],inputs:{reassignVisible:"reassignVisible",taskDetails:"taskDetails",taskState:"taskState",isRepate:"isRepate"},outputs:{reassign:"reassign",cancel:"cancel",delete:"delete",edit:"edit"},standalone:!0,features:[t.jDz],decls:11,vars:8,consts:[[1,"task-actions","line-height"],[1,"clickable-btn","line-height",3,"matMenuTriggerFor","dir"],[1,"bx","bx-dots-vertical-rounded","fs-25"],["xPosition","before"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"]],template:function(r,_){if(1&r&&(t.TgZ(0,"div",0)(1,"button",1),t._UZ(2,"i",2),t.qZA(),t.TgZ(3,"mat-menu",3,4),t.YNc(5,b,3,3,"button",5),t.YNc(6,I,3,3,"button",5),t.TgZ(7,"button",6),t.NdJ("click",function(){return _.cancelFun()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,x,3,3,"button",5),t.qZA()()),2&r){const p=t.MAs(4);t.xp6(1),t.Q6J("matMenuTriggerFor",p)("dir",_.dir),t.xp6(4),t.Q6J("ngIf",_.reassignVisible),t.xp6(1),t.Q6J("ngIf",!_.isRepate&&!_.taskDetails),t.xp6(2),t.Oqu(t.lcZ(9,6,"archive")),t.xp6(2),t.Q6J("ngIf",1==_.taskState||7==_.taskState||!_.taskState)}},dependencies:[d.ez,d.O5,h.Tx,h.VK,Z.Lv,h.OP,h.p6,n.aw,n.X$],styles:[".bx[_ngcontent-%COMP%]{width:15px!important}"]})}}return l})()},95982:(D,C,s)=>{s.d(C,{i:()=>c});var t=s(96814),d=s(20553),h=s(89515),n=s(65879);function Z(r,_){1&r&&n._UZ(0,"img",15)}function b(r,_){1&r&&n._UZ(0,"img",16)}function I(r,_){1&r&&n._UZ(0,"img",17)}function x(r,_){if(1&r&&(n.TgZ(0,"p"),n._uU(1),n.qZA()),2&r){const p=n.oxw(2).$implicit;n.xp6(1),n.Oqu(p.fileName)}}function e(r,_){if(1&r&&(n.TgZ(0,"p"),n._uU(1),n.ALo(2,"slice"),n.qZA()),2&r){const p=n.oxw(2).$implicit;n.xp6(1),n.hij("",n.Dn7(2,1,p.fileName,0,20),"...")}}function l(r,_){if(1&r&&(n.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),n.YNc(4,Z,1,0,"img",9),n.YNc(5,b,1,0,"img",10),n.YNc(6,I,1,0,"img",11),n.qZA(),n.YNc(7,x,2,1,"p",12),n.YNc(8,e,3,5,"p",12),n.qZA(),n.TgZ(9,"a",13),n._UZ(10,"img",14),n.qZA()()()),2&r){const p=n.oxw().$implicit,M=n.oxw();n.xp6(4),n.Q6J("ngIf",2==p.fileType),n.xp6(1),n.Q6J("ngIf",3==p.fileType||1==p.fileType||6==p.fileType),n.xp6(1),n.Q6J("ngIf",4==p.fileType),n.xp6(1),n.Q6J("ngIf",p.fileName.length<=20),n.xp6(1),n.Q6J("ngIf",p.fileName.length>20),n.xp6(1),n.Q6J("href",M.env+"/"+p.filePath,n.LSH)}}function g(r,_){if(1&r&&(n.ynx(0),n.YNc(1,l,11,6,"div",4),n.BQk()),2&r){const p=_.$implicit;n.xp6(1),n.Q6J("ngIf",5!=p.fileType)}}let c=(()=>{class r{constructor(){this.env=d.N.apiUrl}static{this.\u0275fac=function(M){return new(M||r)}}static{this.\u0275cmp=n.Xpm({type:r,selectors:[["task-attachments"]],inputs:{images:"images"},standalone:!0,features:[n.jDz],decls:6,vars:4,consts:[[1,"task-attachments"],[1,"fs-17","bold"],[1,"flex-grid"],[4,"ngFor","ngForOf"],["class","col-lg-6",4,"ngIf"],[1,"col-lg-6"],[1,"attachment-card","p-2","bg-gray","rounded","flex","jcsb","mt-1"],[1,"start","flex","aic"],[1,"img","mr-1"],["src","assets/images/attachments/image.svg","alt","image icon",4,"ngIf"],["src","assets/images/attachments/document.svg","alt","image icon",4,"ngIf"],["src","assets/images/attachments/video.svg","alt","image icon",4,"ngIf"],[4,"ngIf"],["download","","target","_blank",1,"end","pointer",3,"href"],["src","assets/images/attachments/download.svg","alt","image icon"],["src","assets/images/attachments/image.svg","alt","image icon"],["src","assets/images/attachments/document.svg","alt","image icon"],["src","assets/images/attachments/video.svg","alt","image icon"]],template:function(M,y){1&M&&(n.TgZ(0,"div",0)(1,"p",1),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",2),n.YNc(5,g,2,1,"ng-container",3),n.qZA()()),2&M&&(n.xp6(2),n.Oqu(n.lcZ(3,2,"attachments")),n.xp6(3),n.Q6J("ngForOf",y.images))},dependencies:[t.ez,t.sg,t.O5,t.OU,h.aw,h.X$],encapsulation:2})}}return r})()},68585:(D,C,s)=>{s.d(C,{h:()=>t});var t=function(d){return d[d.new=1]="new",d[d.completed=2]="completed",d[d.in_progress=3]="in_progress",d[d.canceled=6]="canceled",d[d.pending=7]="pending",d[d.rejected=8]="rejected",d}(t||{})},64379:(D,C,s)=>{s.d(C,{f:()=>I});var t=s(65879),d=s(65619),h=s(37398),n=s(20553),Z=s(69862),b=s(99758);let I=(()=>{class x{constructor(l,g){this.http=l,this.alert=g,this.sessionDetails=(0,t.tdS)({}),this.sessionId=new d.X(0),this.hasChanged=new d.X(!1),this.hasChanged.subscribe(c=>{c&&this.getSessionDetails().subscribe()})}getSessionDetails(){return this.http.get(`${n.N.publicUrl}SessionDate/GetSessionDateDetails?SessionDateId=${this.sessionId.value}`).pipe((0,h.U)(l=>{let g=localStorage.getItem("public-user-id")+"",c=l.data;c.isConsultant=c.consulaltantId==parseInt(g),c.isAttendee=c.attendeeId==parseInt(g),c.userName=c.isConsultant?c.attendeeUserName:c.consulaltantUserName,c.userImage=c.isConsultant?c.attendeeImage:c.consulaltantImage,c.userJobTitle=c.isConsultant?c.attendeeJobTitle:c.consulaltantJobTitle;let r=Math.abs(new Date(c.endDate).getTime()-(new Date).getTime()),_=Math.ceil(r/36e5);return c.raiseIssue=_<48&&(6==c.sessionAttendeesStatus||7==c.sessionAttendeesStatus),this.sessionDetails.set(c),l}))}startSession(){return this.http.put(`${n.N.publicUrl}SessionDate/Start`,{id:this.sessionId.value})}openSession(l){return this.http.get(`${n.N.publicUrl}Meet/JoinMeeting?sessionDateId=${l}`)}endSession(){return this.http.put(`${n.N.publicUrl}SessionDate/End`,{id:this.sessionId.value})}cancelSession(){return this.http.put(`${n.N.publicUrl}SessionDate/Cancel`,{id:this.sessionId.value})}rateSession(l){return this.http.post(`${n.N.publicUrl}SessionDate/Rate`,l)}raiseIssue(l){return this.http.post(`${n.N.supportUrl}guestOpenticket`,l)}getRecord(l){return this.http.get(`${n.N.publicUrl}Meet/GetMyRecording?id=${l}`)}approveRequest(l){return this.http.put(`${n.N.publicUrl}SessionDate/Approve`,{id:l}).pipe((0,h.U)(g=>(g.success&&this.alert.showAlert("session_approved"),g)))}rejectRequest(l){return this.http.put(`${n.N.publicUrl}SessionDate/Reject`,{id:l}).pipe((0,h.U)(g=>(g.success&&this.alert.showAlert("session_rejected"),g)))}getHistory(){return this.http.get(`${n.N.publicUrl}SessionHistory/Get?SessionAttendeeId=${this.sessionId.value}`).pipe((0,h.U)(l=>{if(l.success){const c=l.data.reduce((r,_)=>{const p=new Date(new Date(_.creationDate).setHours(0,0,0,0)).getTime();return r[p]||(r[p]=[]),r[p].push(_),r},{});return Object.keys(c).map(r=>({date:new Date(+r),messages:c[r]}))}return l}))}static{this.\u0275fac=function(g){return new(g||x)(t.LFG(Z.eN),t.LFG(b.c))}}static{this.\u0275prov=t.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})()},54234:(D,C,s)=>{s.d(C,{N:()=>W});var t=s(65879),d=s(96814),h=s(41614),n=s(89515),Z=s(28591),b=s(16862),I=s(17700);function x(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"div",2),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.addRate())}),t.TgZ(1,"div",3),t._UZ(2,"img",4),t.qZA(),t.TgZ(3,"p",5),t._uU(4),t.ALo(5,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,a.text))}}function e(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.addRate())}),t.TgZ(1,"p",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,1,a.text))}}let l=(()=>{class i{constructor(a){this.dialog=a,this.text="",this.resultMode=!1,this.rateAdded=new t.vpe}addRate(){this.dialog.open(b.$,{width:"400px",data:{id:this.details.taskId,taskType:this.details.taskGroupType,target:this.details.kpiTarget||0,isSession:!1}}).afterClosed().subscribe(()=>{this.rateAdded.emit(!0)})}static{this.\u0275fac=function(f){return new(f||i)(t.Y36(I.uw))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["add-rate"]],inputs:{details:"details",text:"text",resultMode:"resultMode"},outputs:{rateAdded:"rateAdded"},standalone:!0,features:[t.jDz],decls:2,vars:2,consts:[["class","add-rate flex aic pointer",3,"click",4,"ngIf"],["class"," flex aic jcc pointer rounded bg-primary shadow px-2 py-50",3,"click",4,"ngIf"],[1,"add-rate","flex","aic","pointer",3,"click"],[1,"img","flex-center"],["src","../../../../assets/images/icons/add-rate.svg","alt","add rate"],[1,"primary","ml-50","bold"],[1,"flex","aic","jcc","pointer","rounded","bg-primary","shadow","px-2","py-50",3,"click"],[1,"white"]],template:function(f,o){1&f&&(t.YNc(0,x,6,3,"div",0),t.YNc(1,e,4,3,"div",1)),2&f&&(t.Q6J("ngIf",!o.resultMode),t.xp6(1),t.Q6J("ngIf",o.resultMode))},dependencies:[d.ez,d.O5,n.aw,n.X$],encapsulation:2})}}return i})();var g=s(47919),c=s(98771),r=s(68671),_=s(64190),p=s(83318),M=s(99758),y=s(74104),v=s(57105),k=s(56223),m=s(7691),A=s(19300),u=s(9619),O=s(11383);function E(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"add-rate",24),t.NdJ("rateAdded",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.rateAdded.emit(!0))}),t.qZA()}if(2&i){const a=t.oxw();t.s9C("text",6==a.details.taskGroupType?"add_result":"add_rate"),t.Q6J("details",a.details)("resultMode",6==a.details.taskGroupType)}}function P(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"add-rate",24),t.NdJ("rateAdded",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.rateAdded.emit(!0))}),t.qZA()}if(2&i){const a=t.oxw();t.s9C("text",6==a.details.taskGroupType?"edit_result":"update_rate"),t.Q6J("details",a.details)("resultMode",6==a.details.taskGroupType)}}function N(i,T){if(1&i&&t._UZ(0,"rate",25),2&i){const a=t.oxw();t.Q6J("rate",a.details.rate)("displayNumber",!1)}}function J(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"i",26),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.close())}),t.qZA()}}function S(i,T){if(1&i){const a=t.EpF();t.TgZ(0,"task-actions",27),t.NdJ("cancel",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.cancel(o.details.taskId))})("delete",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.delete(o.details.taskId,o.details.taskGroupId))}),t.qZA()}if(2&i){const a=t.oxw();t.Q6J("taskDetails",!0)("taskState",a.details.taskStateId)("reassignVisible",!1)}}function w(i,T){if(1&i&&(t.ynx(0),t.TgZ(1,"div",33)(2,"div",34),t._uU(3),t.ALo(4,"arabicDate"),t.qZA(),t.TgZ(5,"div",35)(6,"div",36)(7,"p",37),t._uU(8),t.qZA(),t.TgZ(9,"p",38),t._uU(10),t.ALo(11,"arabicTime"),t.qZA()()()(),t.BQk()),2&i){const a=T.$implicit;t.xp6(3),t.hij(" ",t.lcZ(4,3,a.date)," "),t.xp6(5),t.Oqu(null==a?null:a.message),t.xp6(2),t.Oqu(t.lcZ(11,5,null==a?null:a.creationDate))}}function L(i,T){1&i&&(t.TgZ(0,"div",39),t._UZ(1,"not-found"),t.qZA())}function F(i,T){if(1&i&&(t.TgZ(0,"div",30),t.YNc(1,w,12,7,"ng-container",31),t.YNc(2,L,2,0,"div",32),t.qZA()),2&i){const a=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",a.history),t.xp6(1),t.Q6J("ngIf",0==(null==a.history?null:a.history.length))}}function Q(i,T){if(1&i&&(t.TgZ(0,"mat-tab",28),t.ALo(1,"translate"),t.YNc(2,F,3,2,"div",29),t.qZA()),2&i){const a=t.oxw();t.Q6J("label",t.lcZ(1,2,"activity")),t.xp6(2),t.Q6J("ngIf",a.history.length>0)}}function K(i,T){if(1&i&&(t.ynx(0),t.TgZ(1,"div",33)(2,"div",34),t._uU(3),t.ALo(4,"arabicDate"),t.qZA(),t.TgZ(5,"div",35)(6,"div",36)(7,"p",37),t._uU(8),t.qZA(),t.TgZ(9,"p",38),t._uU(10),t.ALo(11,"arabicTime"),t.qZA()()()(),t.BQk()),2&i){const a=T.$implicit;t.xp6(3),t.hij(" ",t.lcZ(4,3,a.date)," "),t.xp6(5),t.Oqu(null==a?null:a.message),t.xp6(2),t.Oqu(t.lcZ(11,5,null==a?null:a.creationDate))}}function Y(i,T){1&i&&(t.TgZ(0,"div",39),t._UZ(1,"not-found"),t.qZA())}function B(i,T){if(1&i&&(t.TgZ(0,"div",30),t.YNc(1,K,12,7,"ng-container",31),t.YNc(2,Y,2,0,"div",32),t.qZA()),2&i){const a=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",a.logs),t.xp6(1),t.Q6J("ngIf",0==(null==a.logs?null:a.logs.length))}}function q(i,T){if(1&i&&(t.TgZ(0,"mat-tab",28),t.ALo(1,"translate"),t.YNc(2,B,3,2,"div",29),t.qZA()),2&i){const a=t.oxw();t.Q6J("label",t.lcZ(1,2,"work_log")),t.xp6(2),t.Q6J("ngIf",a.logs.length>0)}}let W=(()=>{class i{ngOnChanges(a){a.details&&this.selected.setValue(0)}constructor(a){this.datePipe=a,this.withActions=!0,this.data=!0,this.rateAdded=new t.vpe,this.history=[],this.logs=[],this.taskType=(0,A.q)(m.U),this.historyIsOpen=!1,this.service=(0,t.f3M)(c.i),this.chatSer=(0,t.f3M)(r.a),this.router=(0,t.f3M)(_.F0),this.dialog=(0,t.f3M)(I.uw),this.alert=(0,t.f3M)(M.c),this.selected=new k.NI(0)}ngOnInit(){this.creator=this.details.taskGroupCreatorId==localStorage.getItem("id"),this.taskTypeValue=this.taskType.find(o=>o.value==this.details?.taskGroupType)?.name;let a=this.datePipe.transform(new Date(this.details.rateDate).setMinutes(new Date(this.details.rateDate).getMinutes()+10),"yyyy-MM-ddTHH:mm:ss");this.canUpdateRate=this.datePipe.transform(new Date,"yyyy-MM-ddTHH:mm:ss","UTC")<a}getHistory(){this.service.getTaskLog(this.taskId).subscribe(a=>{}),this.service.getTaskHistory(this.taskId).subscribe(a=>{this.history=a.data}),this.historyIsOpen=!1,setTimeout(()=>{this.historyIsOpen=!0},0)}chat(){this.service.getOrCreateChat(this.details.taskGroupId).subscribe(a=>{this.chatSer.roomId.next(a.data.taskGroupChatId),this.chatSer.getRoomChat(!0),this.router.navigate(["/chat"])})}cancel(a){this.dialog.open(p.v,{panelClass:"confirmation-dialog",autoFocus:!1,data:{message:"cancel_task",btn_name:"continue",classes:"bg-primary white"}}).afterClosed().subscribe(o=>{o&&this.service.cancelTask(a).subscribe(U=>{U.success&&(this.service.hasChanged.next(!0),this.alert.showAlert("task_canceled"))})})}delete(a,f){this.dialog.open(p.v,{panelClass:"confirmation-dialog",autoFocus:!1,data:{message:"delete_task",btn_name:"delete",classes:"bg-primary white"}}).afterClosed().subscribe(U=>{U&&this.service.deleteTask({taskId:a,taskGroupId:f}).subscribe(R=>{R.success&&(this.alert.showAlert("task_deleted"),this.router.navigate(["/tasks/sent"]))})})}close(){this.dialog.closeAll()}static{this.\u0275fac=function(f){return new(f||i)(t.Y36(d.uU))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["top-section"]],inputs:{details:"details",withActions:"withActions",data:"data",taskId:"taskId"},outputs:{rateAdded:"rateAdded"},standalone:!0,features:[t.TTD,t.jDz],decls:35,vars:18,consts:[[1,"top-section","px-2","py-1","border-bottom","flex","aic","jcsb"],[1,"header","flex"],[1,"flex","aic","border","rounded","task-type"],[1,"inline-flex","aic","px-1"],[1,"bx","bx-radio-circle-marked","mr-25","fs-18","text-center","mt-25"],[1,"fs-12"],[1,"flex","aic","border-start"],[1,"fs-12","px-1"],[1,"fs-17","bold","ml-2"],[1,"flex","aic","gap-x-2"],[3,"details","resultMode","text","rateAdded",4,"ngIf"],[1,"rated","relative"],["size","fs-23",3,"rate","displayNumber",4,"ngIf"],[1,"rate-reason","shadow","p-1","rounded","border","bg-white"],[1,"img","clickable-btn",3,"click"],["src","assets/images/icons/history.svg","alt","history icon","width","20",1,"convert-image-color"],["class","bx bx-x fs-25 pointer",3,"click",4,"ngIf"],[3,"taskDetails","taskState","reassignVisible","cancel","delete",4,"ngIf"],[3,"open"],["header",""],["content",""],[1,"p-2","h-100"],["animationDuration","400ms",1,"h-100",3,"selectedIndex","selectedIndexChange"],["class","h-100",3,"label",4,"ngIf"],[3,"details","resultMode","text","rateAdded"],["size","fs-23",3,"rate","displayNumber"],[1,"bx","bx-x","fs-25","pointer",3,"click"],[3,"taskDetails","taskState","reassignVisible","cancel","delete"],[1,"h-100",3,"label"],["class","timeline ml-3 mb-4",4,"ngIf"],[1,"timeline","ml-3","mb-4"],[4,"ngFor","ngForOf"],["class","relative h-100",4,"ngIf"],[1,"history","relative"],[1,"date","mt-1","fs-15"],[1,"log","mt-1"],[1,"mb-2"],[1,"fs-12","simibold","mb-50"],[1,"muted","fs-12","simibold"],[1,"relative","h-100"]],template:function(f,o){1&f&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"i",4),t.TgZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"div",6)(9,"span",7),t._uU(10),t.qZA()()(),t.TgZ(11,"p",8),t._uU(12),t.qZA()(),t.TgZ(13,"div",9),t.YNc(14,E,1,3,"add-rate",10),t.YNc(15,P,1,3,"add-rate",10),t.TgZ(16,"div",11),t.YNc(17,N,1,2,"rate",12),t.TgZ(18,"div",13),t._uU(19),t.qZA()(),t.TgZ(20,"button",14),t.NdJ("click",function(){return o.getHistory()}),t._UZ(21,"img",15),t.qZA(),t.YNc(22,J,1,0,"i",16),t.YNc(23,S,1,3,"task-actions",17),t.qZA()(),t.TgZ(24,"info-sidebar",18),t.ynx(25,19),t.TgZ(26,"h2"),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.BQk(),t.ynx(29,20),t.TgZ(30,"div",21),t.ynx(31,20),t.TgZ(32,"mat-tab-group",22),t.NdJ("selectedIndexChange",function(R){return o.selected.setValue(R)}),t.YNc(33,Q,3,4,"mat-tab",23),t.YNc(34,q,3,4,"mat-tab",23),t.qZA(),t.BQk(),t.qZA(),t.BQk(),t.qZA()),2&f&&(t.xp6(6),t.hij(" ",t.lcZ(7,14,o.taskTypeValue)," "),t.xp6(4),t.Oqu(null==o.details?null:o.details.taskId),t.xp6(2),t.Oqu(o.details.title),t.xp6(2),t.Q6J("ngIf",!o.details.rate&&2==o.details.taskStateId&&o.creator),t.xp6(1),t.Q6J("ngIf",o.canUpdateRate&&2==o.details.taskStateId&&o.creator),t.xp6(2),t.Q6J("ngIf",o.details.rate),t.xp6(2),t.hij(" ",o.details.rateReason," "),t.xp6(3),t.Q6J("ngIf",o.data),t.xp6(1),t.Q6J("ngIf",o.creator&&(1==o.details.taskStateId||3==o.details.taskStateId||7==o.details.taskStateId)&&o.withActions),t.xp6(1),t.Q6J("open",o.historyIsOpen),t.xp6(3),t.Oqu(t.lcZ(28,16,"history")),t.xp6(5),t.Q6J("selectedIndex",o.selected.value),t.xp6(1),t.Q6J("ngIf",o.history.length>0),t.xp6(1),t.Q6J("ngIf",o.logs.length>0))},dependencies:[d.ez,d.sg,d.O5,h.K,n.aw,n.X$,Z.T,l,g.J,y.Nh,y.uX,y.SP,v.w,u.P,O.E],styles:['.rated[_ngcontent-%COMP%]{overflow:visible}.rated[_ngcontent-%COMP%]   .rate-reason[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 10px);inset-inline-start:0;width:25rem;visibility:hidden;opacity:0;z-index:9999;transition:all .2s ease-in-out}.rated[_ngcontent-%COMP%]:hover   .rate-reason[_ngcontent-%COMP%]{visibility:visible;opacity:1}.inline-flex[_ngcontent-%COMP%]{display:inline-flex}.border-start[_ngcontent-%COMP%]{border-inline-start:1px solid #e7e7e7!important}.timeline[_ngcontent-%COMP%]   .history[_ngcontent-%COMP%]:not(:last-of-type):before{content:"";position:absolute;height:calc(100% + 24px);top:12px;inset-inline-start:-20px;border-inline-start:1px dashed #ccc}.timeline[_ngcontent-%COMP%]   .history[_ngcontent-%COMP%]:after{content:"";position:absolute;height:10px;width:10px;background:var(--primary);border-radius:50%;top:12px;inset-inline-start:-24.5px}.timeline[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#c7c7cc}']})}}return i})()}}]);