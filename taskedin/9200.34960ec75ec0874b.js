"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[9200],{99200:(N,p,a)=>{a.r(p),a.d(p,{TasksComponent:()=>S});var l=a(96814),u=a(1428),d=a(32296),g=a(89515),m=a(824),T=a(9619),f=a(65668),k=a(57105),v=a(20400),h=a(7314),t=a(65879),x=a(84526),b=a(64190),C=a(17700),E=a(65648),y=a(24110);function O(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2),r=i.$implicit,o=i.index,_=t.oxw(2);return t.KtG(_.expand(r.id,o))}),t._UZ(1,"i",24),t.qZA()}if(2&n){const e=t.oxw(2).$implicit;t.Q6J("disabled",e.disabled)}}function M(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2),r=i.$implicit,o=i.index,_=t.oxw(2);return t.KtG(_.collapse(r.depthLevel,o))}),t._UZ(1,"i",26),t.qZA()}}function P(n,c){if(1&n&&(t.TgZ(0,"div",20),t.YNc(1,O,2,1,"button",21),t.YNc(2,M,2,0,"button",22),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.expand),t.xp6(1),t.Q6J("ngIf",!e.expand)}}function D(n,c){1&n&&t._UZ(0,"div",27)}function I(n,c){1&n&&t._UZ(0,"div",28)}function Z(n,c){1&n&&t._UZ(0,"div",29)}const A=function(n){return{"margin-inline-start":n}};function U(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"div",9),t.YNc(2,P,3,2,"div",10),t.qZA(),t.TgZ(3,"div",11),t.NdJ("click",function(){const r=t.CHM(e).$implicit,o=t.oxw(2);return o.selectedTask=r,t.KtG(o.openSidebar())}),t.TgZ(4,"div",12),t._uU(5),t.qZA(),t.TgZ(6,"div",13)(7,"p",14),t._uU(8),t.ALo(9,"arabicDate"),t.ALo(10,"arabicDate"),t.qZA(),t.TgZ(11,"button",15),t.NdJ("click",function(i){const r=t.CHM(e),o=r.$implicit,_=r.index,Y=t.oxw(2);return i.stopImmediatePropagation(),t.KtG(Y.createTask(o.id,_,o.title))}),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",16),t.YNc(15,D,1,0,"div",17),t.YNc(16,I,1,0,"div",18),t.YNc(17,Z,1,0,"div",19),t.qZA()()()}if(2&n){const e=c.$implicit;t.Q6J("ngStyle",t.VKq(15,A,"5rem"!=e.margin&&e.margin)),t.xp6(2),t.Q6J("ngIf",e.haveSubTasks),t.xp6(3),t.Oqu(e.title),t.xp6(3),t.AsE("",t.lcZ(9,9,e.startDate)," - ",t.lcZ(10,11,e.endDate),""),t.xp6(4),t.Oqu(t.lcZ(13,13,"add_task")),t.xp6(3),t.Q6J("ngIf",1==e.taskGroupStateType),t.xp6(1),t.Q6J("ngIf",2==e.taskGroupStateType),t.xp6(1),t.Q6J("ngIf",3==e.taskGroupStateType)}}function K(n,c){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"h2",4),t._uU(3),t.qZA(),t.TgZ(4,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.createMainTask())}),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"div",6),t.YNc(8,U,18,17,"div",7),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.projectTitle),t.xp6(2),t.Oqu(t.lcZ(6,3,"create_task")),t.xp6(3),t.Q6J("ngForOf",e.hierarchy)}}function L(n,c){1&n&&t._UZ(0,"loading")}function J(n,c){1&n&&t._UZ(0,"not-found")}function B(n,c){if(1&n&&t._UZ(0,"task-group-details",30),2&n){const e=t.oxw();t.Q6J("open",e.open)("task",e.selectedTask)("isProject",!0)("reporters",e.reporters)}}let S=(()=>{class n{constructor(e,s,i,r,o,_){this.service=e,this.route=s,this.dialog=i,this.elm=r,this.taskGroupDetailsSer=o,this.globalSer=_,this.projectTitle="",this.hierarchy=[],this.loading=!0,this.assignees=[],this.reporters=[],this.open=!1}ngOnInit(){this.service.hierarchy.subscribe(e=>{this.hierarchy=e,this.projectTitle=e[0]?.projectTitle}),this.id=this.route.snapshot.params.id,this.getHierarchy()}expand(e,s){this.hierarchy[s].disabled=!0,this.service.getHierarchy(this.id,e,s).subscribe(i=>{this.hierarchy[s].disabled=!1})}collapse(e,s){this.hierarchy[s].expand=!0;let i=this.hierarchy.length;this.hierarchy=this.hierarchy.filter((r,o)=>!(o>s&&o<i)||r.depthLevel<=e&&(i=o,!0)),this.service.hierarchy.next(this.hierarchy)}getHierarchy(){this.loading=!0,this.service.getHierarchy(this.id).subscribe(e=>{this.loading=!1,e.length>0&&setTimeout(()=>{let s=this.elm.nativeElement.querySelector(".hierarchy .tasks"),i=this.elm.nativeElement.querySelector(".hierarchy .top-section");s.style.height=`calc(100% - ${i.offsetHeight}px)`},100)})}createTask(e,s,i){this.dialog.open(h.T,{disableClose:!0,panelClass:"create-task-dialog",data:{projectId:this.id,parentTaskGroupId:e,isSubTask:!0,taskTitle:i,index:s}})}createMainTask(){this.dialog.open(h.T,{disableClose:!0,panelClass:"create-task-dialog",data:{projectId:this.id,mainTask:!0}})}openSidebar(){this.open=!1,setTimeout(()=>{this.open=!0},0),this.taskGroupDetailsSer.getReporters(this.selectedTask?.id).subscribe(e=>{this.reporters=e.data.items})}ngOnDestroy(){this.service.hierarchy.next([])}static{this.\u0275fac=function(s){return new(s||n)(t.Y36(x.Y),t.Y36(b.gz),t.Y36(C.uw),t.Y36(t.SBq),t.Y36(E.Q),t.Y36(y.U))}}static{this.\u0275cmp=t.Xpm({type:n,selectors:[["tasks"]],standalone:!0,features:[t.jDz],decls:6,vars:4,consts:[[1,"hierarchy","relative","h-100"],[4,"ngIf"],[3,"open","task","isProject","reporters",4,"ngIf"],[1,"top-section","border-bottom","py-2","px-3","flex","aic","jcsb"],[1,"title"],["mat-raised-button","","color","primary",3,"click"],["magicScroll","",1,"tasks","py-3"],["class","task flex aic",3,"ngStyle",4,"ngFor","ngForOf"],[1,"task","flex","aic",3,"ngStyle"],[1,"actions","flex-10"],["class","buttons",4,"ngIf"],[1,"card","pointer","relative","rounded","bg-gray","py-1","px-2","flex-auto",3,"click"],[1,"task-title","primary"],[1,"date","flex","aic","jcsb","w-100","mt-50"],[1,"fs-12"],[1,"clickable-btn","bg-primary","white","rounded","px-1","pt-50","pb-50",3,"click"],[1,"task-state"],["class","w-100 h-100 bg-success",4,"ngIf"],["class","w-100 h-100 bg-archived",4,"ngIf"],["class","w-100 h-100 bg-danger",4,"ngIf"],[1,"buttons"],["class","expand clickable-btn px-75 pt-75 pb-75 flex-center rounded-50 bg-primary white",3,"disabled","click",4,"ngIf"],["class","collapse clickable-btn px-75 pt-75 pb-75 flex-center rounded-50 bg-primary white",3,"click",4,"ngIf"],[1,"expand","clickable-btn","px-75","pt-75","pb-75","flex-center","rounded-50","bg-primary","white",3,"disabled","click"],[1,"bx","bx-plus","fs-20"],[1,"collapse","clickable-btn","px-75","pt-75","pb-75","flex-center","rounded-50","bg-primary","white",3,"click"],[1,"bx","bx-minus","fs-20"],[1,"w-100","h-100","bg-success"],[1,"w-100","h-100","bg-archived"],[1,"w-100","h-100","bg-danger"],[3,"open","task","isProject","reporters"]],template:function(s,i){1&s&&(t.TgZ(0,"layout")(1,"div",0),t.YNc(2,K,9,5,"ng-container",1),t.YNc(3,L,1,0,"loading",1),t.YNc(4,J,1,0,"not-found",1),t.qZA()(),t.YNc(5,B,1,4,"task-group-details",2)),2&s&&(t.xp6(2),t.Q6J("ngIf",!i.loading&&i.hierarchy.length>0),t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(1),t.Q6J("ngIf",0==i.hierarchy.length&&!i.loading),t.xp6(1),t.Q6J("ngIf",i.open))},dependencies:[l.ez,l.sg,l.O5,l.PC,u.$,d.ot,d.lW,g.aw,g.X$,m.h,T.P,f.N,k.w,v.t],styles:[".tasks[_ngcontent-%COMP%]{height:calc(100% - 7rem)}.tasks[_ngcontent-%COMP%] > .task[_ngcontent-%COMP%]{margin-inline-start:4rem}.task[_ngcontent-%COMP%]{width:50rem}.task[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:2rem}.task-state[_ngcontent-%COMP%]{position:absolute;top:0;inset-inline-start:0;width:2px;height:100%}"]})}}return n})()}}]);