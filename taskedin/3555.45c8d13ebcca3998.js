"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[3555],{38140:(N,x,n)=>{n.d(x,{Y:()=>J});var t=n(65879),h=n(96814),v=n(89515),D=n(824),O=n(52081),c=n(56223),C=n(76472),_=n(3131);function b(s,p){if(1&s&&(t.TgZ(0,"p",10),t._uU(1),t.ALo(2,"arabicNumbers"),t.ALo(3,"translate"),t.qZA()),2&s){const r=t.oxw();t.xp6(1),t.Oqu(null!=r.meta&&r.meta.pageSize?t.lcZ(2,1,null==r.meta?null:r.meta.pageSize):t.lcZ(3,3,"unlimited"))}}function E(s,p){if(1&s){const r=t.EpF();t.TgZ(0,"input",11),t.NdJ("ngModelChange",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.limit=a)})("ngModelChange",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.changeLimit())}),t.qZA()}if(2&s){const r=t.oxw();t.Q6J("ngModel",r.limit)}}function Z(s,p){1&s&&(t.TgZ(0,"p",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"record")))}function A(s,p){if(1&s){const r=t.EpF();t.TgZ(0,"pagination-controls",13),t.NdJ("pageChange",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.pageChanged(a))}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.qZA()}2&s&&t.Q6J("maxSize",7)("directionLinks",!0)("previousLabel",t.lcZ(1,4,"previous"))("nextLabel",t.lcZ(2,6,"next"))}const P=[[["","filters",""]],[["","content",""]]],U=function(s,p){return{height:s,"max-width":p}},M=["[filters]","[content]"];let J=(()=>{class s{constructor(){this.pageChange=new t.vpe,this.limitChanged=new t.vpe,this.hasTitle=!1,this.admin=!1,this.limit=15,this.hasCard=!1,this.extraHeight=0,this.service=(0,t.f3M)(_.P)}changeLimit(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.limit<1&&(this.limit=15),this.limitChanged.emit(this.limit)},500)}pageChanged(r){this.pageChange.emit(r)}static{this.\u0275fac=function(m){return new(m||s)}}static{this.\u0275cmp=t.Xpm({type:s,selectors:[["layout-with-filters"]],inputs:{meta:"meta",hasTitle:"hasTitle",admin:"admin",limit:"limit",hasCard:"hasCard",extraHeight:"extraHeight"},outputs:{pageChange:"pageChange",limitChanged:"limitChanged"},standalone:!0,features:[t.jDz],ngContentSelectors:M,decls:21,vars:20,consts:[[1,"layout-with-filters","w-100","rounded","bg-white","border",3,"ngStyle"],[1,"filters","border-bottom","px-1","pb-1","pt-25"],["magicScroll","",1,"content","relative"],[1,"pagination-content","flex","aic","jcsr","py-1","bg-white","border-top"],[1,"flex","aic"],["class","ml-75 primary",4,"ngIf"],["type","number","class","input ml-75 limit text-center","min","1",3,"ngModel","ngModelChange",4,"ngIf"],["class","ml-50 primary",4,"ngIf"],[3,"maxSize","directionLinks","previousLabel","nextLabel","pageChange",4,"ngIf"],[1,"primary"],[1,"ml-75","primary"],["type","number","min","1",1,"input","ml-75","limit","text-center",3,"ngModel","ngModelChange"],[1,"ml-50","primary"],[3,"maxSize","directionLinks","previousLabel","nextLabel","pageChange"]],template:function(m,a){1&m&&(t.F$t(P),t.TgZ(0,"div",0)(1,"div",1),t.Hsn(2),t.qZA(),t.TgZ(3,"div",2),t.Hsn(4,1),t.qZA(),t.TgZ(5,"div",3)(6,"div",4)(7,"p"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,b,4,5,"p",5),t.YNc(11,E,1,1,"input",6),t.YNc(12,Z,3,3,"p",7),t.qZA(),t.YNc(13,A,3,8,"pagination-controls",8),t.TgZ(14,"p"),t._uU(15),t.ALo(16,"translate"),t.TgZ(17,"span",9),t._uU(18),t.ALo(19,"arabicNumbers"),t.ALo(20,"translate"),t.qZA()()()()),2&m&&(t.Q6J("ngStyle",t.WLB(17,U,a.hasTitle?"calc(100vh - 14.5rem)":a.hasCard?"calc(100vh - 27.7rem)":"calc(100vh - 11rem)",a.service.withSubMenu.value?"calc(100vw - 277px)":"calc(100vw - 92px)")),t.xp6(8),t.hij("",t.lcZ(9,9,"pagination_per_page")," "),t.xp6(2),t.Q6J("ngIf",!a.admin),t.xp6(1),t.Q6J("ngIf",a.admin),t.xp6(1),t.Q6J("ngIf",null==a.meta?null:a.meta.pageSize),t.xp6(1),t.Q6J("ngIf",(null==a.meta?null:a.meta.totalItems)>15),t.xp6(2),t.hij("",t.lcZ(16,11,"pagination_total_records")," "),t.xp6(3),t.AsE("",t.lcZ(19,13,null==a.meta?null:a.meta.totalItems)," ",t.lcZ(20,15,"record"),""))},dependencies:[h.ez,h.O5,h.PC,v.aw,v.X$,D.h,O.m,c.u5,c.Fj,c.wV,c.JJ,c.qQ,c.On,C.JX,C.LS],styles:[".layout-with-filters[_ngcontent-%COMP%]{overflow:hidden;box-shadow:0 1px 38px #0000001a,0 2px 4px -1px #0000000f}.layout-with-filters[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{z-index:999}.layout-with-filters[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:calc(100% - 137px)}.layout-with-filters[_ngcontent-%COMP%]   .pagination-content[_ngcontent-%COMP%]{height:58px}.limit[_ngcontent-%COMP%]{width:5rem;padding:1.1rem .5rem}"]})}}return s})()},73555:(N,x,n)=>{n.r(x),n.d(x,{TeamTimesheetComponent:()=>R});var t=n(65879),h=n(96814),v=n(52081),D=n(38140),O=n(65668),c=n(76472),C=n(57105),_=n(89515),b=n(83620),E=n(94664),Z=n(37398),A=n(65619),P=n(34673),U=n(20553),M=n(38826),J=n(69862);let s=(()=>{class i extends P.q{constructor(e){super(),this.http=e,this.timesheet$=this.hasChanged.pipe((0,b.b)(400),(0,E.w)(()=>this.getTeamTimesheet().pipe((0,Z.U)(o=>o)))),this.startDate=new A.X(this.getFirstDayOfMonth((new Date).getFullYear(),(new Date).getMonth())),this.endDate=new A.X(new Date)}getTeamTimesheet(){this.loading.next(!0);let e=new URL(`${U.N.apiUrl}api/TimeSheet/GetTeamTimeSheet?DateFrom=${(0,M.r)(this.startDate.value)||""}&DateTo=${(0,M.r)(this.endDate.value)||""}`);return this.params(e),this.http.get(`${e}`).pipe((0,Z.U)(o=>(this.setMeta(o),this.loading.next(!1),o.data)))}getFirstDayOfMonth(e,o){return new Date(e,o,1)}static{this.\u0275fac=function(o){return new(o||i)(t.LFG(J.eN))}}static{this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var p=n(45843),r=n(56223),m=n(32296),a=n(38034),g=n(64170),y=n(23680),F=n(73445),S=n(64190),w=n(22950),L=n(11486);function Q(i,f){if(1&i){const e=t.EpF();t.TgZ(0,"tr",20),t.NdJ("click",function(){const T=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.getUserTimeSheet(T.userId))}),t.TgZ(1,"td",21)(2,"div",22),t._UZ(3,"user-image",23),t.TgZ(4,"div",24)(5,"p"),t._uU(6),t.qZA(),t.TgZ(7,"p",25),t._uU(8),t.qZA()()()(),t.TgZ(9,"td")(10,"div",26)(11,"div",27),t._uU(12),t.ALo(13,"arabicNumbers"),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div",28),t._uU(16,":"),t.qZA(),t.TgZ(17,"div",29),t._uU(18),t.ALo(19,"arabicNumbers"),t.ALo(20,"translate"),t.qZA()()(),t.TgZ(21,"td"),t._uU(22),t.ALo(23,"arabicNumbers"),t.ALo(24,"translate"),t.qZA()()}if(2&i){const e=f.$implicit,o=t.oxw(2);t.xp6(3),t.Q6J("img",e.userPic),t.xp6(3),t.Oqu(e.userName),t.xp6(2),t.Oqu(e.userJobTitle),t.xp6(4),t.AsE(" ",t.lcZ(13,9,o.Math.floor(e.totalHours||0))," ",t.lcZ(14,11,"h")," "),t.xp6(6),t.AsE(" ",t.lcZ(19,13,60*e.totalHours%60)," ",t.lcZ(20,15,"m")," "),t.xp6(4),t.AsE("",t.lcZ(23,17,o.Math.round(e.expectedHours||0))," ",t.lcZ(24,19,"h"),"")}}const B=function(i,f,e){return{itemsPerPage:i,currentPage:f,totalItems:e}};function W(i,f){if(1&i&&(t.TgZ(0,"tbody"),t.YNc(1,Q,25,21,"tr",19),t.ALo(2,"paginate"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,2,e.timesheet,t.kEZ(5,B,e.meta.pageSize,e.meta.currentPage,e.meta.totalItems)))("ngForTrackBy",e.trackBy)}}function K(i,f){1&i&&t._UZ(0,"not-found",30)}function z(i,f){1&i&&t._UZ(0,"loading")}const Y=function(i){return{"h-100":i}};let I,H=document.dir;I="rtl"===H?"ar-EG":"en-GB";let R=(()=>{class i{constructor(e){this.elm=e,this.service=(0,t.f3M)(s),this.timesheetSer=(0,t.f3M)(w.r),this.router=(0,t.f3M)(S.F0),this.timesheet=[],this.loading=!1,this.endDate=new Date,this.Math=Math}ngOnInit(){this.service.loading.subscribe(e=>this.loading=e),this.service.meta.subscribe(e=>this.meta=e),this.service.startDate.subscribe(e=>this.startDate=e),this.service.endDate.subscribe(e=>this.endDate=e),this.service.timesheet$.subscribe(e=>this.timesheet=e)}dateChanged(){this.service.startDate.next(this.startDate),this.service.endDate.next(this.endDate||new Date),this.service.hasChanged.next(!0)}getUserTimeSheet(e){this.timesheetSer.from.next(this.startDate),this.timesheetSer.to.next(this.endDate),this.router.navigate(["/hr/team-timesheet/"+e])}trackBy(e,o){return o.id}ngOnDestroy(){this.service.loading.next(!0)}exportToExcel(){let e=this.elm.nativeElement.querySelector("#team-timesheet");const o=L.P6.table_to_sheet(e),l=L.P6.book_new();L.P6.book_append_sheet(l,o,"Sheet1"),L.NC(l,"team-timesheet.xlsx")}static{this.\u0275fac=function(o){return new(o||i)(t.Y36(t.SBq))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["team-timesheet"]],standalone:!0,features:[t._Bn([{provide:y.Ad,useValue:I},{provide:y._A,useClass:F.t7,deps:[y.Ad,F.o8]},{provide:y.sG,useValue:F.$o}]),t.jDz],decls:39,vars:32,consts:[[3,"meta","pageChange"],["filters",""],[1,"date-picker","flex","aic","jcfe","pt-1","gap-x-1"],["appearance","fill",1,"example-form-field",3,"click"],[1,"fs-15"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["rangePicker",""],["mat-button","","matDateRangePickerCancel",""],["mat-raised-button","","color","primary","matDateRangePickerApply","",3,"click"],["mat-raised-button","",1,"bg-primary","white","export",3,"click"],["content",""],["id","team-timesheet",1,"table","w-100","relative",3,"ngClass"],[1,"bg-gray","border-bottom"],[1,"text-left","pl-5"],[4,"ngIf"],["class","a-center",4,"ngIf"],["class","border-bottom pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-bottom","pointer",3,"click"],[1,"pl-5"],[1,"flex","aic","gap-x-1"],[3,"img"],[1,"text-left"],[1,"muted"],[1,"flex-center"],[1,"hours"],[1,"mx-50"],[1,"minutes"],[1,"a-center"]],template:function(o,l){if(1&o){const T=t.EpF();t.TgZ(0,"layout-with-filters",0),t.NdJ("pageChange",function(d){return l.service.page.next(d),l.service.hasChanged.next(!0)}),t.ynx(1,1),t.TgZ(2,"div",2)(3,"mat-form-field",3),t.NdJ("click",function(){t.CHM(T);const d=t.MAs(12);return t.KtG(d.open())}),t.TgZ(4,"mat-label",4),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"mat-date-range-input",5)(8,"input",6),t.NdJ("ngModelChange",function(d){return l.startDate=d}),t.qZA(),t.TgZ(9,"input",7),t.NdJ("ngModelChange",function(d){return l.endDate=d}),t.qZA()(),t._UZ(10,"mat-datepicker-toggle",8),t.TgZ(11,"mat-date-range-picker",null,9)(13,"mat-date-range-picker-actions")(14,"button",10),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"button",11),t.NdJ("click",function(){return l.dateChanged()}),t._uU(18),t.ALo(19,"translate"),t.qZA()()()(),t.TgZ(20,"button",12),t.NdJ("click",function(){return l.exportToExcel()}),t._uU(21),t.ALo(22,"translate"),t.qZA()(),t.BQk(),t.ynx(23,13),t.TgZ(24,"table",14)(25,"thead",15)(26,"tr")(27,"th",16),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"th"),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.TgZ(33,"th"),t._uU(34),t.ALo(35,"translate"),t.qZA()()(),t.YNc(36,W,3,9,"tbody",17),t.YNc(37,K,1,0,"not-found",18),t.YNc(38,z,1,0,"loading",17),t.qZA(),t.BQk(),t.qZA()}if(2&o){const T=t.MAs(12);t.Q6J("meta",l.meta),t.xp6(5),t.Oqu(t.lcZ(6,16,"date_range")),t.xp6(2),t.Q6J("rangePicker",T),t.xp6(1),t.Q6J("ngModel",l.startDate),t.xp6(1),t.Q6J("ngModel",l.endDate),t.xp6(1),t.Q6J("for",T),t.xp6(5),t.Oqu(t.lcZ(16,18,"cancel")),t.xp6(3),t.hij(" ",t.lcZ(19,20,"apply")," "),t.xp6(3),t.Oqu(t.lcZ(22,22,"export")),t.xp6(3),t.Q6J("ngClass",t.VKq(30,Y,0==l.timesheet.length||l.loading)),t.xp6(4),t.Oqu(t.lcZ(29,24,"member")),t.xp6(3),t.Oqu(t.lcZ(32,26,"logged_time")),t.xp6(3),t.Oqu(t.lcZ(35,28,"required_time")),t.xp6(2),t.Q6J("ngIf",l.timesheet.length>0&&!l.loading),t.xp6(1),t.Q6J("ngIf",0==l.timesheet.length&&!l.loading),t.xp6(1),t.Q6J("ngIf",l.loading)}},dependencies:[h.ez,h.mk,h.sg,h.O5,v.m,D.Y,O.N,c.JX,c._s,C.w,_.aw,_.X$,p.l,r.u5,r.Fj,r.JJ,r.On,m.ot,m.lW,a.FA,a.nW,a.wx,a.zY,a.By,a._g,a.M5,a.dp,a.DK,g.lN,g.KE,g.hX,g.R9]})}}return i})()}}]);