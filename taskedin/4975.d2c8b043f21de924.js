"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[4975],{44975:(j,f,o)=>{o.r(f),o.d(f,{ShiftsComponent:()=>Y});var t=o(65879),d=o(96814),p=o(65668),u=o(76472),m=o(57105),g=o(89515),_=o(60081),l=o(17700),v=o(99758),C=o(11383),T=o(24971),x=o(83318),U=o(45843),Z=o(32296),A=o(42666),h=o(56223),y=o(49388);function O(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.removeUser(s.id))}),t._UZ(1,"i",19),t.qZA()}}function M(i,r){if(1&i&&(t.TgZ(0,"div",10)(1,"div",11)(2,"div",12),t._UZ(3,"user-image",13),t.TgZ(4,"div",14)(5,"div",15),t._uU(6),t.qZA(),t.TgZ(7,"div",16),t._uU(8),t.qZA()()(),t.YNc(9,O,2,0,"div",17),t.qZA()()),2&i){const e=r.$implicit,n=t.oxw(2);t.xp6(3),t.Q6J("img",null==e?null:e.imageUrl),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.jobTitle),t.xp6(1),t.Q6J("ngIf",!n.data.isDefault)}}function S(i,r){if(1&i&&(t.ynx(0),t.YNc(1,M,10,4,"div",9),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.users)}}function q(i,r){1&i&&t._UZ(0,"not-found")}function I(i,r){1&i&&t._UZ(0,"loading")}let k=(()=>{class i{constructor(e){this.data=e,this.service=(0,t.f3M)(_.U),this.dialog=(0,t.f3M)(l.uw),this.alert=(0,t.f3M)(v.c),this.users=[],this.originalUsers=[],this.loading=!1,this.searchQuery=""}filterUsers(){const e=this.searchQuery.toLowerCase().trim();console.log(e),this.users=""===e?[...this.originalUsers]:this.originalUsers.filter(n=>n.name?.toLowerCase().includes(e)||n.jobTitle?.toLowerCase().includes(e))}ngOnInit(){this.getUsers()}addUsers(){this.dialog.open(A.$,{panelClass:"select-users-dialog",data:{selectedUsers:[],selectedDepartments:[],multi:!0}}).afterClosed().subscribe(n=>{if(n?.changed&&(0!=n.users?.length||0!=n.selectedDepartments?.length)){let s={...0!=n.user?.length&&{usersId:n.users?.map(a=>a.id)},...0!=n.selectedDepartments?.length&&{departments:n.selectedDepartments},shiftId:this.data.id};this.service.addUsersToShift(s).subscribe(a=>{a.success&&(this.getUsers(),this.alert.showAlert("users_added_to_shift"))})}})}removeUser(e){this.dialog.open(x.v,{panelClass:"confirmation-dialog",data:{message:"remove_user",btn_name:"confirm",classes:"bg-danger white"}}).afterClosed().subscribe(s=>{s&&this.service.removeUserFromShift(this.data.id,e).subscribe(a=>{a.success&&(this.getUsers(),this.alert.showAlert("user_removed"))})})}getUsers(){this.loading=!0,this.service.getUsers(this.data.id).subscribe(e=>{this.users=e.data,this.originalUsers=e.data,this.loading=!1})}static{this.\u0275fac=function(n){return new(n||i)(t.Y36(l.WI))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["shift-users"]],standalone:!0,features:[t.jDz],decls:16,vars:13,consts:[["dir","auto",1,"shift-users"],[1,"flex","aic","jcsb","pb-1"],["type","text",1,"input","mx-2","mt-2","w-20r",3,"ngModel","placeholder","ngModelChange","input"],[1,"pt-2","px-2"],["mat-raised-button","","color","primary",3,"click"],["mat-dialog-content","",1,"relative"],[4,"ngIf"],["mat-dialog-actions","","align","end","dir","auto"],["mat-dialog-close","",1,"px-4","py-50","dark-color","clickable-btn","rounded","cancel-btn"],["class","border-bottom py-1",4,"ngFor","ngForOf"],[1,"border-bottom","py-1"],[1,"flex","jcsb","aic"],[1,"flex","aic","gap-x-1"],[3,"img"],[1,"info"],[1,"info-text"],[1,"info-text","muted","fs-14"],["class","end img pointer",3,"click",4,"ngIf"],[1,"end","img","pointer",3,"click"],[1,"bx","bx-trash","fs-25","danger","line-height"]],template:function(n,s){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"input",2),t.NdJ("ngModelChange",function(c){return s.searchQuery=c})("input",function(){return s.filterUsers()}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return s.addUsers()}),t._uU(6),t.ALo(7,"translate"),t.qZA()()(),t.TgZ(8,"div",5),t.YNc(9,S,2,1,"ng-container",6),t.YNc(10,q,1,0,"not-found",6),t.YNc(11,I,1,0,"loading",6),t.qZA(),t.TgZ(12,"div",7)(13,"button",8),t._uU(14),t.ALo(15,"translate"),t.qZA()()()),2&n&&(t.xp6(2),t.s9C("placeholder",t.lcZ(3,7,"search")),t.Q6J("ngModel",s.searchQuery),t.xp6(4),t.Oqu(t.lcZ(7,9,"add_users")),t.xp6(3),t.Q6J("ngIf",s.users.length>0&&!s.loading),t.xp6(1),t.Q6J("ngIf",s.users&&0==s.users.length&&!s.loading),t.xp6(1),t.Q6J("ngIf",s.loading),t.xp6(3),t.Oqu(t.lcZ(15,11,"close")))},dependencies:[d.ez,d.sg,d.O5,p.N,l.Is,l.ZT,l.xY,l.H8,y.Lv,m.w,g.aw,g.X$,U.l,Z.ot,Z.lW,h.u5,h.Fj,h.JJ,h.On]})}}return i})();var w=o(52081),b=o(10450);function J(i,r){1&i&&(t.TgZ(0,"div",10),t._UZ(1,"loading"),t.qZA())}function N(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",21),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.deleteShift(s))}),t._UZ(1,"i",25),t.qZA()}}function L(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr",17)(1,"td",18),t._uU(2),t.qZA(),t.TgZ(3,"td",19),t._uU(4),t.ALo(5,"arabicTime"),t.qZA(),t.TgZ(6,"td",19),t._uU(7),t.ALo(8,"arabicTime"),t.qZA(),t.TgZ(9,"td",19),t._uU(10),t.ALo(11,"arabicNumbers"),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"td",19),t._uU(14),t.qZA(),t.TgZ(15,"td",19),t._uU(16),t.ALo(17,"arabicNumbers"),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"td",19),t._uU(20),t.ALo(21,"arabicNumbers"),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"td",19)(24,"div",20)(25,"div",21),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.getUsers(a.id,a.isDefault))}),t._UZ(26,"img",22),t.qZA(),t.TgZ(27,"div",21),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.editShift(a.id))}),t._UZ(28,"img",23),t.qZA(),t.YNc(29,N,2,0,"div",24),t.qZA()()()}if(2&i){const e=r.$implicit;t.xp6(2),t.Oqu(e.shiftName),t.xp6(2),t.Oqu(t.lcZ(5,11,e.checkIn)),t.xp6(3),t.Oqu(t.lcZ(8,13,e.checkOut)),t.xp6(3),t.AsE("",t.lcZ(11,15,e.allowanceInMinutes)," ",t.lcZ(12,17,"min"),""),t.xp6(4),t.Oqu(e.weekEnds),t.xp6(2),t.AsE("",t.lcZ(17,19,e.requiredWorkingHoursDaily)," ",t.lcZ(18,21,"h"),""),t.xp6(4),t.AsE("",t.lcZ(21,23,e.requiredWorkingHoursMonthly)," ",t.lcZ(22,25,"h"),""),t.xp6(9),t.Q6J("ngIf",!e.isDefault)}}const P=function(i,r,e){return{itemsPerPage:i,currentPage:r,totalItems:e}};function Q(i,r){if(1&i&&(t.TgZ(0,"tbody"),t.YNc(1,L,30,27,"tr",16),t.ALo(2,"paginate"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,2,e.shifts,t.kEZ(5,P,e.meta.pageSize,e.meta.currentPage,e.meta.totalItems)))("ngForTrackBy",e.trackBy)}}function F(i,r){if(1&i&&(t.TgZ(0,"div",11)(1,"table",12)(2,"thead",13)(3,"tr")(4,"th",14),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th",14),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th",14),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",14),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"th",14),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"th",14),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"th",14),t._uU(23),t.ALo(24,"translate"),t.qZA(),t._UZ(25,"th",14),t.qZA()(),t.YNc(26,Q,3,9,"tbody",15),t.qZA()()),2&i){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,8,"shift_name_type")),t.xp6(3),t.Oqu(t.lcZ(9,10,"shift_start_time")),t.xp6(3),t.Oqu(t.lcZ(12,12,"shift_end_time")),t.xp6(3),t.Oqu(t.lcZ(15,14,"late_checkin_margin")),t.xp6(3),t.Oqu(t.lcZ(18,16,"weekend_days")),t.xp6(3),t.Oqu(t.lcZ(21,18,"daily_working_hours")),t.xp6(3),t.Oqu(t.lcZ(24,20,"monthly_working_hours")),t.xp6(3),t.Q6J("ngIf",e.shifts.length>0&&!e.loading)}}function D(i,r){1&i&&(t.TgZ(0,"div",26),t._UZ(1,"not-found"),t.qZA())}let Y=(()=>{class i{constructor(){this.service=(0,t.f3M)(_.U),this.dialog=(0,t.f3M)(l.uw),this.alert=(0,t.f3M)(v.c),this.shifts=[],this.loading=!0}ngOnInit(){this.service.loading.subscribe(e=>this.loading=e),this.service.meta.subscribe(e=>this.meta=e),this.service.shifts$.subscribe(e=>this.shifts=e)}getUsers(e,n){this.dialog.open(k,{panelClass:"shift-users-dialog",data:{id:e,isDefault:n}})}editShift(e){this.dialog.open(b.T,{disableClose:!0,width:"552px",data:{isEdit:!0,id:e}})}deleteShift(e){this.dialog.open(x.v,{panelClass:"confirmation-dialog",data:{message:"delete_shift",btn_name:"confirm",classes:"bg-danger white"}}).afterClosed().subscribe(s=>{s&&this.service.deleteShift(e.id).subscribe(a=>{a.success&&(this.dialog.closeAll(),this.service.hasChanged.next(!0),this.alert.showAlert("shift_deleted"))})})}trackBy(e,n){return n.id}ngOnDestroy(){this.service.loading.next(!0)}openDialog(){this.dialog.open(b.T,{disableClose:!0,width:"552px",data:{isEdit:!1}})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["shifts-config"]],standalone:!0,features:[t.jDz],decls:12,vars:7,consts:[[1,"py-1"],[1,"filters","flex-grid","mb-2","aie","jcsb","w-100","mx-0"],[1,"col-lg-3"],[3,"newSearch","valueChanged"],[1,"col-lg-3","text-right"],[1,"btn","rounded","bg-primary","white","py-75","px-1","fs-14",2,"display","inline-block",3,"click"],[1,"px-50"],["class","aic flex jcc py-5 h-50v",4,"ngIf"],["class","table-container mx-1",4,"ngIf"],["class","py-5 text-center",4,"ngIf"],[1,"aic","flex","jcc","py-5","h-50v"],[1,"table-container","mx-1"],[1,"w-100","rounded"],[1,"border-bottom","fs-12","simibold"],[1,"text-left","py-1"],[4,"ngIf"],["class","border-bottom",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-bottom"],[1,"text-left","simibold"],[1,"text-left"],[1,"flex","aic","gap-x-2"],[1,"img","pointer",3,"click"],["src","assets/images/icons/users.svg","alt","users icon"],["src","assets/images/icons/edit1.svg","alt","edit icon"],["class","img pointer",3,"click",4,"ngIf"],[1,"bx","bx-trash","danger","fs-30"],[1,"py-5","text-center"]],template:function(n,s){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"search",3),t.NdJ("valueChanged",function(c){return s.service.search.next(c),s.service.hasChanged.next(!0)}),t.qZA()(),t.TgZ(4,"div",4)(5,"a",5),t.NdJ("click",function(){return s.openDialog()}),t._uU(6),t.ALo(7,"translate"),t.qZA()()(),t.TgZ(8,"div",6),t.YNc(9,J,2,0,"div",7),t.YNc(10,F,27,22,"div",8),t.YNc(11,D,2,0,"div",9),t.qZA()()),2&n&&(t.xp6(3),t.Q6J("newSearch",!0),t.xp6(3),t.hij(" ",t.lcZ(7,5,"create_shift")," "),t.xp6(3),t.Q6J("ngIf",s.loading),t.xp6(1),t.Q6J("ngIf",s.shifts.length>0&&!s.loading),t.xp6(1),t.Q6J("ngIf",0==s.shifts.length&&!s.loading))},dependencies:[d.ez,d.sg,d.O5,p.N,u.JX,u._s,m.w,g.aw,g.X$,C.E,T.g,w.m],styles:["[_nghost-%COMP%]     .search, [_nghost-%COMP%]     .ng-select{width:100%}[_nghost-%COMP%]     label{font-size:11px}.table-container[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0}th[_ngcontent-%COMP%]{border:none;position:sticky;top:0;z-index:1}tbody[_ngcontent-%COMP%]{padding-bottom:5px}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-block:10px;padding-inline:15px;border:none;font-size:12px}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-inline:15px;border:none}tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.btn[_ngcontent-%COMP%]{display:inline-block;height:41.2px}.aie[_ngcontent-%COMP%]{align-items:end}.table-filter-content[_ngcontent-%COMP%]{height:calc(100vh - 110px)}.table-container[_ngcontent-%COMP%]{overflow:auto}.pagination-content[_ngcontent-%COMP%]{margin-top:-5px}"]})}}return i})()}}]);