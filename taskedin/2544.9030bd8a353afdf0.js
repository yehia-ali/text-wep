"use strict";(self.webpackChunktaskedin=self.webpackChunktaskedin||[]).push([[2544],{38140:(F,b,s)=>{s.d(b,{Y:()=>A});var t=s(65879),d=s(96814),v=s(89515),q=s(824),U=s(52081),_=s(56223),M=s(76472),h=s(3131);function C(p,f){if(1&p&&(t.TgZ(0,"p",10),t._uU(1),t.ALo(2,"arabicNumbers"),t.ALo(3,"translate"),t.qZA()),2&p){const c=t.oxw();t.xp6(1),t.Oqu(null!=c.meta&&c.meta.pageSize?t.lcZ(2,1,null==c.meta?null:c.meta.pageSize):t.lcZ(3,3,"unlimited"))}}function g(p,f){if(1&p){const c=t.EpF();t.TgZ(0,"input",11),t.NdJ("ngModelChange",function(r){t.CHM(c);const y=t.oxw();return t.KtG(y.limit=r)})("ngModelChange",function(){t.CHM(c);const r=t.oxw();return t.KtG(r.changeLimit())}),t.qZA()}if(2&p){const c=t.oxw();t.Q6J("ngModel",c.limit)}}function P(p,f){1&p&&(t.TgZ(0,"p",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"record")))}function L(p,f){if(1&p){const c=t.EpF();t.TgZ(0,"pagination-controls",13),t.NdJ("pageChange",function(r){t.CHM(c);const y=t.oxw();return t.KtG(y.pageChanged(r))}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.qZA()}2&p&&t.Q6J("maxSize",7)("directionLinks",!0)("previousLabel",t.lcZ(1,4,"previous"))("nextLabel",t.lcZ(2,6,"next"))}const w=[[["","filters",""]],[["","content",""]]],O=function(p,f){return{height:p,"max-width":f}},I=["[filters]","[content]"];let A=(()=>{class p{constructor(){this.pageChange=new t.vpe,this.limitChanged=new t.vpe,this.hasTitle=!1,this.admin=!1,this.limit=15,this.hasCard=!1,this.extraHeight=0,this.service=(0,t.f3M)(h.P)}changeLimit(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.limit<1&&(this.limit=15),this.limitChanged.emit(this.limit)},500)}pageChanged(c){this.pageChange.emit(c)}static{this.\u0275fac=function(x){return new(x||p)}}static{this.\u0275cmp=t.Xpm({type:p,selectors:[["layout-with-filters"]],inputs:{meta:"meta",hasTitle:"hasTitle",admin:"admin",limit:"limit",hasCard:"hasCard",extraHeight:"extraHeight"},outputs:{pageChange:"pageChange",limitChanged:"limitChanged"},standalone:!0,features:[t.jDz],ngContentSelectors:I,decls:21,vars:20,consts:[[1,"layout-with-filters","w-100","rounded","bg-white","border",3,"ngStyle"],[1,"filters","border-bottom","px-1","pb-1","pt-25"],["magicScroll","",1,"content","relative"],[1,"pagination-content","flex","aic","jcsr","py-1","bg-white","border-top"],[1,"flex","aic"],["class","ml-75 primary",4,"ngIf"],["type","number","class","input ml-75 limit text-center","min","1",3,"ngModel","ngModelChange",4,"ngIf"],["class","ml-50 primary",4,"ngIf"],[3,"maxSize","directionLinks","previousLabel","nextLabel","pageChange",4,"ngIf"],[1,"primary"],[1,"ml-75","primary"],["type","number","min","1",1,"input","ml-75","limit","text-center",3,"ngModel","ngModelChange"],[1,"ml-50","primary"],[3,"maxSize","directionLinks","previousLabel","nextLabel","pageChange"]],template:function(x,r){1&x&&(t.F$t(w),t.TgZ(0,"div",0)(1,"div",1),t.Hsn(2),t.qZA(),t.TgZ(3,"div",2),t.Hsn(4,1),t.qZA(),t.TgZ(5,"div",3)(6,"div",4)(7,"p"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,C,4,5,"p",5),t.YNc(11,g,1,1,"input",6),t.YNc(12,P,3,3,"p",7),t.qZA(),t.YNc(13,L,3,8,"pagination-controls",8),t.TgZ(14,"p"),t._uU(15),t.ALo(16,"translate"),t.TgZ(17,"span",9),t._uU(18),t.ALo(19,"arabicNumbers"),t.ALo(20,"translate"),t.qZA()()()()),2&x&&(t.Q6J("ngStyle",t.WLB(17,O,r.hasTitle?"calc(100vh - 14.5rem)":r.hasCard?"calc(100vh - 27.7rem)":"calc(100vh - 11rem)",r.service.withSubMenu.value?"calc(100vw - 277px)":"calc(100vw - 92px)")),t.xp6(8),t.hij("",t.lcZ(9,9,"pagination_per_page")," "),t.xp6(2),t.Q6J("ngIf",!r.admin),t.xp6(1),t.Q6J("ngIf",r.admin),t.xp6(1),t.Q6J("ngIf",null==r.meta?null:r.meta.pageSize),t.xp6(1),t.Q6J("ngIf",(null==r.meta?null:r.meta.totalItems)>15),t.xp6(2),t.hij("",t.lcZ(16,11,"pagination_total_records")," "),t.xp6(3),t.AsE("",t.lcZ(19,13,null==r.meta?null:r.meta.totalItems)," ",t.lcZ(20,15,"record"),""))},dependencies:[d.ez,d.O5,d.PC,v.aw,v.X$,q.h,U.m,_.u5,_.Fj,_.wV,_.JJ,_.qQ,_.On,M.JX,M.LS],styles:[".layout-with-filters[_ngcontent-%COMP%]{overflow:hidden;box-shadow:0 1px 38px #0000001a,0 2px 4px -1px #0000000f}.layout-with-filters[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{z-index:999}.layout-with-filters[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:calc(100% - 137px)}.layout-with-filters[_ngcontent-%COMP%]   .pagination-content[_ngcontent-%COMP%]{height:58px}.limit[_ngcontent-%COMP%]{width:5rem;padding:1.1rem .5rem}"]})}}return p})()},49939:(F,b,s)=>{s.d(b,{z:()=>f});var t=s(65879),d=s(96814),v=s(16676),U=s(65619),_=s(23680),M=s(73445),h=s(56223),C=s(38034),g=s(89515),P=s(2032),L=s(64170);function w(c,x){1&c&&(t.TgZ(0,"label",7),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&c&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"date")))}const O=function(c){return{"w-15r":c}};let A,I=document.dir;A="rtl"===I?"ar-EG":"en-GB";const p={parse:{dateInput:"MMMM/YYYY"},display:{dateInput:"MMMM/YYYY",monthYearLabel:"MMMM YYYY",dateA11yLabel:"MMMM YYYY",monthYearA11yLabel:"MMMM YYYY"}};let f=(()=>{class c{constructor(){this.displayLabel=!0,this.onChange=new t.vpe,this.date=new h.NI(v()),this.now=new Date}ngOnChanges(r){r.selectedDate&&this.date.setValue(v(r.selectedDate.currentValue))}ngOnInit(){this.selectedDate&&(this.selectedDate instanceof U.X?this.selectedDate.subscribe(r=>{r&&this.date.setValue(v(r))}):this.date.setValue(v(this.selectedDate)))}setMonthAndYear(r,y){const u=this.date.value;u.month(r.month()),u.year(r.year()),this.date.setValue(u);const Z=new Date(u._d).getFullYear(),T=(new Date(u._d).getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1});let D=new Date(u._d.getFullYear(),u._d.getMonth()+1,0).getDate();this.start_date_key?.next(`${Z}-${T}-01`),this.end_date_key?.next(`${Z}-${T}-${D}`),this.onChange.emit(u._d),y.close()}static{this.\u0275fac=function(y){return new(y||c)}}static{this.\u0275cmp=t.Xpm({type:c,selectors:[["month-filter"]],inputs:{start_date_key:"start_date_key",displayLabel:"displayLabel",end_date_key:"end_date_key",selectedDate:"selectedDate",max:"max",min:"min"},outputs:{onChange:"onChange"},standalone:!0,features:[t._Bn([{provide:_.Ad,useValue:A},{provide:_._A,useClass:M.t7,deps:[_.Ad,M.o8]},{provide:_.sG,useValue:p}]),t.TTD,t.jDz],decls:7,vars:9,consts:[[1,"start-date",3,"ngClass"],["class","fs-13",4,"ngIf"],[1,"flex","aic","relative",3,"click"],[1,"input",3,"formControl","matDatepicker","min","max"],["matSuffix","",1,"picker-icon",3,"for"],["startView","multi-year","panelClass","example-month-picker",3,"monthSelected"],["picker",""],[1,"fs-13"]],template:function(y,u){if(1&y){const Z=t.EpF();t.TgZ(0,"div",0),t.YNc(1,w,3,3,"label",1),t.TgZ(2,"div",2),t.NdJ("click",function(){t.CHM(Z);const D=t.MAs(6);return t.KtG(D.open())}),t._UZ(3,"input",3)(4,"mat-datepicker-toggle",4),t.TgZ(5,"mat-datepicker",5,6),t.NdJ("monthSelected",function(D){t.CHM(Z);const E=t.MAs(6);return t.KtG(u.setMonthAndYear(D,E))}),t.qZA()()()}if(2&y){const Z=t.MAs(6);t.Q6J("ngClass",t.VKq(7,O,u.displayLabel)),t.xp6(1),t.Q6J("ngIf",u.displayLabel),t.xp6(2),t.Q6J("formControl",u.date)("matDatepicker",Z)("min",u.min)("max",u.max),t.xp6(1),t.Q6J("for",Z)}},dependencies:[d.ez,d.mk,d.O5,C.FA,C.Mq,C.hl,C.nW,g.aw,g.X$,P.c,L.R9,h.UX,h.Fj,h.JJ,h.oH],styles:[".picker-icon[_ngcontent-%COMP%]{position:absolute;inset-inline-end:0}.clear[_ngcontent-%COMP%]{position:absolute;inset-inline-end:4rem;top:50%;transform:translateY(-50%);line-height:0}.example-month-picker[_ngcontent-%COMP%]   .mat-calendar-period-button[_ngcontent-%COMP%]{pointer-events:none}.example-month-picker[_ngcontent-%COMP%]   .mat-calendar-arrow[_ngcontent-%COMP%]{display:none}"]})}}return c})()},42544:(F,b,s)=>{s.r(b),s.d(b,{TeamPayslipComponent:()=>St});var t=s(65879),d=s(96814),v=s(38140),q=s(65668),U=s(76472),_=s(57105),M=s(24971),h=s(89515),C=s(45843),g=s(17700),P=s(19300),L=s(84076),w=s(21498),O=s(83620),I=s(94664),A=s(37398),p=s(65619),f=s(20553),c=s(34673),x=s(69862);let r=(()=>{class i extends c.q{constructor(e,a){super(),this.http=e,this.datePipe=a,this.list$=this.hasChanged.pipe((0,O.b)(400),(0,I.w)(()=>this.getTeamPayslip().pipe((0,A.U)(n=>n)))),this.selectedUsersToTakeAction=new p.X([]),this.startDate=this.datePipe.transform(new Date,"yyyy-MM-01"),this.endDate=this.datePipe.transform(new Date((new Date).getFullYear(),(new Date).getMonth()+1,0),"yyyy-MM-dd")}getTeamPayslip(){const e=new URL(`${f.N.apiUrl}api/Contract/GetPaySlipsForAdmin`);return e.searchParams.append("EmployeeName",this.search.value),e.searchParams.append("From",this.startDate),e.searchParams.append("To",this.endDate),this.params(e),this.loading.next(!0),this.http.get(`${e}`).pipe((0,A.U)(a=>(this.setMeta(a),this.loading.next(!1),a.data.items)))}generatePayslip(e){let a=new URL(`${f.N.apiUrl}api/Contract/GeneratePayslip`);return this.http.get(`${a}`,{params:e}).pipe((0,A.U)(n=>n))}submitPayslip(e){let a=new URL(`${f.N.apiUrl}api/Contract/SubmitPaySlip`);return this.http.post(`${a}`,e)}createMltiPayslips(e){return this.http.get(`${f.N.apiUrl}api/Contract/GenerateBulk`,{params:e})}updatePayslip(e){let a=new URL(`${f.N.apiUrl}api/Contract/UpdateStatus`);return this.selectedUsersToTakeAction.value.forEach(n=>{console.log(n),a.searchParams.append("PaySlipId",n.id)}),a.searchParams.append("paySlipStatus",e),this.http.get(`${a}`)}static{this.\u0275fac=function(a){return new(a||i)(t.LFG(x.eN),t.LFG(d.uU))}}static{this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var y=s(49388),u=s(56223),Z=s(10480),T=s(32296),D=s(82458),E=s(99758),H=s(2032),G=s(64170),R=s(38034),k=s(23680),$=s(52081),z=s(32801),V=s(53055),X=s(50690),Q=s(92596),J=s(73445),N=s(69323);const tt=["personalInfo"],et=["contractForm"];function at(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"app-img-title",10),t.NdJ("click",function(){const o=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.changeUser(o))}),t.qZA()}if(2&i){const e=l.$implicit;t.Q6J("imgSrc",e.imageUrl)("imgBorder","border border-2 border-danger")("matTooltip",e.name)("imgSize",50)}}function nt(i,l){if(1&i&&(t.TgZ(0,"div",8),t.YNc(1,at,1,4,"app-img-title",9),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.users)}}function it(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",17)(1,"contract-form",18,19),t.NdJ("contractCreated",function(n){t.CHM(e);const o=t.oxw(2);return t.KtG(o.contractCreated(n))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("normalComponent",!0)("employeeData",e.employeeData)("employeeId",e.userData.id)}}function st(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"p",13),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"personal-info",14,15),t.NdJ("employeeDataChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.employeeDataChange(n))}),t.qZA()(),t.YNc(7,it,3,3,"div",16),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,4,"personal_info")),t.xp6(2),t.Q6J("normalComponent",!1)("employeeId",e.userData.id),t.xp6(2),t.Q6J("ngIf",!e.hideContract)}}let Y,ot=document.dir;Y="rtl"===ot?"ar-EG":"en-GB";let lt=(()=>{class i{constructor(e,a,n,o){this.service=e,this.data=a,this.dialogRef=n,this.alert=o,this.loadingData=!1,this.users=[],this.contractCreatedSuccess=!1}ngOnInit(){this.users=this.data.users,this.userData=this.users[0],setTimeout(()=>{this.personalInfo?.form.markAllAsTouched(),this.contractForm?.form.markAllAsTouched(),this.contractForm?.formInsurance.markAllAsTouched()},500)}contractCreated(e){if(e)if(this.alert.showAlert("data_updated_successfully"),this.contractCreatedSuccess=!0,this.users.length>1){const a=this.users.findIndex(n=>n.id===this.userData.id);-1!==a&&this.users.splice(a,1),this.users.length>0&&(this.userData=this.users[0],this.loadingData=!0,setTimeout(()=>{this.loadingData=!1,this.personalInfo?.form.markAllAsTouched(),this.contractForm?.form.markAllAsTouched(),this.contractForm?.formInsurance.markAllAsTouched()},1e3))}else this.dialogRef.close(!0)}submit(){this.personalInfo&&(this.personalInfo.onSubmit(),this.personalInfo.employeeDataChange.subscribe(e=>{e&&(this.alert.showAlert("data_updated_successfully"),this.employeeData=e,this.contractForm.employeeData=this.employeeData)}))}employeeDataChange(e){e&&(this.employeeData=e,this.contractForm.employeeData=this.employeeData,this.contractForm.submit())}changeUser(e){this.userData=e,this.loadingData=!0,setTimeout(()=>{this.loadingData=!1},1e3)}static{this.\u0275fac=function(a){return new(a||i)(t.Y36(N.j),t.Y36(g.WI),t.Y36(g.so),t.Y36(E.c))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["all-user-info-dialog"]],viewQuery:function(a,n){if(1&a&&(t.Gf(tt,5),t.Gf(et,5)),2&a){let o;t.iGM(o=t.CRH())&&(n.personalInfo=o.first),t.iGM(o=t.CRH())&&(n.contractForm=o.first)}},standalone:!0,features:[t._Bn([{provide:k.Ad,useValue:Y},{provide:k._A,useClass:J.t7,deps:[k.Ad,J.o8]},{provide:k.sG,useValue:J.$o}]),t.jDz],decls:10,vars:10,consts:[[1,"dir","py-2","relative","all-user-info-dialog"],[1,"bx","bx-x","fs-25","pointer","absolute","close-btn","pr-2","pt-2",3,"click"],["class","px-2 flex aic gap-x-2",4,"ngIf"],[1,"flex","jcsb","aic","my-2","px-2","user-info"],[3,"userId","title","subTitle","imgSrc","imgSize"],["class","user-info-container",4,"ngIf"],[1,"text-right","px-2","pt-2"],[1,"btn","rounded","bg-primary","white","py-75","px-2","fs-14",3,"click"],[1,"px-2","flex","aic","gap-x-2"],["class","pointer",3,"imgSrc","imgBorder","matTooltip","imgSize","click",4,"ngFor","ngForOf"],[1,"pointer",3,"imgSrc","imgBorder","matTooltip","imgSize","click"],[1,"user-info-container"],[1,"personal-info"],[1,"fs-20","black","bold","px-3"],[3,"normalComponent","employeeId","employeeDataChange"],["personalInfo",""],["class","contracts",4,"ngIf"],[1,"contracts"],[3,"normalComponent","employeeData","employeeId","contractCreated"],["contractForm",""]],template:function(a,n){1&a&&(t.TgZ(0,"div",0)(1,"i",1),t.NdJ("click",function(){return n.dialogRef.close()}),t.qZA(),t.YNc(2,nt,2,1,"div",2),t.TgZ(3,"div",3),t._UZ(4,"app-img-title",4),t.qZA(),t.YNc(5,st,8,6,"div",5),t.TgZ(6,"div",6)(7,"button",7),t.NdJ("click",function(){return n.submit()}),t._uU(8),t.ALo(9,"translate"),t.qZA()()()),2&a&&(t.xp6(2),t.Q6J("ngIf",n.users.length>1),t.xp6(2),t.Q6J("userId",n.userData.id)("title",n.userData.name)("subTitle",n.userData.jobTitle)("imgSrc",n.userData.imageUrl)("imgSize",50),t.xp6(1),t.Q6J("ngIf",!n.loadingData),t.xp6(3),t.Oqu(t.lcZ(9,8,"save")))},dependencies:[d.ez,d.sg,d.O5,h.aw,h.X$,z.G,V.b,X.B,Q.AV,Q.gM],styles:[".close-btn{inset-inline-end:0;top:0}.user-info-container{max-height:70vh;overflow-y:auto}.all-user-info-dialog .create-task .mat-mdc-dialog-content{max-height:100%!important}.all-user-info-dialog .create-task .flex.aic.jcsb.px-3.pt-2{padding-top:0!important}.all-user-info-dialog .create-task .mat-mdc-dialog-actions{display:none!important}\n"],encapsulation:2})}}return i})();var rt=s(49939),ct=s(63934);function dt(i,l){1&i&&(t.TgZ(0,"h4",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"generate_payslip")))}function pt(i,l){if(1&i&&(t.TgZ(0,"div",31),t._UZ(1,"user-image",32),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("img",e.selectedUser.imageUrl)}}function ut(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.selectedUser=null)}),t._UZ(1,"i",34),t.qZA()}}function mt(i,l){1&i&&(t.ynx(0),t.TgZ(1,"p",28)(2,"span",35),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.BQk()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"contract_by_hour")))}const S=function(i,l){return{"badge-success":i,"badge-danger":l}};function gt(i,l){if(1&i&&(t.TgZ(0,"div",26),t._UZ(1,"img",36),t.TgZ(2,"p",28),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"span",37),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"translate"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(3),t.hij("",t.lcZ(4,3,"status_of_employment")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(9,S,e.selectedUser.isActivated,!e.selectedUser.isActivated)),t.xp6(1),t.Oqu(e.selectedUser.isActivated?t.lcZ(7,5,"active"):t.lcZ(8,7,"inactive"))}}function ht(i,l){if(1&i&&(t.TgZ(0,"div")(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19),t.YNc(5,pt,2,1,"div",20),t.TgZ(6,"div")(7,"p",21),t._uU(8),t.qZA(),t.TgZ(9,"p",22),t._uU(10),t.qZA()()(),t.TgZ(11,"div"),t.YNc(12,ut,2,0,"button",23),t.qZA()(),t.TgZ(13,"div",24)(14,"div",3)(15,"div",25)(16,"div",26),t._UZ(17,"img",27),t.TgZ(18,"p",28),t._uU(19),t.ALo(20,"translate"),t.ALo(21,"date"),t.qZA()()(),t.TgZ(22,"div",25),t.YNc(23,mt,5,3,"ng-container",29),t.YNc(24,gt,9,12,"ng-template",null,30,t.W1O),t.qZA()()()()()()),2&i){const e=t.MAs(25),a=t.oxw();t.xp6(5),t.Q6J("ngIf",!a.data.multi),t.xp6(3),t.Oqu(a.selectedUser.name),t.xp6(2),t.Oqu(a.selectedUser.jobTitle),t.xp6(2),t.Q6J("ngIf",!a.data.user),t.xp6(7),t.AsE("",t.lcZ(20,8,"joining_date")," ",t.xi3(21,10,a.joinDate,"dd/MM/yyyy"),""),t.xp6(4),t.Q6J("ngIf",null==a.details?null:a.details.isPerHour)("ngIfElse",e)}}function _t(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",38)(1,"div",39)(2,"select-user",40),t.NdJ("getSelectedUsers",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.getUser(n))}),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("multi",e.data.multi)}}function ft(i,l){1&i&&(t.ynx(0),t.TgZ(1,"p",28)(2,"span",35),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.BQk()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"contract_by_hour")))}function yt(i,l){if(1&i&&(t.TgZ(0,"div",26),t._UZ(1,"img",36),t.TgZ(2,"p",28),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"span",37),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"translate"),t.qZA()()()),2&i){const e=t.oxw().$implicit;t.xp6(3),t.hij("",t.lcZ(4,3,"status_of_employment")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(9,S,e.isActivated,!e.isActivated)),t.xp6(1),t.Oqu(e.isActivated?t.lcZ(7,5,"active"):t.lcZ(8,7,"inactive"))}}function xt(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"div",31),t._UZ(5,"user-image",32),t.qZA(),t.TgZ(6,"div")(7,"p",21),t._uU(8),t.qZA(),t.TgZ(9,"p",22),t._uU(10),t.qZA()()(),t.TgZ(11,"div")(12,"button",33),t.NdJ("click",function(){const o=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.removeUser(o))}),t._UZ(13,"i",34),t.qZA()()(),t.TgZ(14,"div",24)(15,"div",3)(16,"div",25)(17,"div",26),t._UZ(18,"img",27),t.TgZ(19,"p",28),t._uU(20),t.ALo(21,"translate"),t.ALo(22,"date"),t.qZA()()(),t.TgZ(23,"div",25),t.YNc(24,ft,5,3,"ng-container",29),t.YNc(25,yt,9,12,"ng-template",null,30,t.W1O),t.qZA()()()()()}if(2&i){const e=l.$implicit,a=t.MAs(26);t.xp6(5),t.Q6J("img",e.imageUrl),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.jobTitle),t.xp6(10),t.AsE("",t.lcZ(21,7,"joining_date")," ",t.xi3(22,9,e.creationDate,"dd/MM/yyyy"),""),t.xp6(4),t.Q6J("ngIf",null==e?null:e.isPerHour)("ngIfElse",a)}}const j=function(i,l){return{"col-lg-8":i,"col-lg-12":l}};function vt(i,l){if(1&i&&(t.TgZ(0,"div",4),t.YNc(1,xt,27,12,"div",41),t.qZA()),2&i){const e=t.oxw();t.Q6J("ngClass",t.WLB(2,j,!e.data.user,e.data.user)),t.xp6(1),t.Q6J("ngForOf",e.users)}}function Zt(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.month=null)}),t._UZ(1,"i",34),t.qZA()}}function Ct(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"month-filter",45),t.NdJ("onChange",function(n){t.CHM(e);const o=t.oxw();return o.setMonthAndYear(n),t.KtG(o.calcDetails())}),t.qZA()(),t.YNc(4,Zt,2,0,"button",23),t.qZA(),t.TgZ(5,"div",46)(6,"p",47),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"date"),t.ALo(10,"translate"),t.ALo(11,"date"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("max",e.now)("min",e.joinDate)("selectedDate",e.now)("displayLabel",!1),t.xp6(1),t.Q6J("ngIf",e.month),t.xp6(3),t.HOy("",t.lcZ(8,9,"from")," ",t.xi3(9,11,e.startDate,"dd/MM/yyyy")," ",t.lcZ(10,14,"to")," ",t.xi3(11,16,e.endDate,"dd/MM/yyyy"),"")}}function At(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",48)(1,"div",16)(2,"div",49)(3,"div",50)(4,"div",51),t._UZ(5,"img",52),t.TgZ(6,"p",28),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"div",53)(10,"input",54),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.monthlyWorkingHours=n)})("input",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.monthlyWorkingHoursChange())}),t.qZA(),t.TgZ(11,"span",55),t._uU(12),t.ALo(13,"translate"),t.qZA()()()(),t.TgZ(14,"div",56)(15,"div",57),t._UZ(16,"i",58),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"translate"),t.qZA()()()()()()}if(2&i){const e=t.oxw();t.xp6(7),t.hij("",t.lcZ(8,4,"monthly_working_hours")," "),t.xp6(3),t.Q6J("ngModel",e.monthlyWorkingHours),t.xp6(2),t.Oqu(t.lcZ(13,6,"hour")),t.xp6(6),t.Oqu(t.lcZ(19,8,"enter_the_number_of_hours_to_calculate_the_salary"))}}function Tt(i,l){if(1&i&&(t.ynx(0),t.TgZ(1,"div",69)(2,"p"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"arabicNumbers"),t.qZA()(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,2,"hourly_salary")),t.xp6(3),t.Oqu(t.lcZ(7,4,(null==e.details?null:e.details.hourlyRate)||0))}}function Mt(i,l){if(1&i&&(t.TgZ(0,"div",69)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"arabicNumbers"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"basic_salary")),t.xp6(3),t.Oqu(t.lcZ(6,4,(null==e.details?null:e.details.basic)||0))}}function Dt(i,l){if(1&i&&(t.TgZ(0,"span",74),t._uU(1),t.ALo(2,"arabicNumbers"),t.ALo(3,"translate"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE(" ( ",t.lcZ(2,2,null==e.details?null:e.details.manualPenalityDayCount)," ",t.lcZ(3,4,"days"),")")}}function bt(i,l){if(1&i&&(t.TgZ(0,"span",74),t._uU(1),t.ALo(2,"arabicNumbers"),t.ALo(3,"translate"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE(" ( ",t.lcZ(2,2,null==e.details?null:e.details.attendanceDeduction)," ",t.lcZ(3,4,"days"),")")}}function Ut(i,l){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",59)(2,"div",60)(3,"div",61)(4,"div",62)(5,"p",63),t._uU(6),t.ALo(7,"translate"),t._UZ(8,"img",64),t.qZA(),t.TgZ(9,"p",63),t._uU(10),t.ALo(11,"arabicNumbers"),t.qZA()(),t.TgZ(12,"div",65),t.YNc(13,Tt,8,6,"ng-container",29),t.YNc(14,Mt,7,6,"ng-template",null,66,t.W1O),t.TgZ(16,"div",67)(17,"p"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"p",68),t._uU(21),t.ALo(22,"arabicNumbers"),t.qZA()(),t.TgZ(23,"div",69)(24,"p"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"input",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.allowance=n)})("input",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.allowanceChange())}),t.qZA()(),t.TgZ(28,"div",67)(29,"p"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"p"),t._uU(33),t.ALo(34,"arabicNumbers"),t.qZA()(),t.TgZ(35,"div",67)(36,"p"),t._uU(37),t.ALo(38,"translate"),t.qZA(),t.TgZ(39,"p",71),t.YNc(40,Dt,4,6,"span",72),t._uU(41),t.ALo(42,"arabicNumbers"),t.qZA()(),t.TgZ(43,"div",67)(44,"p"),t._uU(45),t.ALo(46,"translate"),t.qZA(),t.TgZ(47,"p",71),t.YNc(48,bt,4,6,"span",72),t._uU(49),t.ALo(50,"arabicNumbers"),t.qZA()(),t.TgZ(51,"div",69)(52,"p"),t._uU(53),t.ALo(54,"translate"),t.qZA(),t.TgZ(55,"input",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.deduction=n)})("input",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deductionChange())}),t.qZA()()()(),t.TgZ(56,"div",73)(57,"div",62)(58,"p",15),t._uU(59),t.ALo(60,"translate"),t._UZ(61,"img",64),t.qZA(),t.TgZ(62,"p",15),t._uU(63),t.ALo(64,"arabicNumbers"),t.qZA()(),t.TgZ(65,"div",65)(66,"div",69)(67,"p"),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"p"),t._uU(71),t.ALo(72,"arabicNumbers"),t.qZA()(),t.TgZ(73,"div",67)(74,"p"),t._uU(75),t.ALo(76,"translate"),t.qZA(),t.TgZ(77,"p",68),t._uU(78),t.ALo(79,"arabicNumbers"),t.qZA()(),t.TgZ(80,"div",67)(81,"p"),t._uU(82),t.ALo(83,"translate"),t.qZA(),t.TgZ(84,"p",68),t._uU(85),t.ALo(86,"arabicNumbers"),t.qZA()()()()()(),t.BQk()}if(2&i){const e=t.MAs(15),a=t.oxw();t.xp6(6),t.hij("",t.lcZ(7,36,"net_salary_details")," "),t.xp6(4),t.hij(" ",t.lcZ(11,38,(null==a.details?null:a.details.totalNet)||0),""),t.xp6(3),t.Q6J("ngIf",null==a.details?null:a.details.isPerHour)("ngIfElse",e),t.xp6(5),t.Oqu(t.lcZ(19,40,"allowance")),t.xp6(3),t.Oqu(t.lcZ(22,42,(null==a.details?null:a.details.allowance)||0)),t.xp6(4),t.Oqu(t.lcZ(26,44,"extra_allowance")),t.xp6(2),t.Q6J("disabled",!a.selectedUser||a.data.user)("ngModel",a.allowance),t.xp6(3),t.Oqu(t.lcZ(31,46,"kpi_bonus")),t.xp6(3),t.Oqu(t.lcZ(34,48,(null==a.details?null:a.details.earnedKpiBonus)||0)),t.xp6(2),t.ekj("visibility-hidden",null==a.details?null:a.details.isPerHour),t.xp6(2),t.hij("",t.lcZ(38,50,"manual_penalties")," "),t.xp6(3),t.Q6J("ngIf",null==a.details?null:a.details.manualPenalityDayCount),t.xp6(1),t.hij(" ",t.lcZ(42,52,(null==a.details?null:a.details.manualPenalityDeduction)||0),""),t.xp6(2),t.ekj("visibility-hidden",null==a.details?null:a.details.isPerHour),t.xp6(2),t.Oqu(t.lcZ(46,54,"attendance_penalties")),t.xp6(3),t.Q6J("ngIf",null==a.details?null:a.details.attendanceDeduction),t.xp6(1),t.hij(" ",t.lcZ(50,56,(null==a.details?null:a.details.attendanceDeductionValue)||0),""),t.xp6(4),t.Oqu(t.lcZ(54,58,"extra_deduction")),t.xp6(2),t.Q6J("disabled",!a.selectedUser||a.data.user)("ngModel",a.deduction),t.xp6(4),t.hij("",t.lcZ(60,60,"gross_salary_details")," "),t.xp6(4),t.hij(" ",t.lcZ(64,62,(null==a.details?null:a.details.gross)||0),""),t.xp6(5),t.hij("",t.lcZ(69,64,"net_salary")," "),t.xp6(3),t.Oqu(t.lcZ(72,66,(null==a.details?null:a.details.totalNet)||0)),t.xp6(2),t.ekj("visibility-hidden",null==a.details?null:a.details.isPerHour),t.xp6(2),t.Oqu(t.lcZ(76,68,"income_tax")),t.xp6(3),t.Oqu(t.lcZ(79,70,(null==a.details?null:a.details.taxes)||0)),t.xp6(2),t.ekj("visibility-hidden",null==a.details?null:a.details.isPerHour),t.xp6(2),t.Oqu(t.lcZ(83,72,"social_insurance")),t.xp6(3),t.Oqu(t.lcZ(86,74,(null==a.details?null:a.details.insurance)||0))}}function Pt(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"button",75),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submit())}),t._UZ(1,"submit-button",76),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loading||!e.selectedUser),t.xp6(1),t.Q6J("loading",e.loading)}}function Lt(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"button",75),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createMulti())}),t._UZ(1,"submit-button",76),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loading||!e.selectedUser),t.xp6(1),t.Q6J("loading",e.loading)}}let K;K="rtl"===document.dir?"ar-EG":"en-GB";let W=(()=>{class i{constructor(e,a,n,o,m){this.data=e,this.datePipe=a,this.dialogRef=n,this.hrService=o,this.userService=m,this.users=[],this.service=(0,t.f3M)(r),this.dialog=(0,t.f3M)(g.uw),this.alert=(0,t.f3M)(E.c),this.loading=!1,this.allowance=0,this.deduction=0,this.now=new Date,this.month=(new Date).getMonth()+1,this.startDate=this.datePipe.transform(new Date,"yyyy-MM-01"),this.endDate=this.datePipe.transform(new Date,"yyyy-MM-30"),this.crossMonth=0,this.fromDay=1,this.toDay=30}ngOnInit(){this.data.user&&(this.selectedUser={imageUrl:this.data.user.employeePic,name:this.data.user.employeeName,jobTitle:this.data.user.employeeNJobTitle,id:this.data.user.employeeId},this.allowance=this.data.user.extraAllowance,this.deduction=this.data.user.extraDeductions,this.details=this.data.user,this.endDate=this.data.user.date,this.getUserProfile(this.data.user.employeeId)),this.getPayrollCycle()}getUserProfile(e){this.userService.getUserProfile(e).subscribe(a=>{this.joinDate=a.creationDate,this.selectedUser.isActivated=a.isActivated})}submit(){this.loading=!0,this.service.submitPayslip(this.details).subscribe(e=>{e.success?(this.dialogRef.close(!0),this.alert.showAlert("payslip_generated"),this.service.hasChanged.next(!0)):this.loading=!1},()=>this.loading=!1)}getUser(e){this.users=e,this.data.multi?this.selectedUser=e.map(a=>a.id):(this.selectedUser=e[0],this.joinDate=e[0].creationDate,this.selectedUser.isActivated=e[0].isActivated),this.selectedUser&&this.month&&this.calcDetails()}allowanceChange(){clearTimeout(this.stopTimeout),this.stopTimeout=setTimeout(()=>{this.calcDetails()},400)}monthlyWorkingHoursChange(){clearTimeout(this.stopTimeout),this.stopTimeout=setTimeout(()=>{this.calcDetails()},400)}deductionChange(){clearTimeout(this.stopTimeout),this.stopTimeout=setTimeout(()=>{this.calcDetails()},400)}calcDetails(){let e=(new x.LE).set("Month",this.month).set("ExtraAllowance",this.allowance||0).set("ExtraDeductions",this.deduction||0).set("UserId",this.selectedUser.id);this.monthlyWorkingHours&&(e=e.set("WorkedHours",this.monthlyWorkingHours)),this.service.generatePayslip(e).subscribe(a=>{a.success?(this.details=a.data,this.details.date=this.endDate):(this.details=null,this.openAllInfoDialog(this.selectedUser))})}openAllInfoDialog(e){Array.isArray(e)||(e=[e]),this.dialog.open(lt,{width:"800px",data:{users:e}}).afterClosed().subscribe(n=>{n&&!this.data.multi&&this.calcDetails()})}createMulti(){this.loading=!0;let e=(new x.LE).set("Month",this.month);this.selectedUser.forEach(a=>{e=e.append("UsersIds",a.toString())}),this.service.createMltiPayslips(e).subscribe(a=>{this.loading=!1,a.success&&(this.alert.showAlert("success"),this.service.hasChanged.next(!0),this.dialogRef.close(!0)),0===a.data.length&&this.dialogRef.close(!0)},()=>{this.loading=!1,this.openAllInfoDialog(this.users)})}getPayrollCycle(){this.hrService.getPayrollCycle().subscribe({next:e=>{if(!e?.data)return void this.alert.showAlert("error","invalid_payroll_data");const a=new Date;this.crossMonth=e.data.crossMonth;const n=this.crossMonth?1:0;if(e.data.fromDay&&e.data.toDay){this.fromDay=e.data.fromDay,this.toDay=e.data.toDay;const o=this.fromDay<=15&&this.crossMonth?a.getMonth()+1:a.getMonth();this.updateStartEndDates(a,o,n),this.crossMonth?new Date(this.endDate)>a?(this.now=new Date,this.month=a.getMonth()+1):(this.now=new Date(a.getFullYear(),a.getMonth()+1,1),this.month=a.getMonth()+2):this.month=a.getMonth()+1}else this.alert.showAlert("error","missing_payroll_days")},error:e=>{console.error("Error fetching payroll cycle:",e),this.alert.showAlert("error","fetch_payroll_failed")}})}updateStartEndDates(e,a,n){try{this.startDate=this.datePipe.transform(new Date(e.getFullYear(),a-n,this.fromDay),"yyyy-MM-dd");const o=this.crossMonth?this.toDay:new Date(e.getFullYear(),a+1,0).getDate();if(this.endDate=this.datePipe.transform(new Date(e.getFullYear(),a,o),"yyyy-MM-dd"),!this.startDate||!this.endDate)throw new Error("Invalid date transformation")}catch(o){console.error("Error updating dates:",o),this.alert.showAlert("error","date_update_failed")}}removeUser(e){this.users=this.users.filter(a=>a.id!==e.id),0===this.users.length&&(this.selectedUser=null)}setMonthAndYear(e){this.month=e.getMonth()+1;const a=this.fromDay<=15&&this.crossMonth?e.getMonth()+1:e.getMonth();this.updateStartEndDates(e,a,this.crossMonth)}static{this.\u0275fac=function(a){return new(a||i)(t.Y36(g.WI),t.Y36(d.uU),t.Y36(g.so),t.Y36(N.j),t.Y36(ct.K))}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["create-payslip"]],standalone:!0,features:[t.jDz],decls:19,vars:16,consts:[["dir","auto",1,"create-task"],["class","bold",4,"ngIf"],["mat-dialog-content",""],[1,"row"],[1,"px-1",3,"ngClass"],[4,"ngIf"],["class","select-user",4,"ngIf"],["class","px-1",3,"ngClass",4,"ngIf"],[1,"col-lg-4","px-1"],["class","info-card date-picker-card",4,"ngIf"],["class","col-lg-12",4,"ngIf"],["mat-dialog-actions","","align","end","dir","auto",1,"mt-1"],[1,"flex"],["mat-dialog-close","",1,"px-4","py-1","mr-2","dark-color","clickable-btn","rounded","cancel-btn"],["mat-raised-button","","color","primary","class","px-5 fs-15",3,"disabled","click",4,"ngIf"],[1,"bold"],[1,"info-card"],[1,"info-card-body"],[1,"info-card-header","d-flex","justify-content-between","mb-1"],[1,"d-flex","gap-5"],["class","img",4,"ngIf"],[1,"line-height"],[1,"fs-13","muted"],["class","clear-btn","type","button",3,"click",4,"ngIf"],[1,"info-card-footer"],[1,"col-lg-6","px-1"],[1,"d-flex","gap-3"],["src","assets/images/icons/calendar-icon.svg","alt","user",1,"icon"],[1,"fs-13"],[4,"ngIf","ngIfElse"],["contractNormal",""],[1,"img"],[3,"img"],["type","button",1,"clear-btn",3,"click"],[1,"bx","bx-x"],[1,"badge","badge-success"],["src","assets/images/icons/Status.svg","alt","user",1,"icon"],[1,"badge","badge-success",3,"ngClass"],[1,"select-user"],[1,"user","mt-1","mb-2"],["text","select_user",3,"multi","getSelectedUsers"],["class","info-card",4,"ngFor","ngForOf"],[1,"info-card","date-picker-card"],[1,"d-flex","justify-content-between","mb-2"],[1,"w-75"],[3,"max","min","selectedDate","displayLabel","onChange"],[1,"date-picker-card-footer","text-center"],[1,"fs-14","fw-bold"],[1,"col-lg-12"],[1,"row","align-items-center"],[1,"col-lg-5"],[1,"d-flex","align-items-center","gap-5"],["src","assets/images/icons/timer-clock.svg","alt","user",1,"icon"],[1,"flex","aic","position-relative","w-40"],["type","number",1,"input",3,"ngModel","ngModelChange","input"],[1,"input-suffix"],[1,"col-lg-7"],[1,"d-flex","gap-3","align-items-center","hint-info"],[1,"bx","bx-info-circle"],[1,"form","border","rounded"],[1,"d-flex"],[1,"flex-50","border-right"],[1,"flex","aic","jcsb","border-bottom","bg-gray","p-1"],[1,"bold","primary"],["width","16","src","assets/images/icons/info.svg","alt","info",1,"icon"],[1,"data","p-2"],["basicSalary",""],[1,"flex","aic","jcsb","my-1"],[1,"success"],[1,"flex","aic","jcsb"],["type","text",1,"input","w-30","text-right",3,"disabled","ngModel","ngModelChange","input"],[1,"danger"],["class","black",4,"ngIf"],[1,"flex-50"],[1,"black"],["mat-raised-button","","color","primary",1,"px-5","fs-15",3,"disabled","click"],["text","create",3,"loading"]],template:function(a,n){1&a&&(t.TgZ(0,"div",0),t.YNc(1,dt,3,3,"h4",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4),t.YNc(5,ht,26,13,"div",5),t.YNc(6,_t,3,1,"div",6),t.qZA(),t.YNc(7,vt,2,5,"div",7),t.TgZ(8,"div",8),t.YNc(9,Ct,12,19,"div",9),t.qZA(),t.YNc(10,At,20,10,"div",10),t.qZA(),t.YNc(11,Ut,87,76,"ng-container",5),t.qZA(),t.TgZ(12,"div",11)(13,"div",12)(14,"button",13),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.YNc(17,Pt,2,2,"button",14),t.YNc(18,Lt,2,2,"button",14),t.qZA()()()),2&a&&(t.xp6(1),t.Q6J("ngIf",!n.data.user),t.xp6(3),t.Q6J("ngClass",t.WLB(13,j,!n.data.user,n.data.user)),t.xp6(1),t.Q6J("ngIf",!!n.selectedUser&&!n.data.multi),t.xp6(1),t.Q6J("ngIf",!n.data.user&&!n.selectedUser),t.xp6(1),t.Q6J("ngIf",n.data.multi&&n.users.length>0),t.xp6(2),t.Q6J("ngIf",!n.data.user),t.xp6(1),t.Q6J("ngIf",null==n.details?null:n.details.isPerHour),t.xp6(1),t.Q6J("ngIf",!n.data.multi),t.xp6(4),t.Oqu(t.lcZ(16,11,"cancel")),t.xp6(2),t.Q6J("ngIf",!n.data.multi&&!n.data.user),t.xp6(1),t.Q6J("ngIf",n.data.multi&&!n.data.user))},dependencies:[d.ez,d.mk,d.sg,d.O5,d.uU,y.vT,y.Lv,g.Is,g.ZT,g.xY,g.H8,h.aw,h.X$,u.u5,u.Fj,u.wV,u.JJ,u.On,u.UX,Z.V,C.l,T.ot,T.lW,D.w,k.XK,H.c,G.lN,R.FA,$.m,rt.z],styles:[".info-card[_ngcontent-%COMP%]{position:relative;border-radius:8px;padding:12px;margin-bottom:8px;border:.5px solid rgba(157,157,157,.4)}.info-card[_ngcontent-%COMP%]   .date-picker-card-body[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:space-between;align-items:flex-start;margin-block-end:8px}.clear-btn[_ngcontent-%COMP%]{background:rgba(211,47,47,.2509803922);border:none;border-radius:50%;height:16px;width:16px;color:#d32f2f}.hint-info[_ngcontent-%COMP%]{color:#ffa95c}.visibility-hidden[_ngcontent-%COMP%]{visibility:hidden}  month-filter input.ng-invalid.ng-touched,   month-filter .password.ng-invalid.ng-touched+.border-left,   month-filter .phone .ng-invalid.ng-touched input,   month-filter .ng-touched.ng-invalid>.ng-select-container,   month-filter .input.ng-invalid.ng-touched{border-color:#e7e7e7!important}img.icon[_ngcontent-%COMP%]{position:relative;bottom:-5px}"]})}}return i})();var B=s(75986),Ot=s(83318),It=s(36114);function Et(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"tr",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.create(o))}),t.TgZ(1,"td",14)(2,"div",15)(3,"mat-checkbox",21),t.NdJ("change",function(n){const m=t.CHM(e).$implicit,jt=t.oxw(2);return t.KtG(jt.selectUser(n,m))})("click",function(n){return n.stopImmediatePropagation()}),t.qZA(),t.TgZ(4,"div",22)(5,"div",23),t._UZ(6,"user-image",24),t.qZA(),t.TgZ(7,"div",25)(8,"p"),t._uU(9),t.qZA(),t.TgZ(10,"p",26),t._uU(11),t.qZA()()()()(),t.TgZ(12,"td")(13,"p"),t._uU(14),t.qZA()(),t.TgZ(15,"td")(16,"p"),t._uU(17),t.qZA()(),t.TgZ(18,"td")(19,"p"),t._uU(20),t.qZA()(),t.TgZ(21,"td")(22,"p"),t._uU(23),t.qZA()(),t.TgZ(24,"td")(25,"p"),t._uU(26),t.qZA()(),t.TgZ(27,"td")(28,"p"),t._uU(29),t.qZA()()()}if(2&i){const e=l.$implicit;t.xp6(3),t.Q6J("checked",e.isSelected),t.xp6(3),t.Q6J("img",e.employeePic),t.xp6(3),t.Oqu(e.employeeName),t.xp6(2),t.Oqu(e.employeeNJobTitle),t.xp6(3),t.Oqu(e.basic),t.xp6(3),t.Oqu(e.totalAllowance),t.xp6(3),t.Oqu(e.earnedKpiBonus||"-"),t.xp6(3),t.Oqu(e.totalDeductions),t.xp6(3),t.Oqu(e.gross),t.xp6(3),t.Oqu(e.totalNet)}}const kt=function(i,l,e){return{itemsPerPage:i,currentPage:l,totalItems:e}};function qt(i,l){if(1&i&&(t.TgZ(0,"tbody"),t.YNc(1,Et,30,10,"tr",19),t.ALo(2,"paginate"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,2,e.list,t.kEZ(5,kt,e.meta.pageSize,e.meta.currentPage,e.meta.totalItems)))("ngForTrackBy",e.trackBy)}}function Jt(i,l){1&i&&t._UZ(0,"not-found",27)}function Nt(i,l){1&i&&t._UZ(0,"loading")}const Yt=function(i){return{"bg-primary white":i}},Ft=function(i){return{"bg-danger white":i}},Qt=function(i){return{"h-100":i}};let St=(()=>{class i{constructor(){this.hrService=(0,t.f3M)(N.j),this.service=(0,t.f3M)(r),this.dialog=(0,t.f3M)(g.uw),this.alert=(0,t.f3M)(E.c),this.datePipe=(0,t.f3M)(d.uU),this.list=[],this.status=(0,P.q)(L.V),this.types=(0,P.q)(w.A),this.allChecked=!1,this.selectedUsers=[],this.selectedUsersToTakeAction=[],this.maxDate=new Date((new Date).getFullYear(),(new Date).getMonth()+1,0),this.startDate=this.datePipe.transform(new Date,"yyyy-MM-01"),this.endDate=this.datePipe.transform(new Date((new Date).getFullYear(),(new Date).getMonth()+1,0),"yyyy-MM-dd"),this.crossMonth=0,this.source$=this.service.list$.subscribe(e=>{this.meta=this.service.meta.value,this.list=e}),this.getPayrollCycle()}dateChange(e){this.service.startDate=this.datePipe.transform(new Date(e.startDate),"yyyy-MM-dd"),this.service.endDate=this.datePipe.transform(new Date(e.endDate),"yyyy-MM-dd"),this.service.hasChanged.next(!0)}create(e){this.dialog.open(W,{width:"850px",data:{user:e,multi:!1}})}takeAction(e){this.dialog.open(Ot.v,{panelClass:"confirmation-dialog",data:{btn_name:3==e?"approve":"reject",message:3==e?"approve_payslip":"reject_payslip",classes:3==e?"bg-primary white":"bg-danger white"}}).afterClosed().subscribe(n=>{n&&this.service.updatePayslip(e).subscribe(o=>{o.success&&(this.service.hasChanged.next(!0),this.service.selectedUsersToTakeAction.next([]),this.alert.showAlert("payslip_updated"))})})}selectAllUsers(e){this.allChecked=!0,this.list.forEach(a=>{this.selectUser(e,a)})}selectUser(e,a){e.checked?(a.isSelected=!0,this.getSelectedUsers()):(this.allChecked=!1,this.removeSelectedUser(a),a.isSelected=!1),this.checkAllCheckedUsers()}getSelectedUsers(){this.selectedUsers=this.list.filter(a=>a.isSelected),this.selectedUsers=this.selectedUsers.filter(a=>!this.selectedUsersToTakeAction.find(n=>a.id==n.id)),this.service.selectedUsersToTakeAction.next([].concat(this.selectedUsersToTakeAction,this.selectedUsers))}removeSelectedUser(e){let a=this.selectedUsersToTakeAction.filter(n=>e.id!=n.id);this.service.selectedUsersToTakeAction.next(a)}checkAllCheckedUsers(){let e=0;this.list.forEach(a=>{a.isSelected&&e++}),this.allChecked=e==this.list.length}trackBy(e,a){return a.id}ngOnDestroy(){this.source$.unsubscribe()}bulkPayslips(){this.dialog.open(W,{panelClass:"create-task-dialog",data:{multi:!0}})}getPayrollCycle(){this.hrService.getPayrollCycle().subscribe({next:e=>{if(!e?.data)return void this.alert.showAlert("error","invalid_payroll_data");const a=new Date;this.month=a.getMonth()+1,this.crossMonth=e.data.crossMonth;const n=this.crossMonth?1:0;if(e.data.fromDay&&e.data.toDay){this.fromDay=e.data.fromDay,this.toDay=e.data.toDay;const o=this.fromDay<=15&&this.crossMonth?a.getMonth()+1:a.getMonth();this.updateStartEndDates(a,o,n)}else this.alert.showAlert("error","missing_payroll_days")},error:e=>{console.error("Error fetching payroll cycle:",e),this.alert.showAlert("error","fetch_payroll_failed")}})}updateStartEndDates(e,a,n){try{this.startDate=this.datePipe.transform(new Date(e.getFullYear(),a-n,this.fromDay),"yyyy-MM-dd");const o=this.crossMonth?this.toDay:new Date(e.getFullYear(),a+1,0).getDate();if(this.endDate=this.datePipe.transform(new Date(e.getFullYear(),a,o),"yyyy-MM-dd"),!this.startDate||!this.endDate)throw new Error("Invalid date transformation")}catch(o){console.error("Error updating dates:",o),this.alert.showAlert("error","date_update_failed")}}setMonthAndYear(e){this.month=e.getMonth()+1;const a=this.fromDay<=15&&this.crossMonth?e.getMonth()+1:e.getMonth();this.updateStartEndDates(e,a,this.crossMonth)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.Xpm({type:i,selectors:[["team-payslip"]],standalone:!0,features:[t.jDz],decls:53,vars:56,consts:[[3,"meta","pageChange"],["filters",""],[1,"row","align-items-end"],[1,"col-lg-5"],[1,"d-flex","gap-x-2"],[3,"key","valueChanged"],[3,"width","maxDate","startDate","endDate","valueChanged"],[1,"col-lg-7"],[1,"d-flex","justify-content-end","gap-x-2"],["mat-raised-button","",3,"ngClass","disabled","click"],[1,"clickable-btn","bg-primary","white","py-75","px-3","rounded",3,"click"],["content",""],[1,"table","w-100","relative",3,"ngClass"],[1,"bg-gray","border-bottom"],[1,"text-left"],[1,"flex","aic"],["color","primary",1,"mr-1","example-margin",3,"checked","change"],[4,"ngIf"],["class","a-center",4,"ngIf"],["class","border-bottom pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-bottom","pointer",3,"click"],["color","primary",1,"mr-1","example-margin",3,"checked","change","click"],[1,"flex","aic","gap-x-1"],[1,"img"],[3,"img"],[1,"info"],[1,"muted"],[1,"a-center"]],template:function(a,n){1&a&&(t.TgZ(0,"layout-with-filters",0),t.NdJ("pageChange",function(m){return n.service.page.next(m),n.service.hasChanged.next(!0)}),t.ynx(1,1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"search",5),t.NdJ("valueChanged",function(m){return n.service.loading.next(!0),n.service.search.next(m),n.service.hasChanged.next(!0)}),t.qZA(),t.TgZ(6,"app-date-range",6),t.NdJ("valueChanged",function(m){return n.dateChange(m)}),t.qZA()()(),t.TgZ(7,"div",7)(8,"div",8)(9,"button",9),t.NdJ("click",function(){return n.takeAction(3)}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",9),t.NdJ("click",function(){return n.takeAction(2)}),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"button",10),t.NdJ("click",function(){return n.create()}),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"button",10),t.NdJ("click",function(){return n.bulkPayslips()}),t._uU(19),t.ALo(20,"translate"),t.qZA()()()(),t.BQk(),t.ynx(21,11),t.TgZ(22,"table",12)(23,"thead",13)(24,"tr")(25,"th",14)(26,"div",15)(27,"mat-checkbox",16),t.NdJ("change",function(m){return n.selectAllUsers(m)}),t.qZA(),t.TgZ(28,"p"),t._uU(29),t.ALo(30,"translate"),t.qZA()()(),t.TgZ(31,"th"),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"th"),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"th"),t._uU(38),t.ALo(39,"translate"),t.qZA(),t.TgZ(40,"th"),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"th"),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"th"),t._uU(47),t.ALo(48,"translate"),t.qZA(),t._UZ(49,"th"),t.qZA()(),t.YNc(50,qt,3,9,"tbody",17),t.YNc(51,Jt,1,0,"not-found",18),t.YNc(52,Nt,1,0,"loading",17),t.qZA(),t.BQk(),t.qZA()),2&a&&(t.Q6J("meta",n.meta),t.xp6(5),t.Q6J("key",n.service.search.value),t.xp6(1),t.Q6J("width","w-100")("maxDate",n.maxDate)("startDate",n.startDate)("endDate",n.endDate),t.xp6(3),t.Q6J("ngClass",t.VKq(50,Yt,n.service.selectedUsersToTakeAction.value.length>0))("disabled",0==n.service.selectedUsersToTakeAction.value.length),t.xp6(1),t.AsE(" ",t.lcZ(11,28,"submitted")," (",n.service.selectedUsersToTakeAction.value.length,") "),t.xp6(2),t.Q6J("ngClass",t.VKq(52,Ft,n.service.selectedUsersToTakeAction.value.length>0))("disabled",0==n.service.selectedUsersToTakeAction.value.length),t.xp6(1),t.AsE(" ",t.lcZ(14,30,"rejected")," (",n.service.selectedUsersToTakeAction.value.length,") "),t.xp6(3),t.Oqu(t.lcZ(17,32,"create_payslip")),t.xp6(3),t.Oqu(t.lcZ(20,34,"multi_payslip")),t.xp6(3),t.Q6J("ngClass",t.VKq(54,Qt,0==n.list.length||n.service.loading.value)),t.xp6(5),t.Q6J("checked",n.allChecked),t.xp6(2),t.Oqu(t.lcZ(30,36,"employee")),t.xp6(3),t.Oqu(t.lcZ(33,38,"basic_salary")),t.xp6(3),t.Oqu(t.lcZ(36,40,"total_allowance")),t.xp6(3),t.Oqu(t.lcZ(39,42,"target_kpi_bonus")),t.xp6(3),t.Oqu(t.lcZ(42,44,"total_deductions")),t.xp6(3),t.Oqu(t.lcZ(45,46,"gross_salary")),t.xp6(3),t.Oqu(t.lcZ(48,48,"net_salary")),t.xp6(3),t.Q6J("ngIf",n.list.length>0&&!n.service.loading.value),t.xp6(1),t.Q6J("ngIf",0==n.list.length&&!n.service.loading.value),t.xp6(1),t.Q6J("ngIf",n.service.loading.value))},dependencies:[d.ez,d.mk,d.sg,d.O5,v.Y,q.N,U.JX,U._s,_.w,M.g,h.aw,h.X$,C.l,B.p9,B.oG,T.ot,T.lW,It.S]})}}return i})()}}]);